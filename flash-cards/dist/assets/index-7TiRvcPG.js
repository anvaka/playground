var ko=Object.defineProperty;var br=e=>{throw TypeError(e)};var wo=(e,t,n)=>t in e?ko(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var xe=(e,t,n)=>wo(e,typeof t!="symbol"?t+"":t,n),xo=(e,t,n)=>t.has(e)||br("Cannot "+n);var kr=(e,t,n)=>t.has(e)?br("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);var wr=(e,t,n)=>(xo(e,t,"access private method"),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Li(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const Ce={},pn=[],bt=()=>{},Aa=()=>!1,Os=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Ni=e=>e.startsWith("onUpdate:"),Ye=Object.assign,Di=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Co=Object.prototype.hasOwnProperty,we=(e,t)=>Co.call(e,t),ue=Array.isArray,gn=e=>Qn(e)==="[object Map]",_n=e=>Qn(e)==="[object Set]",xr=e=>Qn(e)==="[object Date]",de=e=>typeof e=="function",Ie=e=>typeof e=="string",dt=e=>typeof e=="symbol",Te=e=>e!==null&&typeof e=="object",Pa=e=>(Te(e)||de(e))&&de(e.then)&&de(e.catch),Ma=Object.prototype.toString,Qn=e=>Ma.call(e),So=e=>Qn(e).slice(8,-1),Ia=e=>Qn(e)==="[object Object]",Bi=e=>Ie(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ln=Li(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ls=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},_o=/-\w/g,qt=Ls(e=>e.replace(_o,t=>t.slice(1).toUpperCase())),$o=/\B([A-Z])/g,Vt=Ls(e=>e.replace($o,"-$1").toLowerCase()),Oa=Ls(e=>e.charAt(0).toUpperCase()+e.slice(1)),Qs=Ls(e=>e?`on${Oa(e)}`:""),Kt=(e,t)=>!Object.is(e,t),ps=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},La=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},Ns=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Cr;const Ds=()=>Cr||(Cr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Zn(e){if(ue(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],i=Ie(s)?Ao(s):Zn(s);if(i)for(const r in i)t[r]=i[r]}return t}else if(Ie(e)||Te(e))return e}const To=/;(?![^(]*\))/g,Eo=/:([^]+)/,Ro=/\/\*[^]*?\*\//g;function Ao(e){const t={};return e.replace(Ro,"").split(To).forEach(n=>{if(n){const s=n.split(Eo);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function Se(e){let t="";if(Ie(e))t=e;else if(ue(e))for(let n=0;n<e.length;n++){const s=Se(e[n]);s&&(t+=s+" ")}else if(Te(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const Po="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Mo=Li(Po);function Na(e){return!!e||e===""}function Io(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=rn(e[s],t[s]);return n}function rn(e,t){if(e===t)return!0;let n=xr(e),s=xr(t);if(n||s)return n&&s?e.getTime()===t.getTime():!1;if(n=dt(e),s=dt(t),n||s)return e===t;if(n=ue(e),s=ue(t),n||s)return n&&s?Io(e,t):!1;if(n=Te(e),s=Te(t),n||s){if(!n||!s)return!1;const i=Object.keys(e).length,r=Object.keys(t).length;if(i!==r)return!1;for(const a in e){const l=e.hasOwnProperty(a),o=t.hasOwnProperty(a);if(l&&!o||!l&&o||!rn(e[a],t[a]))return!1}}return String(e)===String(t)}function Fi(e,t){return e.findIndex(n=>rn(n,t))}const Da=e=>!!(e&&e.__v_isRef===!0),L=e=>Ie(e)?e:e==null?"":ue(e)||Te(e)&&(e.toString===Ma||!de(e.toString))?Da(e)?L(e.value):JSON.stringify(e,Ba,2):String(e),Ba=(e,t)=>Da(t)?Ba(e,t.value):gn(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[s,i],r)=>(n[Zs(s,r)+" =>"]=i,n),{})}:_n(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>Zs(n))}:dt(t)?Zs(t):Te(t)&&!ue(t)&&!Ia(t)?String(t):t,Zs=(e,t="")=>{var n;return dt(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};/**
* @vue/reactivity v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ze;class Oo{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ze,!t&&Ze&&(this.index=(Ze.scopes||(Ze.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=Ze;try{return Ze=this,t()}finally{Ze=n}}}on(){++this._on===1&&(this.prevScope=Ze,Ze=this)}off(){this._on>0&&--this._on===0&&(Ze=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Lo(){return Ze}let $e;const Xs=new WeakSet;class Fa{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ze&&Ze.active&&Ze.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Xs.has(this)&&(Xs.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ha(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Sr(this),Ka(this);const t=$e,n=ut;$e=this,ut=!0;try{return this.fn()}finally{qa(this),$e=t,ut=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Ki(t);this.deps=this.depsTail=void 0,Sr(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Xs.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){yi(this)&&this.run()}get dirty(){return yi(this)}}let Ua=0,Nn,Dn;function Ha(e,t=!1){if(e.flags|=8,t){e.next=Dn,Dn=e;return}e.next=Nn,Nn=e}function Ui(){Ua++}function Hi(){if(--Ua>0)return;if(Dn){let t=Dn;for(Dn=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Nn;){let t=Nn;for(Nn=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){e||(e=s)}t=n}}if(e)throw e}function Ka(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function qa(e){let t,n=e.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),Ki(s),No(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}e.deps=t,e.depsTail=n}function yi(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ja(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function ja(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===zn)||(e.globalVersion=zn,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!yi(e))))return;e.flags|=2;const t=e.dep,n=$e,s=ut;$e=e,ut=!0;try{Ka(e);const i=e.fn(e._value);(t.version===0||Kt(i,e._value))&&(e.flags|=128,e._value=i,t.version++)}catch(i){throw t.version++,i}finally{$e=n,ut=s,qa(e),e.flags&=-3}}function Ki(e,t=!1){const{dep:n,prevSub:s,nextSub:i}=e;if(s&&(s.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)Ki(r,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function No(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ut=!0;const za=[];function Pt(){za.push(ut),ut=!1}function Mt(){const e=za.pop();ut=e===void 0?!0:e}function Sr(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=$e;$e=void 0;try{t()}finally{$e=n}}}let zn=0;class Do{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class qi{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!$e||!ut||$e===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==$e)n=this.activeLink=new Do($e,this),$e.deps?(n.prevDep=$e.depsTail,$e.depsTail.nextDep=n,$e.depsTail=n):$e.deps=$e.depsTail=n,Va(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=$e.depsTail,n.nextDep=void 0,$e.depsTail.nextDep=n,$e.depsTail=n,$e.deps===n&&($e.deps=s)}return n}trigger(t){this.version++,zn++,this.notify(t)}notify(t){Ui();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Hi()}}}function Va(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)Va(s)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const bi=new WeakMap,en=Symbol(""),ki=Symbol(""),Vn=Symbol("");function Ke(e,t,n){if(ut&&$e){let s=bi.get(e);s||bi.set(e,s=new Map);let i=s.get(n);i||(s.set(n,i=new qi),i.map=s,i.key=n),i.track()}}function Tt(e,t,n,s,i,r){const a=bi.get(e);if(!a){zn++;return}const l=o=>{o&&o.trigger()};if(Ui(),t==="clear")a.forEach(l);else{const o=ue(e),u=o&&Bi(n);if(o&&n==="length"){const d=Number(s);a.forEach((h,p)=>{(p==="length"||p===Vn||!dt(p)&&p>=d)&&l(h)})}else switch((n!==void 0||a.has(void 0))&&l(a.get(n)),u&&l(a.get(Vn)),t){case"add":o?u&&l(a.get("length")):(l(a.get(en)),gn(e)&&l(a.get(ki)));break;case"delete":o||(l(a.get(en)),gn(e)&&l(a.get(ki)));break;case"set":gn(e)&&l(a.get(en));break}}Hi()}function un(e){const t=ke(e);return t===e?t:(Ke(t,"iterate",Vn),rt(e)?t:t.map(ft))}function Bs(e){return Ke(e=ke(e),"iterate",Vn),e}function Ft(e,t){return It(e)?tn(e)?bn(ft(t)):bn(t):ft(t)}const Bo={__proto__:null,[Symbol.iterator](){return ei(this,Symbol.iterator,e=>Ft(this,e))},concat(...e){return un(this).concat(...e.map(t=>ue(t)?un(t):t))},entries(){return ei(this,"entries",e=>(e[1]=Ft(this,e[1]),e))},every(e,t){return St(this,"every",e,t,void 0,arguments)},filter(e,t){return St(this,"filter",e,t,n=>n.map(s=>Ft(this,s)),arguments)},find(e,t){return St(this,"find",e,t,n=>Ft(this,n),arguments)},findIndex(e,t){return St(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return St(this,"findLast",e,t,n=>Ft(this,n),arguments)},findLastIndex(e,t){return St(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return St(this,"forEach",e,t,void 0,arguments)},includes(...e){return ti(this,"includes",e)},indexOf(...e){return ti(this,"indexOf",e)},join(e){return un(this).join(e)},lastIndexOf(...e){return ti(this,"lastIndexOf",e)},map(e,t){return St(this,"map",e,t,void 0,arguments)},pop(){return Tn(this,"pop")},push(...e){return Tn(this,"push",e)},reduce(e,...t){return _r(this,"reduce",e,t)},reduceRight(e,...t){return _r(this,"reduceRight",e,t)},shift(){return Tn(this,"shift")},some(e,t){return St(this,"some",e,t,void 0,arguments)},splice(...e){return Tn(this,"splice",e)},toReversed(){return un(this).toReversed()},toSorted(e){return un(this).toSorted(e)},toSpliced(...e){return un(this).toSpliced(...e)},unshift(...e){return Tn(this,"unshift",e)},values(){return ei(this,"values",e=>Ft(this,e))}};function ei(e,t,n){const s=Bs(e),i=s[t]();return s!==e&&!rt(e)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.done||(r.value=n(r.value)),r}),i}const Fo=Array.prototype;function St(e,t,n,s,i,r){const a=Bs(e),l=a!==e&&!rt(e),o=a[t];if(o!==Fo[t]){const h=o.apply(e,r);return l?ft(h):h}let u=n;a!==e&&(l?u=function(h,p){return n.call(this,Ft(e,h),p,e)}:n.length>2&&(u=function(h,p){return n.call(this,h,p,e)}));const d=o.call(a,u,s);return l&&i?i(d):d}function _r(e,t,n,s){const i=Bs(e);let r=n;return i!==e&&(rt(e)?n.length>3&&(r=function(a,l,o){return n.call(this,a,l,o,e)}):r=function(a,l,o){return n.call(this,a,Ft(e,l),o,e)}),i[t](r,...s)}function ti(e,t,n){const s=ke(e);Ke(s,"iterate",Vn);const i=s[t](...n);return(i===-1||i===!1)&&Gi(n[0])?(n[0]=ke(n[0]),s[t](...n)):i}function Tn(e,t,n=[]){Pt(),Ui();const s=ke(e)[t].apply(e,n);return Hi(),Mt(),s}const Uo=Li("__proto__,__v_isRef,__isVue"),Ga=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(dt));function Ho(e){dt(e)||(e=String(e));const t=ke(this);return Ke(t,"has",e),t.hasOwnProperty(e)}class Wa{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,s){if(n==="__v_skip")return t.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?Qo:Za:r?Qa:Ya).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const a=ue(t);if(!i){let o;if(a&&(o=Bo[n]))return o;if(n==="hasOwnProperty")return Ho}const l=Reflect.get(t,n,je(t)?t:s);if((dt(n)?Ga.has(n):Uo(n))||(i||Ke(t,"get",n),r))return l;if(je(l)){const o=a&&Bi(n)?l:l.value;return i&&Te(o)?xi(o):o}return Te(l)?i?xi(l):zi(l):l}}class Ja extends Wa{constructor(t=!1){super(!1,t)}set(t,n,s,i){let r=t[n];const a=ue(t)&&Bi(n);if(!this._isShallow){const u=It(r);if(!rt(s)&&!It(s)&&(r=ke(r),s=ke(s)),!a&&je(r)&&!je(s))return u||(r.value=s),!0}const l=a?Number(n)<t.length:we(t,n),o=Reflect.set(t,n,s,je(t)?t:i);return t===ke(i)&&(l?Kt(s,r)&&Tt(t,"set",n,s):Tt(t,"add",n,s)),o}deleteProperty(t,n){const s=we(t,n);t[n];const i=Reflect.deleteProperty(t,n);return i&&s&&Tt(t,"delete",n,void 0),i}has(t,n){const s=Reflect.has(t,n);return(!dt(n)||!Ga.has(n))&&Ke(t,"has",n),s}ownKeys(t){return Ke(t,"iterate",ue(t)?"length":en),Reflect.ownKeys(t)}}class Ko extends Wa{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const qo=new Ja,jo=new Ko,zo=new Ja(!0);const wi=e=>e,ns=e=>Reflect.getPrototypeOf(e);function Vo(e,t,n){return function(...s){const i=this.__v_raw,r=ke(i),a=gn(r),l=e==="entries"||e===Symbol.iterator&&a,o=e==="keys"&&a,u=i[e](...s),d=n?wi:t?bn:ft;return!t&&Ke(r,"iterate",o?ki:en),{next(){const{value:h,done:p}=u.next();return p?{value:h,done:p}:{value:l?[d(h[0]),d(h[1])]:d(h),done:p}},[Symbol.iterator](){return this}}}}function ss(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function Go(e,t){const n={get(i){const r=this.__v_raw,a=ke(r),l=ke(i);e||(Kt(i,l)&&Ke(a,"get",i),Ke(a,"get",l));const{has:o}=ns(a),u=t?wi:e?bn:ft;if(o.call(a,i))return u(r.get(i));if(o.call(a,l))return u(r.get(l));r!==a&&r.get(i)},get size(){const i=this.__v_raw;return!e&&Ke(ke(i),"iterate",en),i.size},has(i){const r=this.__v_raw,a=ke(r),l=ke(i);return e||(Kt(i,l)&&Ke(a,"has",i),Ke(a,"has",l)),i===l?r.has(i):r.has(i)||r.has(l)},forEach(i,r){const a=this,l=a.__v_raw,o=ke(l),u=t?wi:e?bn:ft;return!e&&Ke(o,"iterate",en),l.forEach((d,h)=>i.call(r,u(d),u(h),a))}};return Ye(n,e?{add:ss("add"),set:ss("set"),delete:ss("delete"),clear:ss("clear")}:{add(i){!t&&!rt(i)&&!It(i)&&(i=ke(i));const r=ke(this);return ns(r).has.call(r,i)||(r.add(i),Tt(r,"add",i,i)),this},set(i,r){!t&&!rt(r)&&!It(r)&&(r=ke(r));const a=ke(this),{has:l,get:o}=ns(a);let u=l.call(a,i);u||(i=ke(i),u=l.call(a,i));const d=o.call(a,i);return a.set(i,r),u?Kt(r,d)&&Tt(a,"set",i,r):Tt(a,"add",i,r),this},delete(i){const r=ke(this),{has:a,get:l}=ns(r);let o=a.call(r,i);o||(i=ke(i),o=a.call(r,i)),l&&l.call(r,i);const u=r.delete(i);return o&&Tt(r,"delete",i,void 0),u},clear(){const i=ke(this),r=i.size!==0,a=i.clear();return r&&Tt(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=Vo(i,e,t)}),n}function ji(e,t){const n=Go(e,t);return(s,i,r)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?s:Reflect.get(we(n,i)&&i in s?n:s,i,r)}const Wo={get:ji(!1,!1)},Jo={get:ji(!1,!0)},Yo={get:ji(!0,!1)};const Ya=new WeakMap,Qa=new WeakMap,Za=new WeakMap,Qo=new WeakMap;function Zo(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Xo(e){return e.__v_skip||!Object.isExtensible(e)?0:Zo(So(e))}function zi(e){return It(e)?e:Vi(e,!1,qo,Wo,Ya)}function ec(e){return Vi(e,!1,zo,Jo,Qa)}function xi(e){return Vi(e,!0,jo,Yo,Za)}function Vi(e,t,n,s,i){if(!Te(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=Xo(e);if(r===0)return e;const a=i.get(e);if(a)return a;const l=new Proxy(e,r===2?s:n);return i.set(e,l),l}function tn(e){return It(e)?tn(e.__v_raw):!!(e&&e.__v_isReactive)}function It(e){return!!(e&&e.__v_isReadonly)}function rt(e){return!!(e&&e.__v_isShallow)}function Gi(e){return e?!!e.__v_raw:!1}function ke(e){const t=e&&e.__v_raw;return t?ke(t):e}function tc(e){return!we(e,"__v_skip")&&Object.isExtensible(e)&&La(e,"__v_skip",!0),e}const ft=e=>Te(e)?zi(e):e,bn=e=>Te(e)?xi(e):e;function je(e){return e?e.__v_isRef===!0:!1}function I(e){return nc(e,!1)}function nc(e,t){return je(e)?e:new sc(e,t)}class sc{constructor(t,n){this.dep=new qi,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ke(t),this._value=n?t:ft(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,s=this.__v_isShallow||rt(t)||It(t);t=s?t:ke(t),Kt(t,n)&&(this._rawValue=t,this._value=s?t:ft(t),this.dep.trigger())}}function G(e){return je(e)?e.value:e}const ic={get:(e,t,n)=>t==="__v_raw"?e:G(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const i=e[t];return je(i)&&!je(n)?(i.value=n,!0):Reflect.set(e,t,n,s)}};function Xa(e){return tn(e)?e:new Proxy(e,ic)}class rc{constructor(t,n,s){this.fn=t,this.setter=n,this._value=void 0,this.dep=new qi(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=zn-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&$e!==this)return Ha(this,!0),!0}get value(){const t=this.dep.track();return ja(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function ac(e,t,n=!1){let s,i;return de(e)?s=e:(s=e.get,i=e.set),new rc(s,i,n)}const is={},ws=new WeakMap;let Zt;function lc(e,t=!1,n=Zt){if(n){let s=ws.get(n);s||ws.set(n,s=[]),s.push(e)}}function oc(e,t,n=Ce){const{immediate:s,deep:i,once:r,scheduler:a,augmentJob:l,call:o}=n,u=$=>i?$:rt($)||i===!1||i===0?Et($,1):Et($);let d,h,p,f,k=!1,g=!1;if(je(e)?(h=()=>e.value,k=rt(e)):tn(e)?(h=()=>u(e),k=!0):ue(e)?(g=!0,k=e.some($=>tn($)||rt($)),h=()=>e.map($=>{if(je($))return $.value;if(tn($))return u($);if(de($))return o?o($,2):$()})):de(e)?t?h=o?()=>o(e,2):e:h=()=>{if(p){Pt();try{p()}finally{Mt()}}const $=Zt;Zt=d;try{return o?o(e,3,[f]):e(f)}finally{Zt=$}}:h=bt,t&&i){const $=h,P=i===!0?1/0:i;h=()=>Et($(),P)}const S=Lo(),R=()=>{d.stop(),S&&S.active&&Di(S.effects,d)};if(r&&t){const $=t;t=(...P)=>{$(...P),R()}}let y=g?new Array(e.length).fill(is):is;const x=$=>{if(!(!(d.flags&1)||!d.dirty&&!$))if(t){const P=d.run();if(i||k||(g?P.some((C,m)=>Kt(C,y[m])):Kt(P,y))){p&&p();const C=Zt;Zt=d;try{const m=[P,y===is?void 0:g&&y[0]===is?[]:y,f];y=P,o?o(t,3,m):t(...m)}finally{Zt=C}}}else d.run()};return l&&l(x),d=new Fa(h),d.scheduler=a?()=>a(x,!1):x,f=$=>lc($,!1,d),p=d.onStop=()=>{const $=ws.get(d);if($){if(o)o($,4);else for(const P of $)P();ws.delete(d)}},t?s?x(!0):y=d.run():a?a(x.bind(null,!0),!0):d.run(),R.pause=d.pause.bind(d),R.resume=d.resume.bind(d),R.stop=R,R}function Et(e,t=1/0,n){if(t<=0||!Te(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,je(e))Et(e.value,t,n);else if(ue(e))for(let s=0;s<e.length;s++)Et(e[s],t,n);else if(_n(e)||gn(e))e.forEach(s=>{Et(s,t,n)});else if(Ia(e)){for(const s in e)Et(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Et(e[s],t,n)}return e}/**
* @vue/runtime-core v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Xn(e,t,n,s){try{return s?e(...s):e()}catch(i){Fs(i,t,n)}}function kt(e,t,n,s){if(de(e)){const i=Xn(e,t,n,s);return i&&Pa(i)&&i.catch(r=>{Fs(r,t,n)}),i}if(ue(e)){const i=[];for(let r=0;r<e.length;r++)i.push(kt(e[r],t,n,s));return i}}function Fs(e,t,n,s=!0){const i=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Ce;if(t){let l=t.parent;const o=t.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const d=l.ec;if(d){for(let h=0;h<d.length;h++)if(d[h](e,o,u)===!1)return}l=l.parent}if(r){Pt(),Xn(r,null,10,[e,o,u]),Mt();return}}cc(e,n,i,s,a)}function cc(e,t,n,s=!0,i=!1){if(i)throw e;console.error(e)}const Ge=[];let vt=-1;const mn=[];let Ut=null,fn=0;const el=Promise.resolve();let xs=null;function $n(e){const t=xs||el;return e?t.then(this?e.bind(this):e):t}function uc(e){let t=vt+1,n=Ge.length;for(;t<n;){const s=t+n>>>1,i=Ge[s],r=Gn(i);r<e||r===e&&i.flags&2?t=s+1:n=s}return t}function Wi(e){if(!(e.flags&1)){const t=Gn(e),n=Ge[Ge.length-1];!n||!(e.flags&2)&&t>=Gn(n)?Ge.push(e):Ge.splice(uc(t),0,e),e.flags|=1,tl()}}function tl(){xs||(xs=el.then(sl))}function dc(e){ue(e)?mn.push(...e):Ut&&e.id===-1?Ut.splice(fn+1,0,e):e.flags&1||(mn.push(e),e.flags|=1),tl()}function $r(e,t,n=vt+1){for(;n<Ge.length;n++){const s=Ge[n];if(s&&s.flags&2){if(e&&s.id!==e.uid)continue;Ge.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function nl(e){if(mn.length){const t=[...new Set(mn)].sort((n,s)=>Gn(n)-Gn(s));if(mn.length=0,Ut){Ut.push(...t);return}for(Ut=t,fn=0;fn<Ut.length;fn++){const n=Ut[fn];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Ut=null,fn=0}}const Gn=e=>e.id==null?e.flags&2?-1:1/0:e.id;function sl(e){try{for(vt=0;vt<Ge.length;vt++){const t=Ge[vt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Xn(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;vt<Ge.length;vt++){const t=Ge[vt];t&&(t.flags&=-2)}vt=-1,Ge.length=0,nl(),xs=null,(Ge.length||mn.length)&&sl()}}let qe=null,il=null;function Cs(e){const t=qe;return qe=e,il=e&&e.type.__scopeId||null,t}function Rt(e,t=qe,n){if(!t||e._n)return e;const s=(...i)=>{s._d&&Fr(-1);const r=Cs(t);let a;try{a=e(...i)}finally{Cs(r),s._d&&Fr(1)}return a};return s._n=!0,s._c=!0,s._d=!0,s}function me(e,t){if(qe===null)return e;const n=qs(qe),s=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[r,a,l,o=Ce]=t[i];r&&(de(r)&&(r={mounted:r,updated:r}),r.deep&&Et(a),s.push({dir:r,instance:n,value:a,oldValue:void 0,arg:l,modifiers:o}))}return e}function Wt(e,t,n,s){const i=e.dirs,r=t&&t.dirs;for(let a=0;a<i.length;a++){const l=i[a];r&&(l.oldValue=r[a].value);let o=l.dir[s];o&&(Pt(),kt(o,n,8,[e.el,l,e,t]),Mt())}}const rl=Symbol("_vte"),fc=e=>e.__isTeleport,Bn=e=>e&&(e.disabled||e.disabled===""),Tr=e=>e&&(e.defer||e.defer===""),Er=e=>typeof SVGElement<"u"&&e instanceof SVGElement,Rr=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Ci=(e,t)=>{const n=e&&e.to;return Ie(n)?t?t(n):null:n},al={name:"Teleport",__isTeleport:!0,process(e,t,n,s,i,r,a,l,o,u){const{mc:d,pc:h,pbc:p,o:{insert:f,querySelector:k,createText:g,createComment:S}}=u,R=Bn(t.props);let{shapeFlag:y,children:x,dynamicChildren:$}=t;if(e==null){const P=t.el=g(""),C=t.anchor=g("");f(P,n,s),f(C,n,s);const m=(F,D)=>{y&16&&d(x,F,D,i,r,a,l,o)},A=()=>{const F=t.target=Ci(t.props,k),D=ll(F,t,g,f);F&&(a!=="svg"&&Er(F)?a="svg":a!=="mathml"&&Rr(F)&&(a="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(F),R||(m(F,D),gs(t,!1)))};R&&(m(n,C),gs(t,!0)),Tr(t.props)?(t.el.__isMounted=!1,Ve(()=>{A(),delete t.el.__isMounted},r)):A()}else{if(Tr(t.props)&&e.el.__isMounted===!1){Ve(()=>{al.process(e,t,n,s,i,r,a,l,o,u)},r);return}t.el=e.el,t.targetStart=e.targetStart;const P=t.anchor=e.anchor,C=t.target=e.target,m=t.targetAnchor=e.targetAnchor,A=Bn(e.props),F=A?n:C,D=A?P:m;if(a==="svg"||Er(C)?a="svg":(a==="mathml"||Rr(C))&&(a="mathml"),$?(p(e.dynamicChildren,$,F,i,r,a,l),Xi(e,t,!0)):o||h(e,t,F,D,i,r,a,l,!1),R)A?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):rs(t,n,P,u,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const O=t.target=Ci(t.props,k);O&&rs(t,O,null,u,0)}else A&&rs(t,C,m,u,1);gs(t,R)}},remove(e,t,n,{um:s,o:{remove:i}},r){const{shapeFlag:a,children:l,anchor:o,targetStart:u,targetAnchor:d,target:h,props:p}=e;if(h&&(i(u),i(d)),r&&i(o),a&16){const f=r||!Bn(p);for(let k=0;k<l.length;k++){const g=l[k];s(g,t,n,f,!!g.dynamicChildren)}}},move:rs,hydrate:hc};function rs(e,t,n,{o:{insert:s},m:i},r=2){r===0&&s(e.targetAnchor,t,n);const{el:a,anchor:l,shapeFlag:o,children:u,props:d}=e,h=r===2;if(h&&s(a,t,n),(!h||Bn(d))&&o&16)for(let p=0;p<u.length;p++)i(u[p],t,n,2);h&&s(l,t,n)}function hc(e,t,n,s,i,r,{o:{nextSibling:a,parentNode:l,querySelector:o,insert:u,createText:d}},h){function p(g,S,R,y){S.anchor=h(a(g),S,l(g),n,s,i,r),S.targetStart=R,S.targetAnchor=y}const f=t.target=Ci(t.props,o),k=Bn(t.props);if(f){const g=f._lpa||f.firstChild;if(t.shapeFlag&16)if(k)p(e,t,g,g&&a(g));else{t.anchor=a(e);let S=g;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")t.targetStart=S;else if(S.data==="teleport anchor"){t.targetAnchor=S,f._lpa=t.targetAnchor&&a(t.targetAnchor);break}}S=a(S)}t.targetAnchor||ll(f,t,d,u),h(g&&a(g),t,f,n,s,i,r)}gs(t,k)}else k&&t.shapeFlag&16&&p(e,t,e,a(e));return t.anchor&&a(t.anchor)}const Ji=al;function gs(e,t){const n=e.ctx;if(n&&n.ut){let s,i;for(t?(s=e.el,i=e.anchor):(s=e.targetStart,i=e.targetAnchor);s&&s!==i;)s.nodeType===1&&s.setAttribute("data-v-owner",n.uid),s=s.nextSibling;n.ut()}}function ll(e,t,n,s){const i=t.targetStart=n(""),r=t.targetAnchor=n("");return i[rl]=r,e&&(s(i,e),s(r,e)),r}const pc=Symbol("_leaveCb");function Yi(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Yi(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ol(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ss=new WeakMap;function Fn(e,t,n,s,i=!1){if(ue(e)){e.forEach((k,g)=>Fn(k,t&&(ue(t)?t[g]:t),n,s,i));return}if(vn(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Fn(e,t,n,s.component.subTree);return}const r=s.shapeFlag&4?qs(s.component):s.el,a=i?null:r,{i:l,r:o}=e,u=t&&t.r,d=l.refs===Ce?l.refs={}:l.refs,h=l.setupState,p=ke(h),f=h===Ce?Aa:k=>we(p,k);if(u!=null&&u!==o){if(Ar(t),Ie(u))d[u]=null,f(u)&&(h[u]=null);else if(je(u)){u.value=null;const k=t;k.k&&(d[k.k]=null)}}if(de(o))Xn(o,l,12,[a,d]);else{const k=Ie(o),g=je(o);if(k||g){const S=()=>{if(e.f){const R=k?f(o)?h[o]:d[o]:o.value;if(i)ue(R)&&Di(R,r);else if(ue(R))R.includes(r)||R.push(r);else if(k)d[o]=[r],f(o)&&(h[o]=d[o]);else{const y=[r];o.value=y,e.k&&(d[e.k]=y)}}else k?(d[o]=a,f(o)&&(h[o]=a)):g&&(o.value=a,e.k&&(d[e.k]=a))};if(a){const R=()=>{S(),Ss.delete(e)};R.id=-1,Ss.set(e,R),Ve(R,n)}else Ar(e),S()}}}function Ar(e){const t=Ss.get(e);t&&(t.flags|=8,Ss.delete(e))}Ds().requestIdleCallback;Ds().cancelIdleCallback;const vn=e=>!!e.type.__asyncLoader,cl=e=>e.type.__isKeepAlive;function gc(e,t){ul(e,"a",t)}function mc(e,t){ul(e,"da",t)}function ul(e,t,n=We){const s=e.__wdc||(e.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Us(t,s,n),n){let i=n.parent;for(;i&&i.parent;)cl(i.parent.vnode)&&vc(s,t,n,i),i=i.parent}}function vc(e,t,n,s){const i=Us(t,e,s,!0);xt(()=>{Di(s[t],i)},n)}function Us(e,t,n=We,s=!1){if(n){const i=n[e]||(n[e]=[]),r=t.__weh||(t.__weh=(...a)=>{Pt();const l=es(n),o=kt(t,n,e,a);return l(),Mt(),o});return s?i.unshift(r):i.push(r),r}}const Lt=e=>(t,n=We)=>{(!Jn||e==="sp")&&Us(e,(...s)=>t(...s),n)},yc=Lt("bm"),Qe=Lt("m"),bc=Lt("bu"),kc=Lt("u"),wc=Lt("bum"),xt=Lt("um"),xc=Lt("sp"),Cc=Lt("rtg"),Sc=Lt("rtc");function _c(e,t=We){Us("ec",e,t)}const $c=Symbol.for("v-ndc");function _e(e,t,n,s){let i;const r=n,a=ue(e);if(a||Ie(e)){const l=a&&tn(e);let o=!1,u=!1;l&&(o=!rt(e),u=It(e),e=Bs(e)),i=new Array(e.length);for(let d=0,h=e.length;d<h;d++)i[d]=t(o?u?bn(ft(e[d])):ft(e[d]):e[d],d,void 0,r)}else if(typeof e=="number"){i=new Array(e);for(let l=0;l<e;l++)i[l]=t(l+1,l,void 0,r)}else if(Te(e))if(e[Symbol.iterator])i=Array.from(e,(l,o)=>t(l,o,void 0,r));else{const l=Object.keys(e);i=new Array(l.length);for(let o=0,u=l.length;o<u;o++){const d=l[o];i[o]=t(e[d],d,o,r)}}else i=[];return i}function En(e,t,n={},s,i){if(qe.ce||qe.parent&&vn(qe.parent)&&qe.parent.ce){const u=Object.keys(n).length>0;return t!=="default"&&(n.name=t),b(),Pe(oe,null,[Ae("slot",n,s&&s())],u?-2:64)}let r=e[t];r&&r._c&&(r._d=!1),b();const a=r&&dl(r(n)),l=n.key||a&&a.key,o=Pe(oe,{key:(l&&!dt(l)?l:`_${t}`)+(!a&&s?"_fb":"")},a||(s?s():[]),a&&e._===1?64:-2);return r&&r._c&&(r._d=!0),o}function dl(e){return e.some(t=>er(t)?!(t.type===Ot||t.type===oe&&!dl(t.children)):!0)?e:null}const Si=e=>e?Al(e)?qs(e):Si(e.parent):null,Un=Ye(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Si(e.parent),$root:e=>Si(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>hl(e),$forceUpdate:e=>e.f||(e.f=()=>{Wi(e.update)}),$nextTick:e=>e.n||(e.n=$n.bind(e.proxy)),$watch:e=>Bc.bind(e)}),ni=(e,t)=>e!==Ce&&!e.__isScriptSetup&&we(e,t),Tc={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:a,type:l,appContext:o}=e;if(t[0]!=="$"){const p=a[t];if(p!==void 0)switch(p){case 1:return s[t];case 2:return i[t];case 4:return n[t];case 3:return r[t]}else{if(ni(s,t))return a[t]=1,s[t];if(i!==Ce&&we(i,t))return a[t]=2,i[t];if(we(r,t))return a[t]=3,r[t];if(n!==Ce&&we(n,t))return a[t]=4,n[t];_i&&(a[t]=0)}}const u=Un[t];let d,h;if(u)return t==="$attrs"&&Ke(e.attrs,"get",""),u(e);if((d=l.__cssModules)&&(d=d[t]))return d;if(n!==Ce&&we(n,t))return a[t]=4,n[t];if(h=o.config.globalProperties,we(h,t))return h[t]},set({_:e},t,n){const{data:s,setupState:i,ctx:r}=e;return ni(i,t)?(i[t]=n,!0):s!==Ce&&we(s,t)?(s[t]=n,!0):we(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:i,props:r,type:a}},l){let o;return!!(n[l]||e!==Ce&&l[0]!=="$"&&we(e,l)||ni(t,l)||we(r,l)||we(s,l)||we(Un,l)||we(i.config.globalProperties,l)||(o=a.__cssModules)&&o[l])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:we(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Pr(e){return ue(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let _i=!0;function Ec(e){const t=hl(e),n=e.proxy,s=e.ctx;_i=!1,t.beforeCreate&&Mr(t.beforeCreate,e,"bc");const{data:i,computed:r,methods:a,watch:l,provide:o,inject:u,created:d,beforeMount:h,mounted:p,beforeUpdate:f,updated:k,activated:g,deactivated:S,beforeDestroy:R,beforeUnmount:y,destroyed:x,unmounted:$,render:P,renderTracked:C,renderTriggered:m,errorCaptured:A,serverPrefetch:F,expose:D,inheritAttrs:O,components:z,directives:B,filters:M}=t;if(u&&Rc(u,s,null),a)for(const ne in a){const ee=a[ne];de(ee)&&(s[ne]=ee.bind(n))}if(i){const ne=i.call(n,n);Te(ne)&&(e.data=zi(ne))}if(_i=!0,r)for(const ne in r){const ee=r[ne],pe=de(ee)?ee.bind(n,n):de(ee.get)?ee.get.bind(n,n):bt,Ee=!de(ee)&&de(ee.set)?ee.set.bind(n):bt,Oe=ie({get:pe,set:Ee});Object.defineProperty(s,ne,{enumerable:!0,configurable:!0,get:()=>Oe.value,set:Be=>Oe.value=Be})}if(l)for(const ne in l)fl(l[ne],s,n,ne);if(o){const ne=de(o)?o.call(n):o;Reflect.ownKeys(ne).forEach(ee=>{Lc(ee,ne[ee])})}d&&Mr(d,e,"c");function Z(ne,ee){ue(ee)?ee.forEach(pe=>ne(pe.bind(n))):ee&&ne(ee.bind(n))}if(Z(yc,h),Z(Qe,p),Z(bc,f),Z(kc,k),Z(gc,g),Z(mc,S),Z(_c,A),Z(Sc,C),Z(Cc,m),Z(wc,y),Z(xt,$),Z(xc,F),ue(D))if(D.length){const ne=e.exposed||(e.exposed={});D.forEach(ee=>{Object.defineProperty(ne,ee,{get:()=>n[ee],set:pe=>n[ee]=pe,enumerable:!0})})}else e.exposed||(e.exposed={});P&&e.render===bt&&(e.render=P),O!=null&&(e.inheritAttrs=O),z&&(e.components=z),B&&(e.directives=B),F&&ol(e)}function Rc(e,t,n=bt){ue(e)&&(e=$i(e));for(const s in e){const i=e[s];let r;Te(i)?"default"in i?r=nn(i.from||s,i.default,!0):r=nn(i.from||s):r=nn(i),je(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:a=>r.value=a}):t[s]=r}}function Mr(e,t,n){kt(ue(e)?e.map(s=>s.bind(t.proxy)):e.bind(t.proxy),t,n)}function fl(e,t,n,s){let i=s.includes(".")?ml(n,s):()=>n[s];if(Ie(e)){const r=t[e];de(r)&&Ne(i,r)}else if(de(e))Ne(i,e.bind(n));else if(Te(e))if(ue(e))e.forEach(r=>fl(r,t,n,s));else{const r=de(e.handler)?e.handler.bind(n):t[e.handler];de(r)&&Ne(i,r,e)}}function hl(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:i,optionsCache:r,config:{optionMergeStrategies:a}}=e.appContext,l=r.get(t);let o;return l?o=l:!i.length&&!n&&!s?o=t:(o={},i.length&&i.forEach(u=>_s(o,u,a,!0)),_s(o,t,a)),Te(t)&&r.set(t,o),o}function _s(e,t,n,s=!1){const{mixins:i,extends:r}=t;r&&_s(e,r,n,!0),i&&i.forEach(a=>_s(e,a,n,!0));for(const a in t)if(!(s&&a==="expose")){const l=Ac[a]||n&&n[a];e[a]=l?l(e[a],t[a]):t[a]}return e}const Ac={data:Ir,props:Or,emits:Or,methods:In,computed:In,beforeCreate:ze,created:ze,beforeMount:ze,mounted:ze,beforeUpdate:ze,updated:ze,beforeDestroy:ze,beforeUnmount:ze,destroyed:ze,unmounted:ze,activated:ze,deactivated:ze,errorCaptured:ze,serverPrefetch:ze,components:In,directives:In,watch:Mc,provide:Ir,inject:Pc};function Ir(e,t){return t?e?function(){return Ye(de(e)?e.call(this,this):e,de(t)?t.call(this,this):t)}:t:e}function Pc(e,t){return In($i(e),$i(t))}function $i(e){if(ue(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ze(e,t){return e?[...new Set([].concat(e,t))]:t}function In(e,t){return e?Ye(Object.create(null),e,t):t}function Or(e,t){return e?ue(e)&&ue(t)?[...new Set([...e,...t])]:Ye(Object.create(null),Pr(e),Pr(t??{})):t}function Mc(e,t){if(!e)return t;if(!t)return e;const n=Ye(Object.create(null),e);for(const s in t)n[s]=ze(e[s],t[s]);return n}function pl(){return{app:null,config:{isNativeTag:Aa,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ic=0;function Oc(e,t){return function(s,i=null){de(s)||(s=Ye({},s)),i!=null&&!Te(i)&&(i=null);const r=pl(),a=new WeakSet,l=[];let o=!1;const u=r.app={_uid:Ic++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:mu,get config(){return r.config},set config(d){},use(d,...h){return a.has(d)||(d&&de(d.install)?(a.add(d),d.install(u,...h)):de(d)&&(a.add(d),d(u,...h))),u},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),u},component(d,h){return h?(r.components[d]=h,u):r.components[d]},directive(d,h){return h?(r.directives[d]=h,u):r.directives[d]},mount(d,h,p){if(!o){const f=u._ceVNode||Ae(s,i);return f.appContext=r,p===!0?p="svg":p===!1&&(p=void 0),e(f,d,p),o=!0,u._container=d,d.__vue_app__=u,qs(f.component)}},onUnmount(d){l.push(d)},unmount(){o&&(kt(l,u._instance,16),e(null,u._container),delete u._container.__vue_app__)},provide(d,h){return r.provides[d]=h,u},runWithContext(d){const h=yn;yn=u;try{return d()}finally{yn=h}}};return u}}let yn=null;function Lc(e,t){if(We){let n=We.provides;const s=We.parent&&We.parent.provides;s===n&&(n=We.provides=Object.create(s)),n[e]=t}}function nn(e,t,n=!1){const s=uu();if(s||yn){let i=yn?yn._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&de(t)?t.call(s&&s.proxy):t}}const Nc=Symbol.for("v-scx"),Dc=()=>nn(Nc);function Ne(e,t,n){return gl(e,t,n)}function gl(e,t,n=Ce){const{immediate:s,deep:i,flush:r,once:a}=n,l=Ye({},n),o=t&&s||!t&&r!=="post";let u;if(Jn){if(r==="sync"){const f=Dc();u=f.__watcherHandles||(f.__watcherHandles=[])}else if(!o){const f=()=>{};return f.stop=bt,f.resume=bt,f.pause=bt,f}}const d=We;l.call=(f,k,g)=>kt(f,d,k,g);let h=!1;r==="post"?l.scheduler=f=>{Ve(f,d&&d.suspense)}:r!=="sync"&&(h=!0,l.scheduler=(f,k)=>{k?f():Wi(f)}),l.augmentJob=f=>{t&&(f.flags|=4),h&&(f.flags|=2,d&&(f.id=d.uid,f.i=d))};const p=oc(e,t,l);return Jn&&(u?u.push(p):o&&p()),p}function Bc(e,t,n){const s=this.proxy,i=Ie(e)?e.includes(".")?ml(s,e):()=>s[e]:e.bind(s,s);let r;de(t)?r=t:(r=t.handler,n=t);const a=es(this),l=gl(i,r.bind(s),n);return a(),l}function ml(e,t){const n=t.split(".");return()=>{let s=e;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const Fc=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${qt(t)}Modifiers`]||e[`${Vt(t)}Modifiers`];function Uc(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||Ce;let i=n;const r=t.startsWith("update:"),a=r&&Fc(s,t.slice(7));a&&(a.trim&&(i=n.map(d=>Ie(d)?d.trim():d)),a.number&&(i=n.map(Ns)));let l,o=s[l=Qs(t)]||s[l=Qs(qt(t))];!o&&r&&(o=s[l=Qs(Vt(t))]),o&&kt(o,e,6,i);const u=s[l+"Once"];if(u){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,kt(u,e,6,i)}}const Hc=new WeakMap;function vl(e,t,n=!1){const s=n?Hc:t.emitsCache,i=s.get(e);if(i!==void 0)return i;const r=e.emits;let a={},l=!1;if(!de(e)){const o=u=>{const d=vl(u,t,!0);d&&(l=!0,Ye(a,d))};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!r&&!l?(Te(e)&&s.set(e,null),null):(ue(r)?r.forEach(o=>a[o]=null):Ye(a,r),Te(e)&&s.set(e,a),a)}function Hs(e,t){return!e||!Os(t)?!1:(t=t.slice(2).replace(/Once$/,""),we(e,t[0].toLowerCase()+t.slice(1))||we(e,Vt(t))||we(e,t))}function Lr(e){const{type:t,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:a,attrs:l,emit:o,render:u,renderCache:d,props:h,data:p,setupState:f,ctx:k,inheritAttrs:g}=e,S=Cs(e);let R,y;try{if(n.shapeFlag&4){const $=i||s,P=$;R=yt(u.call(P,$,d,h,f,p,k)),y=l}else{const $=t;R=yt($.length>1?$(h,{attrs:l,slots:a,emit:o}):$(h,null)),y=t.props?l:Kc(l)}}catch($){Hn.length=0,Fs($,e,1),R=Ae(Ot)}let x=R;if(y&&g!==!1){const $=Object.keys(y),{shapeFlag:P}=x;$.length&&P&7&&(r&&$.some(Ni)&&(y=qc(y,r)),x=kn(x,y,!1,!0))}return n.dirs&&(x=kn(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&Yi(x,n.transition),R=x,Cs(S),R}const Kc=e=>{let t;for(const n in e)(n==="class"||n==="style"||Os(n))&&((t||(t={}))[n]=e[n]);return t},qc=(e,t)=>{const n={};for(const s in e)(!Ni(s)||!(s.slice(9)in t))&&(n[s]=e[s]);return n};function jc(e,t,n){const{props:s,children:i,component:r}=e,{props:a,children:l,patchFlag:o}=t,u=r.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&o>=0){if(o&1024)return!0;if(o&16)return s?Nr(s,a,u):!!a;if(o&8){const d=t.dynamicProps;for(let h=0;h<d.length;h++){const p=d[h];if(a[p]!==s[p]&&!Hs(u,p))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:s===a?!1:s?a?Nr(s,a,u):!0:!!a;return!1}function Nr(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(t[r]!==e[r]&&!Hs(n,r))return!0}return!1}function zc({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s===e)(e=t.vnode).el=n,t=t.parent;else break}}const yl={},bl=()=>Object.create(yl),kl=e=>Object.getPrototypeOf(e)===yl;function Vc(e,t,n,s=!1){const i={},r=bl();e.propsDefaults=Object.create(null),wl(e,t,i,r);for(const a in e.propsOptions[0])a in i||(i[a]=void 0);n?e.props=s?i:ec(i):e.type.props?e.props=i:e.props=r,e.attrs=r}function Gc(e,t,n,s){const{props:i,attrs:r,vnode:{patchFlag:a}}=e,l=ke(i),[o]=e.propsOptions;let u=!1;if((s||a>0)&&!(a&16)){if(a&8){const d=e.vnode.dynamicProps;for(let h=0;h<d.length;h++){let p=d[h];if(Hs(e.emitsOptions,p))continue;const f=t[p];if(o)if(we(r,p))f!==r[p]&&(r[p]=f,u=!0);else{const k=qt(p);i[k]=Ti(o,l,k,f,e,!1)}else f!==r[p]&&(r[p]=f,u=!0)}}}else{wl(e,t,i,r)&&(u=!0);let d;for(const h in l)(!t||!we(t,h)&&((d=Vt(h))===h||!we(t,d)))&&(o?n&&(n[h]!==void 0||n[d]!==void 0)&&(i[h]=Ti(o,l,h,void 0,e,!0)):delete i[h]);if(r!==l)for(const h in r)(!t||!we(t,h))&&(delete r[h],u=!0)}u&&Tt(e.attrs,"set","")}function wl(e,t,n,s){const[i,r]=e.propsOptions;let a=!1,l;if(t)for(let o in t){if(Ln(o))continue;const u=t[o];let d;i&&we(i,d=qt(o))?!r||!r.includes(d)?n[d]=u:(l||(l={}))[d]=u:Hs(e.emitsOptions,o)||(!(o in s)||u!==s[o])&&(s[o]=u,a=!0)}if(r){const o=ke(n),u=l||Ce;for(let d=0;d<r.length;d++){const h=r[d];n[h]=Ti(i,o,h,u[h],e,!we(u,h))}}return a}function Ti(e,t,n,s,i,r){const a=e[n];if(a!=null){const l=we(a,"default");if(l&&s===void 0){const o=a.default;if(a.type!==Function&&!a.skipFactory&&de(o)){const{propsDefaults:u}=i;if(n in u)s=u[n];else{const d=es(i);s=u[n]=o.call(null,t),d()}}else s=o;i.ce&&i.ce._setProp(n,s)}a[0]&&(r&&!l?s=!1:a[1]&&(s===""||s===Vt(n))&&(s=!0))}return s}const Wc=new WeakMap;function xl(e,t,n=!1){const s=n?Wc:t.propsCache,i=s.get(e);if(i)return i;const r=e.props,a={},l=[];let o=!1;if(!de(e)){const d=h=>{o=!0;const[p,f]=xl(h,t,!0);Ye(a,p),f&&l.push(...f)};!n&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!r&&!o)return Te(e)&&s.set(e,pn),pn;if(ue(r))for(let d=0;d<r.length;d++){const h=qt(r[d]);Dr(h)&&(a[h]=Ce)}else if(r)for(const d in r){const h=qt(d);if(Dr(h)){const p=r[d],f=a[h]=ue(p)||de(p)?{type:p}:Ye({},p),k=f.type;let g=!1,S=!0;if(ue(k))for(let R=0;R<k.length;++R){const y=k[R],x=de(y)&&y.name;if(x==="Boolean"){g=!0;break}else x==="String"&&(S=!1)}else g=de(k)&&k.name==="Boolean";f[0]=g,f[1]=S,(g||we(f,"default"))&&l.push(h)}}const u=[a,l];return Te(e)&&s.set(e,u),u}function Dr(e){return e[0]!=="$"&&!Ln(e)}const Qi=e=>e==="_"||e==="_ctx"||e==="$stable",Zi=e=>ue(e)?e.map(yt):[yt(e)],Jc=(e,t,n)=>{if(t._n)return t;const s=Rt((...i)=>Zi(t(...i)),n);return s._c=!1,s},Cl=(e,t,n)=>{const s=e._ctx;for(const i in e){if(Qi(i))continue;const r=e[i];if(de(r))t[i]=Jc(i,r,s);else if(r!=null){const a=Zi(r);t[i]=()=>a}}},Sl=(e,t)=>{const n=Zi(t);e.slots.default=()=>n},_l=(e,t,n)=>{for(const s in t)(n||!Qi(s))&&(e[s]=t[s])},Yc=(e,t,n)=>{const s=e.slots=bl();if(e.vnode.shapeFlag&32){const i=t._;i?(_l(s,t,n),n&&La(s,"_",i,!0)):Cl(t,s)}else t&&Sl(e,t)},Qc=(e,t,n)=>{const{vnode:s,slots:i}=e;let r=!0,a=Ce;if(s.shapeFlag&32){const l=t._;l?n&&l===1?r=!1:_l(i,t,n):(r=!t.$stable,Cl(t,i)),a=t}else t&&(Sl(e,t),a={default:1});if(r)for(const l in i)!Qi(l)&&a[l]==null&&delete i[l]},Ve=nu;function Zc(e){return Xc(e)}function Xc(e,t){const n=Ds();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:a,createText:l,createComment:o,setText:u,setElementText:d,parentNode:h,nextSibling:p,setScopeId:f=bt,insertStaticContent:k}=e,g=(v,w,T,U=null,j=null,V=null,Q=void 0,J=null,W=!!w.dynamicChildren)=>{if(v===w)return;v&&!Rn(v,w)&&(U=pt(v),Be(v,j,V,!0),v=null),w.patchFlag===-2&&(W=!1,w.dynamicChildren=null);const{type:q,ref:re,shapeFlag:Y}=w;switch(q){case Ks:S(v,w,T,U);break;case Ot:R(v,w,T,U);break;case ms:v==null&&y(w,T,U,Q);break;case oe:z(v,w,T,U,j,V,Q,J,W);break;default:Y&1?P(v,w,T,U,j,V,Q,J,W):Y&6?B(v,w,T,U,j,V,Q,J,W):(Y&64||Y&128)&&q.process(v,w,T,U,j,V,Q,J,W,X)}re!=null&&j?Fn(re,v&&v.ref,V,w||v,!w):re==null&&v&&v.ref!=null&&Fn(v.ref,null,V,v,!0)},S=(v,w,T,U)=>{if(v==null)s(w.el=l(w.children),T,U);else{const j=w.el=v.el;w.children!==v.children&&u(j,w.children)}},R=(v,w,T,U)=>{v==null?s(w.el=o(w.children||""),T,U):w.el=v.el},y=(v,w,T,U)=>{[v.el,v.anchor]=k(v.children,w,T,U,v.el,v.anchor)},x=({el:v,anchor:w},T,U)=>{let j;for(;v&&v!==w;)j=p(v),s(v,T,U),v=j;s(w,T,U)},$=({el:v,anchor:w})=>{let T;for(;v&&v!==w;)T=p(v),i(v),v=T;i(w)},P=(v,w,T,U,j,V,Q,J,W)=>{if(w.type==="svg"?Q="svg":w.type==="math"&&(Q="mathml"),v==null)C(w,T,U,j,V,Q,J,W);else{const q=v.el&&v.el._isVueCE?v.el:null;try{q&&q._beginPatch(),F(v,w,j,V,Q,J,W)}finally{q&&q._endPatch()}}},C=(v,w,T,U,j,V,Q,J)=>{let W,q;const{props:re,shapeFlag:Y,transition:te,dirs:ce}=v;if(W=v.el=a(v.type,V,re&&re.is,re),Y&8?d(W,v.children):Y&16&&A(v.children,W,null,U,j,si(v,V),Q,J),ce&&Wt(v,null,U,"created"),m(W,v,v.scopeId,Q,U),re){for(const be in re)be!=="value"&&!Ln(be)&&r(W,be,null,re[be],V,U);"value"in re&&r(W,"value",null,re.value,V),(q=re.onVnodeBeforeMount)&&mt(q,U,v)}ce&&Wt(v,null,U,"beforeMount");const fe=eu(j,te);fe&&te.beforeEnter(W),s(W,w,T),((q=re&&re.onVnodeMounted)||fe||ce)&&Ve(()=>{q&&mt(q,U,v),fe&&te.enter(W),ce&&Wt(v,null,U,"mounted")},j)},m=(v,w,T,U,j)=>{if(T&&f(v,T),U)for(let V=0;V<U.length;V++)f(v,U[V]);if(j){let V=j.subTree;if(w===V||Tl(V.type)&&(V.ssContent===w||V.ssFallback===w)){const Q=j.vnode;m(v,Q,Q.scopeId,Q.slotScopeIds,j.parent)}}},A=(v,w,T,U,j,V,Q,J,W=0)=>{for(let q=W;q<v.length;q++){const re=v[q]=J?Ht(v[q]):yt(v[q]);g(null,re,w,T,U,j,V,Q,J)}},F=(v,w,T,U,j,V,Q)=>{const J=w.el=v.el;let{patchFlag:W,dynamicChildren:q,dirs:re}=w;W|=v.patchFlag&16;const Y=v.props||Ce,te=w.props||Ce;let ce;if(T&&Jt(T,!1),(ce=te.onVnodeBeforeUpdate)&&mt(ce,T,w,v),re&&Wt(w,v,T,"beforeUpdate"),T&&Jt(T,!0),(Y.innerHTML&&te.innerHTML==null||Y.textContent&&te.textContent==null)&&d(J,""),q?D(v.dynamicChildren,q,J,T,U,si(w,j),V):Q||ee(v,w,J,null,T,U,si(w,j),V,!1),W>0){if(W&16)O(J,Y,te,T,j);else if(W&2&&Y.class!==te.class&&r(J,"class",null,te.class,j),W&4&&r(J,"style",Y.style,te.style,j),W&8){const fe=w.dynamicProps;for(let be=0;be<fe.length;be++){const ge=fe[be],Le=Y[ge],H=te[ge];(H!==Le||ge==="value")&&r(J,ge,Le,H,j,T)}}W&1&&v.children!==w.children&&d(J,w.children)}else!Q&&q==null&&O(J,Y,te,T,j);((ce=te.onVnodeUpdated)||re)&&Ve(()=>{ce&&mt(ce,T,w,v),re&&Wt(w,v,T,"updated")},U)},D=(v,w,T,U,j,V,Q)=>{for(let J=0;J<w.length;J++){const W=v[J],q=w[J],re=W.el&&(W.type===oe||!Rn(W,q)||W.shapeFlag&198)?h(W.el):T;g(W,q,re,null,U,j,V,Q,!0)}},O=(v,w,T,U,j)=>{if(w!==T){if(w!==Ce)for(const V in w)!Ln(V)&&!(V in T)&&r(v,V,w[V],null,j,U);for(const V in T){if(Ln(V))continue;const Q=T[V],J=w[V];Q!==J&&V!=="value"&&r(v,V,J,Q,j,U)}"value"in T&&r(v,"value",w.value,T.value,j)}},z=(v,w,T,U,j,V,Q,J,W)=>{const q=w.el=v?v.el:l(""),re=w.anchor=v?v.anchor:l("");let{patchFlag:Y,dynamicChildren:te,slotScopeIds:ce}=w;ce&&(J=J?J.concat(ce):ce),v==null?(s(q,T,U),s(re,T,U),A(w.children||[],T,re,j,V,Q,J,W)):Y>0&&Y&64&&te&&v.dynamicChildren?(D(v.dynamicChildren,te,T,j,V,Q,J),(w.key!=null||j&&w===j.subTree)&&Xi(v,w,!0)):ee(v,w,T,re,j,V,Q,J,W)},B=(v,w,T,U,j,V,Q,J,W)=>{w.slotScopeIds=J,v==null?w.shapeFlag&512?j.ctx.activate(w,T,U,Q,W):M(w,T,U,j,V,Q,W):ae(v,w,W)},M=(v,w,T,U,j,V,Q)=>{const J=v.component=cu(v,U,j);if(cl(v)&&(J.ctx.renderer=X),du(J,!1,Q),J.asyncDep){if(j&&j.registerDep(J,Z,Q),!v.el){const W=J.subTree=Ae(Ot);R(null,W,w,T),v.placeholder=W.el}}else Z(J,v,w,T,j,V,Q)},ae=(v,w,T)=>{const U=w.component=v.component;if(jc(v,w,T))if(U.asyncDep&&!U.asyncResolved){ne(U,w,T);return}else U.next=w,U.update();else w.el=v.el,U.vnode=w},Z=(v,w,T,U,j,V,Q)=>{const J=()=>{if(v.isMounted){let{next:Y,bu:te,u:ce,parent:fe,vnode:be}=v;{const N=$l(v);if(N){Y&&(Y.el=be.el,ne(v,Y,Q)),N.asyncDep.then(()=>{v.isUnmounted||J()});return}}let ge=Y,Le;Jt(v,!1),Y?(Y.el=be.el,ne(v,Y,Q)):Y=be,te&&ps(te),(Le=Y.props&&Y.props.onVnodeBeforeUpdate)&&mt(Le,fe,Y,be),Jt(v,!0);const H=Lr(v),E=v.subTree;v.subTree=H,g(E,H,h(E.el),pt(E),v,j,V),Y.el=H.el,ge===null&&zc(v,H.el),ce&&Ve(ce,j),(Le=Y.props&&Y.props.onVnodeUpdated)&&Ve(()=>mt(Le,fe,Y,be),j)}else{let Y;const{el:te,props:ce}=w,{bm:fe,m:be,parent:ge,root:Le,type:H}=v,E=vn(w);Jt(v,!1),fe&&ps(fe),!E&&(Y=ce&&ce.onVnodeBeforeMount)&&mt(Y,ge,w),Jt(v,!0);{Le.ce&&Le.ce._def.shadowRoot!==!1&&Le.ce._injectChildStyle(H);const N=v.subTree=Lr(v);g(null,N,T,U,v,j,V),w.el=N.el}if(be&&Ve(be,j),!E&&(Y=ce&&ce.onVnodeMounted)){const N=w;Ve(()=>mt(Y,ge,N),j)}(w.shapeFlag&256||ge&&vn(ge.vnode)&&ge.vnode.shapeFlag&256)&&v.a&&Ve(v.a,j),v.isMounted=!0,w=T=U=null}};v.scope.on();const W=v.effect=new Fa(J);v.scope.off();const q=v.update=W.run.bind(W),re=v.job=W.runIfDirty.bind(W);re.i=v,re.id=v.uid,W.scheduler=()=>Wi(re),Jt(v,!0),q()},ne=(v,w,T)=>{w.component=v;const U=v.vnode.props;v.vnode=w,v.next=null,Gc(v,w.props,U,T),Qc(v,w.children,T),Pt(),$r(v),Mt()},ee=(v,w,T,U,j,V,Q,J,W=!1)=>{const q=v&&v.children,re=v?v.shapeFlag:0,Y=w.children,{patchFlag:te,shapeFlag:ce}=w;if(te>0){if(te&128){Ee(q,Y,T,U,j,V,Q,J,W);return}else if(te&256){pe(q,Y,T,U,j,V,Q,J,W);return}}ce&8?(re&16&&Xe(q,j,V),Y!==q&&d(T,Y)):re&16?ce&16?Ee(q,Y,T,U,j,V,Q,J,W):Xe(q,j,V,!0):(re&8&&d(T,""),ce&16&&A(Y,T,U,j,V,Q,J,W))},pe=(v,w,T,U,j,V,Q,J,W)=>{v=v||pn,w=w||pn;const q=v.length,re=w.length,Y=Math.min(q,re);let te;for(te=0;te<Y;te++){const ce=w[te]=W?Ht(w[te]):yt(w[te]);g(v[te],ce,T,null,j,V,Q,J,W)}q>re?Xe(v,j,V,!0,!1,Y):A(w,T,U,j,V,Q,J,W,Y)},Ee=(v,w,T,U,j,V,Q,J,W)=>{let q=0;const re=w.length;let Y=v.length-1,te=re-1;for(;q<=Y&&q<=te;){const ce=v[q],fe=w[q]=W?Ht(w[q]):yt(w[q]);if(Rn(ce,fe))g(ce,fe,T,null,j,V,Q,J,W);else break;q++}for(;q<=Y&&q<=te;){const ce=v[Y],fe=w[te]=W?Ht(w[te]):yt(w[te]);if(Rn(ce,fe))g(ce,fe,T,null,j,V,Q,J,W);else break;Y--,te--}if(q>Y){if(q<=te){const ce=te+1,fe=ce<re?w[ce].el:U;for(;q<=te;)g(null,w[q]=W?Ht(w[q]):yt(w[q]),T,fe,j,V,Q,J,W),q++}}else if(q>te)for(;q<=Y;)Be(v[q],j,V,!0),q++;else{const ce=q,fe=q,be=new Map;for(q=fe;q<=te;q++){const Fe=w[q]=W?Ht(w[q]):yt(w[q]);Fe.key!=null&&be.set(Fe.key,q)}let ge,Le=0;const H=te-fe+1;let E=!1,N=0;const he=new Array(H);for(q=0;q<H;q++)he[q]=0;for(q=ce;q<=Y;q++){const Fe=v[q];if(Le>=H){Be(Fe,j,V,!0);continue}let se;if(Fe.key!=null)se=be.get(Fe.key);else for(ge=fe;ge<=te;ge++)if(he[ge-fe]===0&&Rn(Fe,w[ge])){se=ge;break}se===void 0?Be(Fe,j,V,!0):(he[se-fe]=q+1,se>=N?N=se:E=!0,g(Fe,w[se],T,null,j,V,Q,J,W),Le++)}const Ue=E?tu(he):pn;for(ge=Ue.length-1,q=H-1;q>=0;q--){const Fe=fe+q,se=w[Fe],lt=w[Fe+1],yr=Fe+1<re?lt.el||lt.placeholder:U;he[q]===0?g(null,se,T,yr,j,V,Q,J,W):E&&(ge<0||q!==Ue[ge]?Oe(se,T,yr,2):ge--)}}},Oe=(v,w,T,U,j=null)=>{const{el:V,type:Q,transition:J,children:W,shapeFlag:q}=v;if(q&6){Oe(v.component.subTree,w,T,U);return}if(q&128){v.suspense.move(w,T,U);return}if(q&64){Q.move(v,w,T,X);return}if(Q===oe){s(V,w,T);for(let Y=0;Y<W.length;Y++)Oe(W[Y],w,T,U);s(v.anchor,w,T);return}if(Q===ms){x(v,w,T);return}if(U!==2&&q&1&&J)if(U===0)J.beforeEnter(V),s(V,w,T),Ve(()=>J.enter(V),j);else{const{leave:Y,delayLeave:te,afterLeave:ce}=J,fe=()=>{v.ctx.isUnmounted?i(V):s(V,w,T)},be=()=>{V._isLeaving&&V[pc](!0),Y(V,()=>{fe(),ce&&ce()})};te?te(V,fe,be):be()}else s(V,w,T)},Be=(v,w,T,U=!1,j=!1)=>{const{type:V,props:Q,ref:J,children:W,dynamicChildren:q,shapeFlag:re,patchFlag:Y,dirs:te,cacheIndex:ce}=v;if(Y===-2&&(j=!1),J!=null&&(Pt(),Fn(J,null,T,v,!0),Mt()),ce!=null&&(w.renderCache[ce]=void 0),re&256){w.ctx.deactivate(v);return}const fe=re&1&&te,be=!vn(v);let ge;if(be&&(ge=Q&&Q.onVnodeBeforeUnmount)&&mt(ge,w,v),re&6)st(v.component,T,U);else{if(re&128){v.suspense.unmount(T,U);return}fe&&Wt(v,null,w,"beforeUnmount"),re&64?v.type.remove(v,w,T,X,U):q&&!q.hasOnce&&(V!==oe||Y>0&&Y&64)?Xe(q,w,T,!1,!0):(V===oe&&Y&384||!j&&re&16)&&Xe(W,w,T),U&&Dt(v)}(be&&(ge=Q&&Q.onVnodeUnmounted)||fe)&&Ve(()=>{ge&&mt(ge,w,v),fe&&Wt(v,null,w,"unmounted")},T)},Dt=v=>{const{type:w,el:T,anchor:U,transition:j}=v;if(w===oe){Ct(T,U);return}if(w===ms){$(v);return}const V=()=>{i(T),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(v.shapeFlag&1&&j&&!j.persisted){const{leave:Q,delayLeave:J}=j,W=()=>Q(T,V);J?J(v.el,V,W):W()}else V()},Ct=(v,w)=>{let T;for(;v!==w;)T=p(v),i(v),v=T;i(w)},st=(v,w,T)=>{const{bum:U,scope:j,job:V,subTree:Q,um:J,m:W,a:q}=v;Br(W),Br(q),U&&ps(U),j.stop(),V&&(V.flags|=8,Be(Q,v,w,T)),J&&Ve(J,w),Ve(()=>{v.isUnmounted=!0},w)},Xe=(v,w,T,U=!1,j=!1,V=0)=>{for(let Q=V;Q<v.length;Q++)Be(v[Q],w,T,U,j)},pt=v=>{if(v.shapeFlag&6)return pt(v.component.subTree);if(v.shapeFlag&128)return v.suspense.next();const w=p(v.anchor||v.el),T=w&&w[rl];return T?p(T):w};let it=!1;const gt=(v,w,T)=>{v==null?w._vnode&&Be(w._vnode,null,null,!0):g(w._vnode||null,v,w,null,null,null,T),w._vnode=v,it||(it=!0,$r(),nl(),it=!1)},X={p:g,um:Be,m:Oe,r:Dt,mt:M,mc:A,pc:ee,pbc:D,n:pt,o:e};return{render:gt,hydrate:void 0,createApp:Oc(gt)}}function si({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Jt({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function eu(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function Xi(e,t,n=!1){const s=e.children,i=t.children;if(ue(s)&&ue(i))for(let r=0;r<s.length;r++){const a=s[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=Ht(i[r]),l.el=a.el),!n&&l.patchFlag!==-2&&Xi(a,l)),l.type===Ks&&l.patchFlag!==-1&&(l.el=a.el),l.type===Ot&&!l.el&&(l.el=a.el)}}function tu(e){const t=e.slice(),n=[0];let s,i,r,a,l;const o=e.length;for(s=0;s<o;s++){const u=e[s];if(u!==0){if(i=n[n.length-1],e[i]<u){t[s]=i,n.push(s);continue}for(r=0,a=n.length-1;r<a;)l=r+a>>1,e[n[l]]<u?r=l+1:a=l;u<e[n[r]]&&(r>0&&(t[s]=n[r-1]),n[r]=s)}}for(r=n.length,a=n[r-1];r-- >0;)n[r]=a,a=t[a];return n}function $l(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:$l(t)}function Br(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Tl=e=>e.__isSuspense;function nu(e,t){t&&t.pendingBranch?ue(e)?t.effects.push(...e):t.effects.push(e):dc(e)}const oe=Symbol.for("v-fgt"),Ks=Symbol.for("v-txt"),Ot=Symbol.for("v-cmt"),ms=Symbol.for("v-stc"),Hn=[];let tt=null;function b(e=!1){Hn.push(tt=e?null:[])}function su(){Hn.pop(),tt=Hn[Hn.length-1]||null}let Wn=1;function Fr(e,t=!1){Wn+=e,e<0&&tt&&t&&(tt.hasOnce=!0)}function El(e){return e.dynamicChildren=Wn>0?tt||pn:null,su(),Wn>0&&tt&&tt.push(e),e}function _(e,t,n,s,i,r){return El(c(e,t,n,s,i,r,!0))}function Pe(e,t,n,s,i){return El(Ae(e,t,n,s,i,!0))}function er(e){return e?e.__v_isVNode===!0:!1}function Rn(e,t){return e.type===t.type&&e.key===t.key}const Rl=({key:e})=>e??null,vs=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Ie(e)||je(e)||de(e)?{i:qe,r:e,k:t,f:!!n}:e:null);function c(e,t=null,n=null,s=0,i=null,r=e===oe?0:1,a=!1,l=!1){const o={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Rl(t),ref:t&&vs(t),scopeId:il,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:qe};return l?(tr(o,n),r&128&&e.normalize(o)):n&&(o.shapeFlag|=Ie(n)?8:16),Wn>0&&!a&&tt&&(o.patchFlag>0||r&6)&&o.patchFlag!==32&&tt.push(o),o}const Ae=iu;function iu(e,t=null,n=null,s=0,i=null,r=!1){if((!e||e===$c)&&(e=Ot),er(e)){const l=kn(e,t,!0);return n&&tr(l,n),Wn>0&&!r&&tt&&(l.shapeFlag&6?tt[tt.indexOf(e)]=l:tt.push(l)),l.patchFlag=-2,l}if(gu(e)&&(e=e.__vccOpts),t){t=ru(t);let{class:l,style:o}=t;l&&!Ie(l)&&(t.class=Se(l)),Te(o)&&(Gi(o)&&!ue(o)&&(o=Ye({},o)),t.style=Zn(o))}const a=Ie(e)?1:Tl(e)?128:fc(e)?64:Te(e)?4:de(e)?2:0;return c(e,t,n,s,i,a,r,!0)}function ru(e){return e?Gi(e)||kl(e)?Ye({},e):e:null}function kn(e,t,n=!1,s=!1){const{props:i,ref:r,patchFlag:a,children:l,transition:o}=e,u=t?au(i||{},t):i,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&Rl(u),ref:t&&t.ref?n&&r?ue(r)?r.concat(vs(t)):[r,vs(t)]:vs(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==oe?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:o,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&kn(e.ssContent),ssFallback:e.ssFallback&&kn(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return o&&s&&Yi(d,o.clone(d)),d}function nt(e=" ",t=0){return Ae(Ks,null,e,t)}function ii(e,t){const n=Ae(ms,null,e);return n.staticCount=t,n}function K(e="",t=!1){return t?(b(),Pe(Ot,null,e)):Ae(Ot,null,e)}function yt(e){return e==null||typeof e=="boolean"?Ae(Ot):ue(e)?Ae(oe,null,e.slice()):er(e)?Ht(e):Ae(Ks,null,String(e))}function Ht(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:kn(e)}function tr(e,t){let n=0;const{shapeFlag:s}=e;if(t==null)t=null;else if(ue(t))n=16;else if(typeof t=="object")if(s&65){const i=t.default;i&&(i._c&&(i._d=!1),tr(e,i()),i._c&&(i._d=!0));return}else{n=32;const i=t._;!i&&!kl(t)?t._ctx=qe:i===3&&qe&&(qe.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else de(t)?(t={default:t,_ctx:qe},n=32):(t=String(t),s&64?(n=16,t=[nt(t)]):n=8);e.children=t,e.shapeFlag|=n}function au(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const i in s)if(i==="class")t.class!==s.class&&(t.class=Se([t.class,s.class]));else if(i==="style")t.style=Zn([t.style,s.style]);else if(Os(i)){const r=t[i],a=s[i];a&&r!==a&&!(ue(r)&&r.includes(a))&&(t[i]=r?[].concat(r,a):a)}else i!==""&&(t[i]=s[i])}return t}function mt(e,t,n,s=null){kt(e,t,7,[n,s])}const lu=pl();let ou=0;function cu(e,t,n){const s=e.type,i=(t?t.appContext:e.appContext)||lu,r={uid:ou++,vnode:e,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Oo(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xl(s,i),emitsOptions:vl(s,i),emit:null,emitted:null,propsDefaults:Ce,inheritAttrs:s.inheritAttrs,ctx:Ce,data:Ce,props:Ce,attrs:Ce,slots:Ce,refs:Ce,setupState:Ce,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=Uc.bind(null,r),e.ce&&e.ce(r),r}let We=null;const uu=()=>We||qe;let $s,Ei;{const e=Ds(),t=(n,s)=>{let i;return(i=e[n])||(i=e[n]=[]),i.push(s),r=>{i.length>1?i.forEach(a=>a(r)):i[0](r)}};$s=t("__VUE_INSTANCE_SETTERS__",n=>We=n),Ei=t("__VUE_SSR_SETTERS__",n=>Jn=n)}const es=e=>{const t=We;return $s(e),e.scope.on(),()=>{e.scope.off(),$s(t)}},Ur=()=>{We&&We.scope.off(),$s(null)};function Al(e){return e.vnode.shapeFlag&4}let Jn=!1;function du(e,t=!1,n=!1){t&&Ei(t);const{props:s,children:i}=e.vnode,r=Al(e);Vc(e,s,r,t),Yc(e,i,n||t);const a=r?fu(e,t):void 0;return t&&Ei(!1),a}function fu(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Tc);const{setup:s}=n;if(s){Pt();const i=e.setupContext=s.length>1?pu(e):null,r=es(e),a=Xn(s,e,0,[e.props,i]),l=Pa(a);if(Mt(),r(),(l||e.sp)&&!vn(e)&&ol(e),l){if(a.then(Ur,Ur),t)return a.then(o=>{Hr(e,o)}).catch(o=>{Fs(o,e,0)});e.asyncDep=a}else Hr(e,a)}else Pl(e)}function Hr(e,t,n){de(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Te(t)&&(e.setupState=Xa(t)),Pl(e)}function Pl(e,t,n){const s=e.type;e.render||(e.render=s.render||bt);{const i=es(e);Pt();try{Ec(e)}finally{Mt(),i()}}}const hu={get(e,t){return Ke(e,"get",""),e[t]}};function pu(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,hu),slots:e.slots,emit:e.emit,expose:t}}function qs(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Xa(tc(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Un)return Un[n](e)},has(t,n){return n in t||n in Un}})):e.proxy}function gu(e){return de(e)&&"__vccOpts"in e}const ie=(e,t)=>ac(e,t,Jn),mu="3.5.25";/**
* @vue/runtime-dom v3.5.25
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ri;const Kr=typeof window<"u"&&window.trustedTypes;if(Kr)try{Ri=Kr.createPolicy("vue",{createHTML:e=>e})}catch{}const Ml=Ri?e=>Ri.createHTML(e):e=>e,vu="http://www.w3.org/2000/svg",yu="http://www.w3.org/1998/Math/MathML",$t=typeof document<"u"?document:null,qr=$t&&$t.createElement("template"),bu={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const i=t==="svg"?$t.createElementNS(vu,e):t==="mathml"?$t.createElementNS(yu,e):n?$t.createElement(e,{is:n}):$t.createElement(e);return e==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:e=>$t.createTextNode(e),createComment:e=>$t.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>$t.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,i,r){const a=n?n.previousSibling:t.lastChild;if(i&&(i===r||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{qr.innerHTML=Ml(s==="svg"?`<svg>${e}</svg>`:s==="mathml"?`<math>${e}</math>`:e);const l=qr.content;if(s==="svg"||s==="mathml"){const o=l.firstChild;for(;o.firstChild;)l.appendChild(o.firstChild);l.removeChild(o)}t.insertBefore(l,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},ku=Symbol("_vtc");function wu(e,t,n){const s=e[ku];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const jr=Symbol("_vod"),xu=Symbol("_vsh"),Cu=Symbol(""),Su=/(?:^|;)\s*display\s*:/;function _u(e,t,n){const s=e.style,i=Ie(n);let r=!1;if(n&&!i){if(t)if(Ie(t))for(const a of t.split(";")){const l=a.slice(0,a.indexOf(":")).trim();n[l]==null&&ys(s,l,"")}else for(const a in t)n[a]==null&&ys(s,a,"");for(const a in n)a==="display"&&(r=!0),ys(s,a,n[a])}else if(i){if(t!==n){const a=s[Cu];a&&(n+=";"+a),s.cssText=n,r=Su.test(n)}}else t&&e.removeAttribute("style");jr in e&&(e[jr]=r?s.display:"",e[xu]&&(s.display="none"))}const zr=/\s*!important$/;function ys(e,t,n){if(ue(n))n.forEach(s=>ys(e,t,s));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=$u(e,t);zr.test(n)?e.setProperty(Vt(s),n.replace(zr,""),"important"):e[s]=n}}const Vr=["Webkit","Moz","ms"],ri={};function $u(e,t){const n=ri[t];if(n)return n;let s=qt(t);if(s!=="filter"&&s in e)return ri[t]=s;s=Oa(s);for(let i=0;i<Vr.length;i++){const r=Vr[i]+s;if(r in e)return ri[t]=r}return t}const Gr="http://www.w3.org/1999/xlink";function Wr(e,t,n,s,i,r=Mo(t)){s&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(Gr,t.slice(6,t.length)):e.setAttributeNS(Gr,t,n):n==null||r&&!Na(n)?e.removeAttribute(t):e.setAttribute(t,r?"":dt(n)?String(n):n)}function Jr(e,t,n,s,i){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Ml(n):n);return}const r=e.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?e.getAttribute("value")||"":e.value,o=n==null?e.type==="checkbox"?"on":"":String(n);(l!==o||!("_value"in e))&&(e.value=o),n==null&&e.removeAttribute(t),e._value=n;return}let a=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=Na(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{e[t]=n}catch{}a&&e.removeAttribute(i||t)}function At(e,t,n,s){e.addEventListener(t,n,s)}function Tu(e,t,n,s){e.removeEventListener(t,n,s)}const Yr=Symbol("_vei");function Eu(e,t,n,s,i=null){const r=e[Yr]||(e[Yr]={}),a=r[t];if(s&&a)a.value=s;else{const[l,o]=Ru(t);if(s){const u=r[t]=Mu(s,i);At(e,l,u,o)}else a&&(Tu(e,l,a,o),r[t]=void 0)}}const Qr=/(?:Once|Passive|Capture)$/;function Ru(e){let t;if(Qr.test(e)){t={};let s;for(;s=e.match(Qr);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Vt(e.slice(2)),t]}let ai=0;const Au=Promise.resolve(),Pu=()=>ai||(Au.then(()=>ai=0),ai=Date.now());function Mu(e,t){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;kt(Iu(s,n.value),t,5,[s])};return n.value=e,n.attached=Pu(),n}function Iu(e,t){if(ue(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(s=>i=>!i._stopped&&s&&s(i))}else return t}const Zr=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Ou=(e,t,n,s,i,r)=>{const a=i==="svg";t==="class"?wu(e,s,a):t==="style"?_u(e,n,s):Os(t)?Ni(t)||Eu(e,t,n,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Lu(e,t,s,a))?(Jr(e,t,s),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Wr(e,t,s,a,r,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Ie(s))?Jr(e,qt(t),s,r,t):(t==="true-value"?e._trueValue=s:t==="false-value"&&(e._falseValue=s),Wr(e,t,s,a))};function Lu(e,t,n,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in e&&Zr(t)&&de(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const i=e.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Zr(t)&&Ie(n)?!1:t in e}const jt=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ue(t)?n=>ps(t,n):t};function Nu(e){e.target.composing=!0}function Xr(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const at=Symbol("_assign");function ea(e,t,n){return t&&(e=e.trim()),n&&(e=Ns(e)),e}const Re={created(e,{modifiers:{lazy:t,trim:n,number:s}},i){e[at]=jt(i);const r=s||i.props&&i.props.type==="number";At(e,t?"change":"input",a=>{a.target.composing||e[at](ea(e.value,n,r))}),(n||r)&&At(e,"change",()=>{e.value=ea(e.value,n,r)}),t||(At(e,"compositionstart",Nu),At(e,"compositionend",Xr),At(e,"change",Xr))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},a){if(e[at]=jt(a),e.composing)return;const l=(r||e.type==="number")&&!/^0\d/.test(e.value)?Ns(e.value):e.value,o=t??"";l!==o&&(document.activeElement===e&&e.type!=="range"&&(s&&t===n||i&&e.value.trim()===o)||(e.value=o))}},Ts={deep:!0,created(e,t,n){e[at]=jt(n),At(e,"change",()=>{const s=e._modelValue,i=xn(e),r=e.checked,a=e[at];if(ue(s)){const l=Fi(s,i),o=l!==-1;if(r&&!o)a(s.concat(i));else if(!r&&o){const u=[...s];u.splice(l,1),a(u)}}else if(_n(s)){const l=new Set(s);r?l.add(i):l.delete(i),a(l)}else a(Il(e,r))})},mounted:ta,beforeUpdate(e,t,n){e[at]=jt(n),ta(e,t,n)}};function ta(e,{value:t,oldValue:n},s){e._modelValue=t;let i;if(ue(t))i=Fi(t,s.props.value)>-1;else if(_n(t))i=t.has(s.props.value);else{if(t===n)return;i=rn(t,Il(e,!0))}e.checked!==i&&(e.checked=i)}const bs={created(e,{value:t},n){e.checked=rn(t,n.props.value),e[at]=jt(n),At(e,"change",()=>{e[at](xn(e))})},beforeUpdate(e,{value:t,oldValue:n},s){e[at]=jt(s),t!==n&&(e.checked=rn(t,s.props.value))}},wn={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const i=_n(t);At(e,"change",()=>{const r=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>n?Ns(xn(a)):xn(a));e[at](e.multiple?i?new Set(r):r:r[0]),e._assigning=!0,$n(()=>{e._assigning=!1})}),e[at]=jt(s)},mounted(e,{value:t}){na(e,t)},beforeUpdate(e,t,n){e[at]=jt(n)},updated(e,{value:t}){e._assigning||na(e,t)}};function na(e,t){const n=e.multiple,s=ue(t);if(!(n&&!s&&!_n(t))){for(let i=0,r=e.options.length;i<r;i++){const a=e.options[i],l=xn(a);if(n)if(s){const o=typeof l;o==="string"||o==="number"?a.selected=t.some(u=>String(u)===String(l)):a.selected=Fi(t,l)>-1}else a.selected=t.has(l);else if(rn(xn(a),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function xn(e){return"_value"in e?e._value:e.value}function Il(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const sa={created(e,t,n){as(e,t,n,null,"created")},mounted(e,t,n){as(e,t,n,null,"mounted")},beforeUpdate(e,t,n,s){as(e,t,n,s,"beforeUpdate")},updated(e,t,n,s){as(e,t,n,s,"updated")}};function Du(e,t){switch(e){case"SELECT":return wn;case"TEXTAREA":return Re;default:switch(t){case"checkbox":return Ts;case"radio":return bs;default:return Re}}}function as(e,t,n,s,i){const a=Du(e.tagName,n.props&&n.props.type)[i];a&&a(e,t,n,s)}const Bu=["ctrl","shift","alt","meta"],Fu={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Bu.some(n=>e[`${n}Key`]&&!t.includes(n))},Me=(e,t)=>{const n=e._withMods||(e._withMods={}),s=t.join(".");return n[s]||(n[s]=(i,...r)=>{for(let a=0;a<t.length;a++){const l=Fu[t[a]];if(l&&l(i,t))return}return e(i,...r)})},Uu={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},ls=(e,t)=>{const n=e._withKeys||(e._withKeys={}),s=t.join(".");return n[s]||(n[s]=i=>{if(!("key"in i))return;const r=Vt(i.key);if(t.some(a=>a===r||Uu[a]===r))return e(i)})},Hu=Ye({patchProp:Ou},bu);let ia;function Ku(){return ia||(ia=Zc(Hu))}const qu=(...e)=>{const t=Ku().createApp(...e),{mount:n}=t;return t.mount=s=>{const i=zu(s);if(!i)return;const r=t._component;!de(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const a=n(i,!1,ju(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t};function ju(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zu(e){return Ie(e)?document.querySelector(e):e}class Gt{constructor(t){this.config=t,this.capabilities=new Set,this.activeRequests=new Map}async initialize(){await this.detectCapabilities()}async detectCapabilities(){}prepareRequest(t,n){throw new Error("prepareRequest must be implemented by subclass")}processResponse(t){throw new Error("processResponse must be implemented by subclass")}async streamRequest(t,n,s){const i=this.prepareRequest(t,n),r=new AbortController,a=n.requestId||this.generateRequestId();this.activeRequests.set(a,r);try{const o=(await this.makeStreamingRequest(i,r.signal)).body.getReader(),u=new TextDecoder;let d="",h="";for(;;){const{done:p,value:f}=await o.read();if(p)break;const g=u.decode(f,{stream:!0}).split(`
`).filter(S=>S.trim());for(const S of g){const R=this.parseStreamingLine(S);if(!R)continue;const y=this.extractStreamingContent(R);if(y&&(y.content&&(d+=y.content),y.thinking&&(h+=y.thinking),s({content:y.content||"",thinking:y.thinking||"",fullContent:d,fullThinking:h,done:y.done||!1,usage:y.usage||null,finishReason:y.finishReason||null}),y.done))return d}}return d}catch(l){throw l.name==="AbortError"?new Error("Request cancelled"):l}finally{this.activeRequests.delete(a)}}async makeRequest(t,n,s){const i=n?{signal:n}:new AbortController;n||(s=s||this.generateRequestId(),this.activeRequests.set(s,i));try{const r=this.buildHeaders(),a=await fetch(this.getEndpoint(),{method:"POST",headers:r,body:JSON.stringify(t),signal:i.signal||n});if(!a.ok){const l=await a.text();throw new Error(`LLM API Error (${a.status}): ${l}`)}return a.json()}catch(r){throw r.name==="AbortError"?new Error("Request cancelled"):r}finally{!n&&s&&this.activeRequests.delete(s)}}async makeStreamingRequest(t,n){const s=this.buildHeaders(),i=await fetch(this.getStreamingEndpoint(),{method:"POST",headers:s,body:JSON.stringify(t),signal:n});if(!i.ok){const r=await i.text();throw new Error(`LLM API Error (${i.status}): ${r}`)}return i}buildHeaders(){const t={"Content-Type":"application/json"};return this.requiresAuth()&&(t[this.getAuthHeaderName()]=this.getAuthHeaderValue()),t}getStreamingEndpoint(){return`${this.config.baseUrl}${this.getApiPath()}`}getEndpoint(){return`${this.config.baseUrl}${this.getApiPath()}`}parseStreamingLine(t){throw new Error("parseStreamingLine must be implemented by subclass")}extractStreamingContent(t){throw new Error("extractStreamingContent must be implemented by subclass")}getApiPath(){throw new Error("getApiPath must be implemented by subclass")}requiresAuth(){return!1}getAuthHeaderName(){return"Authorization"}getAuthHeaderValue(){return`Bearer ${this.config.apiKey}`}generateRequestId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}cancelAllRequests(){for(const[,t]of this.activeRequests)t.abort();this.activeRequests.clear()}cancelRequest(t){const n=this.activeRequests.get(t);n&&(n.abort(),this.activeRequests.delete(t))}hasCapability(t){return this.capabilities.has(t)}async discoverModels(t=1e4){try{const n=this.buildHeaders(),s=new AbortController,i=setTimeout(()=>s.abort(),t),r=await fetch(this.getModelsEndpoint(),{method:"GET",headers:n,signal:s.signal});if(clearTimeout(i),!r.ok)throw new Error(`Failed to fetch models: ${r.status} ${r.statusText}`);const a=await r.json();return this.parseModelsResponse(a)}catch(n){throw n.name==="AbortError"?new Error("Model discovery timeout - please check your connection"):n}}getModelsEndpoint(){throw new Error("getModelsEndpoint must be implemented by subclass")}parseModelsResponse(t){throw new Error("parseModelsResponse must be implemented by subclass")}}var Is,Ol;class Vu extends Gt{constructor(){super(...arguments);kr(this,Is)}async detectCapabilities(){if(!this.config.model)return;const n=this.config.model.toLowerCase();(n.startsWith("o1")||n.startsWith("o2")||n.startsWith("o3")||n.startsWith("o-")||n.includes("gpt-5")||n==="gpt5")&&this.capabilities.add("thinking"),n.includes("gpt-4")&&n.includes("vision")&&this.capabilities.add("vision"),(n.includes("gpt-4")||n.includes("gpt-3.5")||n.includes("gpt-5"))&&this.capabilities.add("tools")}prepareRequest(n,s){const i=s.model||this.config.model||"gpt-3.5-turbo",r={model:i,messages:this.processMessages(n,s),temperature:s.temperature||.7,stream:s.stream||!1};return wr(this,Is,Ol).call(this,i)?(r.max_completion_tokens=s.maxTokens||1e3,r.temperature=1):r.max_tokens=s.maxTokens||1e3,s.enableThinking&&this.capabilities.has("thinking")&&(r.reasoning_effort=s.reasoningEffort||"medium"),s.tools&&this.capabilities.has("tools")&&(r.tools=s.tools),r}processMessages(n,s){return s.images&&this.capabilities.has("vision")?this.addImagesToMessages(n,s.images):n}addImagesToMessages(n,s){const i=n[n.length-1];if(i&&i.role==="user"){const r=[{type:"text",text:i.content}];s.forEach(a=>{r.push({type:"image_url",image_url:{url:typeof a=="string"?a:a.url}})}),i.content=r}return n}processResponse(n){var i,r,a,l,o;const s={content:((a=(r=(i=n.choices)==null?void 0:i[0])==null?void 0:r.message)==null?void 0:a.content)||"",usage:n.usage||null,finishReason:((o=(l=n.choices)==null?void 0:l[0])==null?void 0:o.finish_reason)||null};return n.reasoning&&(s.thinking=n.reasoning),s}parseStreamingLine(n){if(!n.startsWith("data: "))return null;const s=n.slice(6).trim();if(s==="[DONE]")return{done:!0};try{return JSON.parse(s)}catch{return null}}extractStreamingContent(n){var i,r,a,l;if(n.done)return{done:!0};const s=(r=(i=n.choices)==null?void 0:i[0])==null?void 0:r.delta;return{content:(s==null?void 0:s.content)||"",thinking:(s==null?void 0:s.reasoning)||"",done:!1,usage:n.usage||null,finishReason:((l=(a=n.choices)==null?void 0:a[0])==null?void 0:l.finish_reason)||null}}getApiPath(){return"/v1/chat/completions"}requiresAuth(){return!!this.config.apiKey}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(n){var s;return((s=n.data)==null?void 0:s.filter(i=>{const r=i.id.toLowerCase();return r.includes("gpt")||r.includes("chat")}).map(i=>i.id).sort())||[]}}Is=new WeakSet,Ol=function(n){const s=(n||"").toLowerCase();return s.startsWith("o1")||s.startsWith("o2")||s.startsWith("o3")||s.startsWith("o-")||s.includes("gpt-5")||s==="gpt5"||s.includes("reasoning")||this.capabilities.has("thinking")};class Gu extends Gt{async detectCapabilities(){var t;(t=this.config.model)!=null&&t.includes("claude-3")&&this.capabilities.add("vision")}prepareRequest(t,n){const s={model:n.model||this.config.model||"claude-3-sonnet-20240229",max_tokens:n.maxTokens||1e3,temperature:n.temperature||.7,messages:t.filter(r=>r.role!=="system"),stream:n.stream||!1},i=t.find(r=>r.role==="system");return i&&(s.system=i.content),s}processMessages(t,n){return n.images&&this.capabilities.has("vision")?this.addImagesToMessages(t,n.images):t}addImagesToMessages(t,n){const s=t[t.length-1];if(s&&s.role==="user"){const i=[{type:"text",text:s.content}];n.forEach(r=>{i.push({type:"image",source:{type:"base64",media_type:"image/jpeg",data:typeof r=="string"?r:r.data}})}),s.content=i}return t}processResponse(t){var s,i;const n=li(t.stop_reason);return{content:((i=(s=t.content)==null?void 0:s[0])==null?void 0:i.text)||"",usage:t.usage||null,finishReason:n}}parseStreamingLine(t){if(!t.startsWith("data: "))return null;const n=t.slice(6).trim();if(n==="[DONE]")return{done:!0};try{return JSON.parse(n)}catch{return null}}extractStreamingContent(t){var n,s,i,r;if(t.done)return{done:!0};if(t.type==="error"){const a=((n=t.error)==null?void 0:n.type)||"anthropic_error",l=new Error(((s=t.error)==null?void 0:s.message)||"Anthropic streaming error");throw l.code=a,t.request_id&&(l.requestId=t.request_id),l}return t.type==="content_block_delta"?{content:((i=t.delta)==null?void 0:i.text)||"",thinking:"",done:!1,usage:null,finishReason:null}:t.type==="message_delta"?{content:"",thinking:"",done:!1,usage:t.usage?{tokens:t.usage.output_tokens||0}:null,finishReason:li((r=t.delta)==null?void 0:r.stop_reason)}:t.type==="message_stop"?{content:"",thinking:"",done:!0,usage:null,finishReason:li(t.stop_reason)}:null}getApiPath(){return"/v1/messages"}requiresAuth(){return!!this.config.apiKey}getAuthHeaderName(){return"x-api-key"}getAuthHeaderValue(){return this.config.apiKey}buildHeaders(){const t=super.buildHeaders();return this.requiresAuth()&&(t["anthropic-version"]="2023-06-01",t["anthropic-dangerous-direct-browser-access"]="true"),t}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(t){var n;return((n=t.data)==null?void 0:n.map(s=>s.id))||[]}}function li(e){if(!e)return null;const t=String(e).toLowerCase();return t==="max_tokens"?"length":t}class Wu extends Gt{async detectCapabilities(){if(!this.config.model)return;const t=this.config.model.toLowerCase();(t.includes("grok-2")||t.includes("vision"))&&this.capabilities.add("vision"),this.capabilities.add("tools")}prepareRequest(t,n){const s={model:n.model||this.config.model||"grok-beta",messages:this.processMessages(t,n),temperature:n.temperature||.7,max_tokens:n.maxTokens||1e3,stream:n.stream||!1};return n.tools&&this.capabilities.has("tools")&&(s.tools=n.tools),s}processMessages(t,n){return n.images&&this.capabilities.has("vision")?this.addImagesToMessages(t,n.images):t}addImagesToMessages(t,n){const s=t[t.length-1];if(s&&s.role==="user"){const i=[{type:"text",text:s.content}];n.forEach(r=>i.push({type:"image_url",image_url:{url:typeof r=="string"?r:r.url}})),s.content=i}return t}processResponse(t){var n,s,i,r,a;return{content:((i=(s=(n=t.choices)==null?void 0:n[0])==null?void 0:s.message)==null?void 0:i.content)||"",usage:t.usage||null,finishReason:ra((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}parseStreamingLine(t){if(!t.startsWith("data: "))return null;const n=t.slice(6).trim();if(n==="[DONE]")return{done:!0};try{return JSON.parse(n)}catch{return null}}extractStreamingContent(t){var s,i,r,a;if(t.done)return{done:!0};const n=(i=(s=t.choices)==null?void 0:s[0])==null?void 0:i.delta;return{content:(n==null?void 0:n.content)||"",done:!1,usage:t.usage||null,finishReason:ra((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}getApiPath(){return"/v1/chat/completions"}requiresAuth(){return!!this.config.apiKey}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(t){var n,s,i;return((i=(s=(n=t.data)==null?void 0:n.filter(r=>String(r.id).toLowerCase().includes("grok")))==null?void 0:s.map(r=>r.id))==null?void 0:i.sort())||[]}}function ra(e){if(!e)return null;const t=String(e).toLowerCase();return t==="length"||t==="max_tokens"?"length":t}class Ju extends Gt{async detectCapabilities(){this.config.model&&((this.config.model.includes("gemini-pro-vision")||this.config.model.includes("gemini-1.5")||this.config.model.includes("gemini-2.0"))&&this.capabilities.add("vision"),(this.config.model.includes("gemini-pro")||this.config.model.includes("gemini-1.5")||this.config.model.includes("gemini-2.0"))&&this.capabilities.add("tools"),this.config.model.includes("gemini-2.0")&&this.capabilities.add("thinking"))}prepareRequest(t,n){const s=this.processMessages(t,n),i={contents:this.convertToGeminiFormat(s),generationConfig:{temperature:n.temperature||this.config.temperature||.7,maxOutputTokens:n.maxTokens||this.config.maxTokens||1e3,topP:.8,topK:10},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]},r=t.find(a=>a.role==="system");return r&&(i.systemInstruction={parts:[{text:r.content}]}),n.tools&&this.capabilities.has("tools")&&(i.tools=this.convertToolsToGeminiFormat(n.tools)),i}convertToGeminiFormat(t){const n=[];for(const s of t){if(s.role==="system")continue;const i=s.role==="assistant"?"model":"user";if(Array.isArray(s.content)){const r=s.content.map(a=>{var l,o;return a.type==="text"?{text:a.text}:a.type==="image"?{inlineData:{mimeType:((l=a.source)==null?void 0:l.media_type)||"image/jpeg",data:((o=a.source)==null?void 0:o.data)||a.data}}:a.type==="image_url"?{inlineData:{mimeType:"image/jpeg",data:a.image_url.url.split(",")[1]}}:{text:String(a)}});n.push({role:i,parts:r})}else n.push({role:i,parts:[{text:s.content}]})}return n}processMessages(t,n){return n.images&&this.capabilities.has("vision")?this.addImagesToMessages(t,n.images):t}addImagesToMessages(t,n){const s=t[t.length-1];if(s&&s.role==="user"){const i=[{type:"text",text:s.content}];n.forEach(r=>i.push({type:"image",data:typeof r=="string"?r:r.data,mimeType:"image/jpeg"})),s.content=i}return t}convertToolsToGeminiFormat(t){return t.map(n=>({functionDeclarations:[{name:n.function.name,description:n.function.description,parameters:n.function.parameters}]}))}processResponse(t){var s,i;const n={content:"",usage:null,finishReason:null};if(t.candidates&&t.candidates.length>0){const r=t.candidates[0];if((s=r.content)!=null&&s.parts&&(n.content=r.content.parts.filter(a=>a.text).map(a=>a.text).join("")),(i=r.content)!=null&&i.parts){const a=r.content.parts.filter(l=>l.functionCall);a.length>0&&(n.functionCalls=a)}r.finishReason&&(n.finishReason=aa(r.finishReason))}return t.usageMetadata&&(n.usage={promptTokens:t.usageMetadata.promptTokenCount,completionTokens:t.usageMetadata.candidatesTokenCount,totalTokens:t.usageMetadata.totalTokenCount}),n}async streamRequest(t,n,s){const i=this.prepareRequest(t,n),r=new AbortController,a=n.requestId||this.generateRequestId();this.activeRequests.set(a,r);try{const o=(await this.makeStreamingRequest(i,r.signal)).body.getReader(),u=new TextDecoder;let d="",h="",p="",f=0,k=0,g=!1,S=!1;for(;;){const{done:R,value:y}=await o.read();if(R)break;p+=u.decode(y,{stream:!0});for(let x=k;x<p.length;x++){const $=p[x];if(S){S=!1;continue}if($==="\\"&&g){S=!0;continue}if($==='"'){g=!g;continue}if(!g){if($==="{")f===0&&(k=x),f++;else if($==="}"&&(f--,f===0)){const P=p.slice(k,x+1);try{const C=JSON.parse(P),m=this.extractStreamingContent(C);if(m&&(m.content&&(d+=m.content),m.thinking&&(h+=m.thinking),s({content:m.content||"",thinking:m.thinking||"",fullContent:d,fullThinking:h,done:m.done||!1,usage:m.usage||null,finishReason:m.finishReason||null}),m.done))return d}catch{}k=x+1}}}f===0&&k<p.length&&(p=p.slice(k),k=0)}return d}catch(l){throw l.name==="AbortError"?new Error("Request cancelled"):l}finally{this.activeRequests.delete(a)}}extractStreamingContent(t){var l,o,u;if(!((l=t==null?void 0:t.candidates)!=null&&l.length))return null;const n=t.candidates[0];let s="",i="",r=!1,a=null;return(o=n.content)!=null&&o.parts&&(s=n.content.parts.filter(d=>d.text).map(d=>d.text).join("")),n.finishReason&&(r=!0,a=aa(n.finishReason)),((u=t.usageMetadata)==null?void 0:u.thoughtsTokenCount)>0&&(i=`[Thinking: ${t.usageMetadata.thoughtsTokenCount} tokens]`),{content:s,thinking:i,done:r,usage:t.usageMetadata?{promptTokens:t.usageMetadata.promptTokenCount,completionTokens:t.usageMetadata.candidatesTokenCount,totalTokens:t.usageMetadata.totalTokenCount}:null,finishReason:a}}getApiPath(){return`/v1beta/models/${this.config.model||"gemini-pro"}:generateContent`}getStreamingEndpoint(){const t=this.config.model||"gemini-pro";return`${this.config.baseUrl}/v1beta/models/${t}:streamGenerateContent`}requiresAuth(){return!!this.config.apiKey}getAuthHeaderName(){return"x-goog-api-key"}getAuthHeaderValue(){return this.config.apiKey}buildHeaders(){return super.buildHeaders()}getModelsEndpoint(){return`${this.config.baseUrl}/v1beta/models`}parseModelsResponse(t){var n;return((n=t.models)==null?void 0:n.filter(s=>{var r;return s.name.toLowerCase().includes("gemini")&&((r=s.supportedGenerationMethods)==null?void 0:r.includes("generateContent"))}).map(s=>s.name.split("/").pop()).sort())||[]}}function aa(e){if(!e)return null;const t=String(e).toLowerCase();return t.includes("max")&&t.includes("token")?"length":t}class Yu extends Gt{async detectCapabilities(){if(this.config.model)try{const n=(await this.fetchModelInfo()).capabilities||[];n.includes("thinking")&&this.capabilities.add("thinking"),n.includes("vision")&&this.capabilities.add("vision"),n.includes("tools")&&this.capabilities.add("tools")}catch(t){console.warn("Ollama capability detection failed:",t)}}async fetchModelInfo(){const t=await fetch(`${this.config.baseUrl}/api/show`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.config.model})});if(!t.ok)throw new Error(`Failed to fetch model info: ${t.status}`);return t.json()}prepareRequest(t,n){const s=n.model||this.config.model;if(!s)throw new Error("Model must be specified for Ollama requests");const i={model:s,messages:this.processMessages(t,n),stream:n.stream||!1,think:n.enableThinking||!1,options:{temperature:n.temperature||.7,num_predict:n.maxTokens||1e3}};return n.enableThinking&&this.capabilities.has("thinking")&&(i.options.enable_thinking=!0),i}processMessages(t,n){return n.images&&this.capabilities.has("vision")?this.addImagesToMessages(t,n.images):t}addImagesToMessages(t,n){const s=t[t.length-1];return s&&s.role==="user"&&(s.images=n.map(i=>typeof i=="string"&&i.startsWith("data:")?i.split(",")[1]:i)),t}processResponse(t){var s;const n={content:((s=t.message)==null?void 0:s.content)||"",usage:t.eval_count?{tokens:t.eval_count}:null,finishReason:la(t.finish_reason)};return t.thinking&&(n.thinking=t.thinking),n}parseStreamingLine(t){try{return JSON.parse(t)}catch{return null}}extractStreamingContent(t){var n;return{content:((n=t.message)==null?void 0:n.content)||"",thinking:t.thinking||"",done:t.done||!1,usage:t.eval_count?{tokens:t.eval_count}:null,finishReason:la(t.finish_reason)}}getApiPath(){return"/api/chat"}requiresAuth(){return!1}getModelsEndpoint(){return`${this.config.baseUrl}/api/tags`}parseModelsResponse(t){var n;return((n=t.models)==null?void 0:n.map(s=>s.name))||[]}}function la(e){if(!e)return null;const t=String(e).toLowerCase();return t==="max_tokens"?"length":t}class Qu extends Gt{async detectCapabilities(){}prepareRequest(t,n){return{model:n.model||this.config.model||"llama2",messages:t,temperature:n.temperature||.7,max_tokens:n.maxTokens||1e3,stream:n.stream||!1}}processResponse(t){var n,s,i,r,a;return{content:((i=(s=(n=t.choices)==null?void 0:n[0])==null?void 0:s.message)==null?void 0:i.content)||"",usage:t.usage||null,finishReason:oa((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}parseStreamingLine(t){if(!t.startsWith("data: "))return null;const n=t.slice(6).trim();if(n==="[DONE]")return{done:!0};try{return JSON.parse(n)}catch{return null}}extractStreamingContent(t){var n,s,i,r,a;return t.done?{done:!0}:{content:((i=(s=(n=t.choices)==null?void 0:n[0])==null?void 0:s.delta)==null?void 0:i.content)||"",thinking:"",done:!1,usage:t.usage||null,finishReason:oa((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}getApiPath(){return"/v1/chat/completions"}requiresAuth(){return!1}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(t){var n;return((n=t.data)==null?void 0:n.filter(s=>{const i=s.id.toLowerCase();return i.includes("mistral")||i.includes("llama")||i.includes("codellama")||i.includes(".gguf")||i.includes(".bin")}).map(s=>s.id).sort())||[]}}function oa(e){if(!e)return null;const t=String(e).toLowerCase();return t==="max_tokens"?"length":t}class Zu extends Gt{async detectCapabilities(){this.config.model&&(this.capabilities.add("tools"),(this.config.model.includes("o1")||this.config.model.includes("thinking")||this.config.model.includes("reasoning"))&&this.capabilities.add("thinking"),(this.config.model.includes("vision")||this.config.model.includes("gpt-4")||this.config.model.includes("claude")||this.config.model.includes("gemini"))&&this.capabilities.add("vision"))}prepareRequest(t,n){const s={model:n.model||this.config.model,messages:this.processMessages(t,n),temperature:n.temperature||.7,max_tokens:n.maxTokens||1e3,stream:n.stream||!1};return n.enableThinking&&this.capabilities.has("thinking")&&(s.reasoning=n.reasoning!==!1,n.reasoningEffort&&(s.reasoning_effort=n.reasoningEffort)),n.tools&&this.capabilities.has("tools")&&(s.tools=n.tools,n.tool_choice&&(s.tool_choice=n.tool_choice)),s}processMessages(t,n){return n.images&&this.capabilities.has("vision")?this.addImagesToMessages(t,n.images):t}addImagesToMessages(t,n){const s=t[t.length-1];return s&&s.role==="user"&&(s.content=[{type:"text",text:s.content},...n.map(i=>({type:"image_url",image_url:{url:i}}))]),t}buildHeaders(){const t={"Content-Type":"application/json"};return this.requiresAuth()&&(t[this.getAuthHeaderName()]=this.getAuthHeaderValue()),this.config.siteUrl&&(t["HTTP-Referer"]=this.config.siteUrl),this.config.siteName&&(t["X-Title"]=this.config.siteName),t}processResponse(t){var s,i,r,a,l,o,u,d;const n={content:((r=(i=(s=t.choices)==null?void 0:s[0])==null?void 0:i.message)==null?void 0:r.content)||"",usage:t.usage||null,finishReason:ca((l=(a=t.choices)==null?void 0:a[0])==null?void 0:l.finish_reason)};return(d=(u=(o=t.choices)==null?void 0:o[0])==null?void 0:u.message)!=null&&d.reasoning&&(n.thinking=t.choices[0].message.reasoning),n}parseStreamingLine(t){if(!t.startsWith("data: "))return null;const n=t.slice(6).trim();if(n==="[DONE]")return{done:!0};try{return JSON.parse(n)}catch{return null}}extractStreamingContent(t){var s,i,r,a;if(t.done)return{done:!0};const n=(i=(s=t.choices)==null?void 0:s[0])==null?void 0:i.delta;return{content:(n==null?void 0:n.content)||"",thinking:(n==null?void 0:n.reasoning)||"",done:!1,usage:t.usage||null,finishReason:ca((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}getApiPath(){return"/v1/chat/completions"}requiresAuth(){return!!this.config.apiKey}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(t){return Array.isArray(t.data)?t.data.filter(n=>{var i;const s=(i=n.architecture)==null?void 0:i.modality;return s&&(s.includes("text->text")||s.includes("text+image->text"))}).map(n=>n.id).sort():[]}async discoverModelsWithMetadata(t=15e3){try{const n=this.buildHeaders(),s=new AbortController,i=setTimeout(()=>s.abort(),t),r=await fetch(this.getModelsEndpoint(),{method:"GET",headers:n,signal:s.signal});if(clearTimeout(i),!r.ok)throw new Error(`Failed to fetch models: ${r.status} ${r.statusText}`);return(await r.json()).data||[]}catch(n){throw n.name==="AbortError"?new Error("Model discovery timeout - please check your connection"):n}}}function ca(e){if(!e)return null;const t=String(e).toLowerCase();return t==="length"||t==="max_tokens"?"length":t}class Xu extends Gt{async detectCapabilities(){}prepareRequest(t,n){return{model:n.model||this.config.model||"gpt-3.5-turbo",messages:t,temperature:n.temperature||.7,max_tokens:n.maxTokens||1e3,stream:n.stream||!1}}processResponse(t){var n,s,i,r,a;return{content:((i=(s=(n=t.choices)==null?void 0:n[0])==null?void 0:s.message)==null?void 0:i.content)||"",usage:t.usage||null,finishReason:ua((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}parseStreamingLine(t){if(!t.startsWith("data: "))return null;const n=t.slice(6).trim();if(n==="[DONE]")return{done:!0};try{return JSON.parse(n)}catch{return null}}extractStreamingContent(t){var n,s,i,r,a;return t.done?{done:!0}:{content:((i=(s=(n=t.choices)==null?void 0:n[0])==null?void 0:s.delta)==null?void 0:i.content)||"",thinking:"",done:!1,usage:t.usage||null,finishReason:ua((a=(r=t.choices)==null?void 0:r[0])==null?void 0:a.finish_reason)}}getApiPath(){return"/v1/chat/completions"}requiresAuth(){return!!this.config.apiKey}getModelsEndpoint(){return`${this.config.baseUrl}/v1/models`}parseModelsResponse(t){var n,s;return((s=(n=t.data)==null?void 0:n.map(i=>i.id))==null?void 0:s.sort())||[]}}function ua(e){if(!e)return null;const t=String(e).toLowerCase();return t==="max_tokens"?"length":t}const He={OPENAI:"openai",ANTHROPIC:"anthropic",GROK:"grok",GEMINI:"gemini",OLLAMA:"ollama",LLAMA_SERVER:"llama-server",OPENROUTER:"openrouter",CUSTOM:"custom"},Ll={[He.OPENAI]:{name:"OpenAI",baseUrl:"https://api.openai.com",requiresApiKey:!0},[He.ANTHROPIC]:{name:"Anthropic",baseUrl:"https://api.anthropic.com",requiresApiKey:!0},[He.GROK]:{name:"Grok",baseUrl:"https://api.x.ai",requiresApiKey:!0},[He.GEMINI]:{name:"Google Gemini",baseUrl:"https://generativelanguage.googleapis.com",requiresApiKey:!0},[He.OLLAMA]:{name:"Ollama (Native)",baseUrl:"http://localhost:11434",requiresApiKey:!1},[He.LLAMA_SERVER]:{name:"Local Llama Server",baseUrl:"http://localhost:8080",requiresApiKey:!1},[He.OPENROUTER]:{name:"OpenRouter",baseUrl:"https://openrouter.ai/api",requiresApiKey:!0},[He.CUSTOM]:{name:"Custom OpenAI Compatible",baseUrl:"",requiresApiKey:!1}};function nr(e,t){switch(e){case He.OPENAI:return new Vu(t);case He.ANTHROPIC:return new Gu(t);case He.GROK:return new Wu(t);case He.GEMINI:return new Ju(t);case He.OLLAMA:return new Yu(t);case He.LLAMA_SERVER:return new Qu(t);case He.OPENROUTER:return new Zu(t);case He.CUSTOM:return new Xu(t);default:throw new Error(`Unknown provider type: ${e}`)}}const da=new Map;function Nl(e,t){if(da.has(e)){const n=da.get(e);return new n(t)}return nr(e,t)}class ed{constructor({configStore:t,logger:n}={}){this.configStore=t,this.logger=n||console,this.config=null,this.provider=null,this.usageTracker=null}async initialize(t=null){if(this.config=t||this.configStore.getActiveConfig(),!this.config)throw new Error("LLM not configured");this.provider=Nl(this.config.provider,this.config),await this.provider.initialize(),this.usageTracker=this._createUsageTracker()}async ensureInitialized(){this.provider||await this.initialize()}async refresh(){this.config=null,this.provider=null,await this.initialize()}async testConnection(t){var i;const n=this.config,s=this.provider;try{await this.initialize(t);const r=[{role:"system",content:'Respond with exactly "pong"'},{role:"user",content:"ping"}],a=this.validateCapabilities({model:this.config.model,enableThinking:!1,temperature:.1,maxTokens:10,stream:!1}),l=this.provider.prepareRequest(r,a),o=await this.provider.makeRequest(l);return(i=this.provider.processResponse(o).content)==null?void 0:i.trim()}finally{this.config=n,this.provider=s}}_createUsageTracker(){return{totalTokens:0,totalCost:0,recordUsage:(t,n)=>{var s;(s=n.usage)!=null&&s.tokens&&(this.totalTokens+=n.usage.tokens)},recordPartialUsage:t=>{t!=null&&t.tokens&&(this.totalTokens+=t.tokens)}}}validateCapabilities(t){var s;if(!this.provider)return t;const n=t.enableThinking!==void 0?t.enableThinking:((s=this.config)==null?void 0:s.enableThinking)||!1;return{...t,enableThinking:n&&this.provider.hasCapability("thinking"),images:t.images&&this.provider.hasCapability("vision")?t.images:null,tools:t.tools&&this.provider.hasCapability("tools")?t.tools:null}}async ping(){var a;await this.ensureInitialized();const t=[{role:"system",content:'Respond with exactly "pong"'},{role:"user",content:"ping"}],n=this.validateCapabilities({model:this.config.model,temperature:.1,maxTokens:10,stream:!1}),s=this.provider.prepareRequest(t,n),i=await this.provider.makeRequest(s);return(a=this.provider.processResponse(i).content)==null?void 0:a.trim()}async stream(t,n){await this.ensureInitialized();const s=this.validateCapabilities({...t,stream:!0,model:t.model||this.config.model,requestId:this.generateRequestId()}),i=t.messages;let r="";return await this.provider.streamRequest(i,s,a=>{r=a.fullContent,n&&n(a)}),r}generateRequestId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}getCapabilities(){return this.provider?Array.from(this.provider.capabilities):[]}getUsageStats(){var t,n;return{totalTokens:((t=this.usageTracker)==null?void 0:t.totalTokens)||0,totalCost:((n=this.usageTracker)==null?void 0:n.totalCost)||0}}async discoverModels(){return await this.ensureInitialized(),this.provider.discoverModels()}getConfigByName(t){var i;if(!t||!((i=this.configStore)!=null&&i.getEnabledConfigs))return null;const n=t.trim(),s=this.configStore.getEnabledConfigs().filter(r=>this._matchesDisplayName(r,n));if(s.length===0)return null;if(s.length>1){const r=s.map(a=>a.id).join(", ");throw new Error(`Multiple provider presets share the name '${t}'. Conflicting ids: ${r}`)}return s[0]}_matchesDisplayName(t,n){return!t||!n?!1:t.name===n||this._formatDisplayName(t)===n}_formatDisplayName(t){const n=(t==null?void 0:t.provider)||"provider",s=(t==null?void 0:t.baseUrl)||"n/a";return(t==null?void 0:t.name)||`${n} (${s})`}createLLMWrapper(t,n=null,s=null){const i=this;function r(a,l={}){return new td(i,t,a,l,n,s)}return r}}class td{constructor(t,n,s,i,r,a){this.client=t,this.contextNode=n,this.prompt=s,this.options=i||{},this.originatingCode=r,this.defaultPresetName=a,this.targetNode=null,this.targetAttributes={},this.operationName=null,this._executed=!1,this._promise=null}withOperation(t){return this.operationName=t,this}into(t,n={}){return this.targetNode=t,this.targetAttributes=n,this._ensureExecution(),this}then(t,n){return this._ensureExecution(),this._promise.then(t,n)}catch(t){return this._ensureExecution(),this._promise.catch(t)}finally(t){return this._ensureExecution(),this._promise.finally(t)}_ensureExecution(){this._executed||(this._executed=!0,this._promise=this._run())}async _run(){var l;const t=await this._createExecutionContext(),{provider:n,config:s}=t;if(!n||!s)throw new Error("LLM not configured");const i=this.client.validateCapabilities.bind({provider:n,config:s}),r=[];this.options.system&&r.push({role:"system",content:this.options.system}),r.push({role:"user",content:this.prompt});const a={model:this.options.model||s.model,temperature:this.options.temperature??s.temperature,maxTokens:this.options.maxTokens??s.maxTokens,enableThinking:this.options.enableThinking,requestId:this.client.generateRequestId(),...this.options.images?{images:this.options.images}:{},...this.options.tools?{tools:this.options.tools}:{}};try{if(this.targetNode){const u=i({...a,stream:!0});return await this._streamIntoTarget(r,u,n,s)}const o=i({...a,stream:!1});return await this._promiseResponse(r,o,n,s)}finally{(l=t.cleanup)==null||l.call(t)}}async _createExecutionContext(){var i,r,a,l;const t=this._resolvePresetName();if(!t)return await this.client.ensureInitialized(),{provider:this.client.provider,config:this.client.config,cleanup:()=>{}};if(!this.client.configStore)throw new Error("Provider presets require a configured ConfigStore instance");const n=(r=(i=this.client).getConfigByName)==null?void 0:r.call(i,t);if(!n){const o=(((l=(a=this.client.configStore).getEnabledConfigs)==null?void 0:l.call(a))||[]).map(d=>d.name||`${d.provider} (${d.baseUrl})`).filter(Boolean),u=o.length?` Available presets: ${o.join(", ")}`:" No configured providers found.";throw new Error(`Provider preset '${t}' not found.${u}`)}const s=Nl(n.provider,n);return await s.initialize(),{provider:s,config:n,cleanup:()=>{var o;return(o=s.cancelAllRequests)==null?void 0:o.call(s)}}}_resolvePresetName(){const t=typeof this.options.preset=="string"?this.options.preset:null,n=typeof this.defaultPresetName=="string"?this.defaultPresetName:null,s=t||n;return s?s.trim():null}_applyAttributes(t){var n,s;for(const[i,r]of Object.entries(this.targetAttributes||{}))try{t.setAttribute(i,r)}catch(a){(s=(n=this.client.logger)==null?void 0:n.warn)==null||s.call(n,"Failed to set attribute on target node",{key:i,value:r,error:a})}}async _streamIntoTarget(t,n,s,i){var h,p,f,k,g,S,R,y,x,$,P,C,m,A;let r,a;typeof this.targetNode=="string"?(a=this.targetNode,r=this.contextNode.createChild(a),(h=r.setSelected)==null||h.call(r)):(r=this.targetNode,a=((p=r.getText)==null?void 0:p.call(r))||""),this._applyAttributes(r);const l=i==null?void 0:i.name;l&&r.addTag&&r.addTag("provider",l),(f=r.addLLMLog)==null||f.call(r,this.operationName||"streaming-request",{provider:i==null?void 0:i.provider,model:i==null?void 0:i.model,messages:t,options:n}),(k=r.setStreamingState)==null||k.call(r,!0),r._activeRequestId=n.requestId;let o="",u=null,d=0;try{return await s.streamRequest(t,n,F=>{var D,O,z;F.content&&(o=F.fullContent,(D=r.setText)==null||D.call(r,o)),(O=F.usage)!=null&&O.tokens&&(d+=F.usage.tokens),F.finishReason&&(u=F.finishReason),F.done&&((z=r.setStreamingState)==null||z.call(r,!1),r._activeRequestId=null)}),(g=r.addLLMLog)==null||g.call(r,(this.operationName||"streaming-request")+"-response",{requestId:n.requestId},{content:o,usage:{tokens:d}}),u==="length"?((S=r.setAttribute)==null||S.call(r,"_truncated",!0),(R=r.addLog)==null||R.call(r,"Response truncated. Increase Max Tokens.","warn",{finish_reason:"length"})):(y=r.setAttribute)==null||y.call(r,"_truncated",!1),await((x=r.persistNow)==null?void 0:x.call(r)),r}catch(F){throw($=r.addLLMLog)==null||$.call(r,(this.operationName||"streaming-request")+"-error",{requestId:n.requestId},null,F),(P=r.setStreamingState)==null||P.call(r,!1),r._activeRequestId=null,(C=r.setText)==null||C.call(r,`Error: ${F.message}`),(m=r.setAttribute)==null||m.call(r,"_truncated",!1),await((A=r.persistNow)==null?void 0:A.call(r)),F}}async _promiseResponse(t,n,s,i){var u,d,h,p,f,k,g;const r=s.prepareRequest(t,n),a=await s.makeRequest(r),l=s.processResponse(a);if((l.finishReason||((d=(u=a==null?void 0:a.choices)==null?void 0:u[0])==null?void 0:d.finish_reason)||null)==="length")try{this.contextNode.setAttribute("_truncated",!0)}catch(S){(p=(h=this.client.logger)==null?void 0:h.warn)==null||p.call(h,"Unable to mark node as truncated",{error:S})}else try{this.contextNode.setAttribute("_truncated",!1)}catch(S){(k=(f=this.client.logger)==null?void 0:f.warn)==null||k.call(f,"Unable to clear truncated marker on node",{error:S})}return((g=l.content)==null?void 0:g.trim())||""}}class Dl{constructor(t="llm"){this.ns=t}_k(t){return`${this.ns}:${t}`}get(t){try{return localStorage.getItem(this._k(t))}catch{return null}}set(t,n){try{localStorage.setItem(this._k(t),n)}catch{}}remove(t){try{localStorage.removeItem(this._k(t))}catch{}}list(t=""){const n={};try{const s=this._k(t);for(let i=0;i<localStorage.length;i++){const r=localStorage.key(i);r&&r.startsWith(this.ns+":")&&r.startsWith(s)&&(n[r.slice(this.ns.length+1)]=localStorage.getItem(r))}}catch{}return n}}class nd{constructor({storageAdapter:t=null}={}){this.storage=t||new Dl("llm"),this.CONFIGS_KEY="configs",this.ACTIVE_KEY="active-provider"}_readConfigs(){const t=this.storage.get(this.CONFIGS_KEY);if(!t)return{};try{return JSON.parse(t)}catch{return{}}}_writeConfigs(t){try{this.storage.set(this.CONFIGS_KEY,JSON.stringify(t))}catch{}}listConfigs(){return this._readConfigs()}getConfig(t){return this._readConfigs()[t]||null}saveConfig(t,n){const s=this._readConfigs();return s[t]={...n,configuredAt:new Date().toISOString()},this._writeConfigs(s),!0}deleteConfig(t){const n=this._readConfigs();return delete n[t],this._writeConfigs(n),this.getActiveProviderId()===t&&this.setActiveProviderId(null),!0}getActiveProviderId(){return this.storage.get(this.ACTIVE_KEY)}setActiveProviderId(t){t?this.storage.set(this.ACTIVE_KEY,t):this.storage.remove(this.ACTIVE_KEY)}getActiveConfig(){const t=this.getActiveProviderId();return t?this.getConfig(t):null}getEnabledConfigs(){const t=this._readConfigs();return Object.entries(t).filter(([n,s])=>s&&s.enabled!==!1&&s.provider&&s.baseUrl).map(([n,s])=>({id:n,...s}))}}const sd="stored-keys";class id{constructor(t,n=sd){this.storage=t,this.key=n}_read(){const t=this.storage.get(this.key);if(!t)return{};try{return JSON.parse(t)}catch{return{}}}_write(t){try{this.storage.set(this.key,JSON.stringify(t))}catch{}}getAll(){return this._read()}get(t){var s;return((s=this._read()[t])==null?void 0:s.apiKey)||null}set(t,n,s={}){const i=this._read(),{providerType:r,serviceEndpoint:a,providerName:l}=s;return i[t]={apiKey:n,storedAt:new Date().toISOString(),...r&&{providerType:r},...a&&{serviceEndpoint:a},...l&&{providerName:l}},this._write(i),!0}delete(t){const n=this._read();return delete n[t],this._write(n),!0}has(t){var s;const n=this._read();return t==="custom"?Object.values(n).some(i=>i.providerType==="custom"):!!((s=n[t])!=null&&s.apiKey)}getForType(t){const n=this._read(),s={};for(const[i,r]of Object.entries(n))(r.providerType===t||i===t)&&(s[i]=r);return s}meta(t){const n=this._read()[t];return n?{hasKey:!!n.apiKey,storedAt:n.storedAt,maskedKey:n.apiKey?Bl(n.apiKey):null,providerType:n.providerType,serviceEndpoint:n.serviceEndpoint,providerName:n.providerName}:null}}function Bl(e){return!e||e.length<12?"":`${e.substring(0,8)}${e.substring(e.length-4)}`}const Fl=Symbol("LLM_CLIENT"),Ul=Symbol("LLM_CONFIG"),Hl=Symbol("LLM_KEYSTORE");function Kl(e={}){const t=e.namespace||"llm",n=e.storageAdapter||new Dl(t),s=new nd({storageAdapter:n}),i=new id(n);return{client:new ed({configStore:s,logger:e.logger}),configStore:s,keyStore:i}}const rd={install(e,t={}){const{client:n,configStore:s,keyStore:i}=Kl(t);if(e.provide(Fl,n),e.provide(Ul,s),e.provide(Hl,i),t.autoInit)try{n.ensureInitialized()}catch{}}};function on(){const e=nn(Fl),t=nn(Ul),n=nn(Hl);if(!e||!t)throw new Error("LLM not provided. Did you install the LLMPlugin?");const s=I(!1),i=I(""),r=I("");async function a(F,D={}){s.value=!0,i.value="",r.value="";try{return await e.stream({messages:F,...D},z=>{i.value=z.fullContent||"",r.value=z.fullThinking||""})}finally{s.value=!1}}function l(){return t.getEnabledConfigs()}function o(){const F=t.listConfigs();return Object.entries(F).filter(([D,O])=>O&&O.provider&&O.baseUrl).map(([D,O])=>({id:D,...O}))}function u(){return t.getActiveConfig()}function d(){return t.getActiveProviderId()}function h(F){return t.setActiveProviderId(F),!0}function p(F,D){const O=t.saveConfig(F,D);if(O&&D.apiKey&&D.provider&&n){const z=D.provider==="custom"?F:D.provider,B={providerType:D.provider,...D.provider==="custom"&&D.baseUrl&&{serviceEndpoint:D.baseUrl},...D.provider==="custom"&&D.name&&{providerName:D.name}};n.set(z,D.apiKey,B)}return O}function f(F){return t.deleteConfig(F)}function k(F){const D=t.getConfig(F);return D?(D.enabled=!0,t.saveConfig(F,D)):!1}function g(F){const D=t.getConfig(F);if(!D)return!1;D.enabled=!1;const O=t.saveConfig(F,D);return d()===F&&h(null),O}async function S(F,D){return nr(F,D).discoverModels()}async function R(F){return e.testConnection(F)}async function y(){return e.refresh()}function x(F){return(n==null?void 0:n.get(F))||null}function $(F){return(n==null?void 0:n.has(F))||!1}function P(){return(n==null?void 0:n.getAll())||{}}function C(F,D,O={}){return(n==null?void 0:n.set(F,D,O))||!1}function m(F){return(n==null?void 0:n.delete(F))||!1}function A(F){return(n==null?void 0:n.meta(F))||null}return{client:e,configStore:t,keyStore:n,stream:a,isStreaming:s,streamContent:i,streamThinking:r,getEnabledConfigs:l,getAllConfigs:o,getActiveConfig:u,getActiveProviderId:d,setActiveProviderId:h,saveConfig:p,deleteConfig:f,enableProvider:k,disableProvider:g,getAvailableModels:S,testConnection:R,refresh:y,getStoredKey:x,hasStoredKey:$,getAllStoredKeys:P,storeKey:C,deleteStoredKey:m,getStoredKeyMeta:A}}function fa(e){return{name:"",provider:e,baseUrl:"",apiKey:"",model:"",temperature:.7,maxTokens:4096,enableThinking:!1,enabled:!0,configuredAt:new Date().toISOString()}}const De=(e,t)=>{const n=e.__vccOpts||e;for(const[s,i]of t)n[s]=i;return n},ad={class:"llm-provider-selector"},ld=["value"],od={__name:"ProviderSelector",emits:["changed","open-config"],setup(e,{emit:t}){const n=t,{getEnabledConfigs:s,getActiveProviderId:i,setActiveProviderId:r,refresh:a}=on(),l=I([]),o=I(""),u=()=>{l.value=s(),o.value=i()||""},d=async()=>{if(o.value==="__configure__"){o.value=i()||"",n("open-config");return}if(o.value){r(o.value);try{await a()}catch{}n("changed",o.value)}};return Qe(()=>{u()}),(h,p)=>(b(),_("div",ad,[me(c("select",{"onUpdate:modelValue":p[0]||(p[0]=f=>o.value=f),onChange:d,class:"llm-provider-select"},[p[1]||(p[1]=c("option",{value:"",disabled:""},"Select Provider...",-1)),(b(!0),_(oe,null,_e(l.value,f=>(b(),_("option",{key:f.id,value:f.id},L(f.name),9,ld))),128)),p[2]||(p[2]=c("option",{value:"__configure__",class:"config-option"},"Manage Providers...",-1))],544),[[wn,o.value]])]))}},cd=De(od,[["__scopeId","data-v-21c88c22"]]),ud={class:"llm-stored-keys-manager"},dd={class:"llm-manager-header"},fd={class:"llm-manager-body"},hd={class:"llm-scrollable-content"},pd={key:0,class:"llm-empty-keys"},gd={key:1,class:"llm-keys-list"},md={class:"llm-key-header"},vd={class:"llm-provider-info"},yd={class:"llm-provider-header"},bd={class:"llm-provider-name"},kd={class:"llm-stored-date"},wd={key:0,class:"llm-service-endpoint"},xd={class:"llm-key-input-row"},Cd=["onUpdate:modelValue","type","placeholder","onKeyup","onBlur"],Sd=["onClick","title"],_d=["onClick"],$d={key:0,class:"llm-key-item"},Td={class:"llm-key-header"},Ed={class:"llm-provider-info"},Rd={class:"llm-provider-header"},Ad=["value","disabled"],Pd={class:"llm-key-input-row"},Md=["type"],Id=["title"],Od={class:"llm-manager-footer"},Ld={__name:"StoredKeysManager",emits:["close","keysUpdated"],setup(e,{emit:t}){const n=t,s=Ll,{getAllStoredKeys:i,getStoredKey:r,storeKey:a,deleteStoredKey:l,hasStoredKey:o}=on(),u=I({}),d=I({}),h=I({}),p=I(!1),f=I(""),k=I(""),g=I(!1),S=O=>o(O),R=()=>{const O=i(),z={};for(const[B,M]of Object.entries(O)){let ae=B,Z=M.providerType||B;if(M.providerType==="custom")if(M.providerName)ae=M.providerName;else if(M.serviceEndpoint)try{ae=`Custom (${new URL(M.serviceEndpoint).hostname})`}catch{ae="Custom Provider"}else ae="Custom Provider";else s[Z]&&(ae=s[Z].name);z[B]={maskedKey:Bl(M.apiKey),storedAt:M.storedAt,providerType:M.providerType||B,serviceEndpoint:M.serviceEndpoint,providerName:M.providerName,displayName:ae},d.value[B]||(d.value[B]=""),h.value[B]===void 0&&(h.value[B]=!1)}u.value=z},y=O=>{var B;const z=u.value[O];return(z==null?void 0:z.displayName)||((B=s[O])==null?void 0:B.name)||O},x=O=>new Date(O).toLocaleDateString(),$=O=>{h.value[O]=!h.value[O],h.value[O]&&!d.value[O]&&(d.value[O]=r(O)||"")},P=O=>{const z=d.value[O];if(!z||!z.trim()){d.value[O]="";return}const B=r(O);if(z!==B){const M=u.value[O],ae={providerType:M.providerType,...M.serviceEndpoint&&{serviceEndpoint:M.serviceEndpoint},...M.providerName&&{providerName:M.providerName}};a(O,z,ae)&&(R(),n("keysUpdated"))}},C=O=>{d.value[O]="",h.value[O]=!1},m=O=>{const z=y(O);confirm(`Delete stored API key for ${z}?

This action cannot be undone.`)&&l(O)&&(R(),n("keysUpdated"))},A=()=>{if(!f.value||!k.value.trim())return;const O=f.value==="custom"?`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`:f.value,z={providerType:f.value};a(O,k.value,z)&&(R(),n("keysUpdated"),f.value="",k.value="",g.value=!1,p.value=!1)},F=()=>{f.value="",k.value="",g.value=!1,p.value=!1},D=()=>{p.value=!0,$n(()=>{const O=document.querySelector(".llm-key-item:last-child");O&&O.scrollIntoView({behavior:"smooth",block:"nearest"})})};return Ne([f,k],([O,z])=>{O&&z&&z.trim()&&setTimeout(()=>{f.value===O&&k.value===z&&A()},500)}),Qe(()=>{R()}),(O,z)=>(b(),_("div",ud,[c("div",dd,[z[5]||(z[5]=c("h3",null,"Stored API Keys",-1)),c("button",{class:"llm-btn llm-btn--ghost llm-btn--sm llm-close-btn",onClick:z[0]||(z[0]=B=>O.$emit("close"))},"")]),c("div",fd,[c("div",hd,[Object.keys(u.value).length===0&&!p.value?(b(),_("div",pd,[...z[6]||(z[6]=[c("p",null,"No API keys stored yet.",-1),c("small",null,"Keys are automatically stored when you save a provider configuration.",-1)])])):K("",!0),Object.keys(u.value).length>0||p.value?(b(),_("div",gd,[(b(!0),_(oe,null,_e(u.value,(B,M)=>(b(),_("div",{key:M,class:"llm-key-item"},[c("div",md,[c("div",vd,[c("div",yd,[c("div",bd,L(y(M)),1),c("span",kd,L(x(B.storedAt)),1)]),B.serviceEndpoint?(b(),_("div",wd,[c("small",null,L(B.serviceEndpoint),1)])):K("",!0),c("div",xd,[me(c("input",{"onUpdate:modelValue":ae=>d.value[M]=ae,type:h.value[M]?"text":"password",class:"llm-form-control llm-key-input-inline",placeholder:B.maskedKey,onKeyup:[ls(ae=>P(M),["enter"]),ls(ae=>C(M),["escape"])],onBlur:ae=>P(M)},null,40,Cd),[[sa,d.value[M]]]),c("button",{type:"button",class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:ae=>$(M),title:h.value[M]?"Hide key":"Show key"},L(h.value[M]?"Hide":"Show"),9,Sd),c("button",{class:"llm-btn llm-btn--sm llm-btn--danger",onClick:ae=>m(M),title:"Delete key"}," Delete ",8,_d)])])])]))),128)),p.value?(b(),_("div",$d,[c("div",Td,[c("div",Ed,[c("div",Rd,[me(c("select",{"onUpdate:modelValue":z[1]||(z[1]=B=>f.value=B),class:"llm-form-control llm-provider-select"},[z[7]||(z[7]=c("option",{value:""},"Select provider type...",-1)),(b(!0),_(oe,null,_e(G(s),(B,M)=>(b(),_("option",{key:M,value:M,disabled:M!=="custom"&&S(M)},L(B.name)+" "+L(M!=="custom"&&S(M)?"(already stored)":""),9,Ad))),128))],512),[[wn,f.value]])]),c("div",Pd,[me(c("input",{"onUpdate:modelValue":z[2]||(z[2]=B=>k.value=B),type:g.value?"text":"password",class:"llm-form-control llm-key-input-inline",placeholder:"Enter API key",onKeyup:[ls(A,["enter"]),ls(F,["escape"])]},null,40,Md),[[sa,k.value]]),c("button",{type:"button",class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:z[3]||(z[3]=B=>g.value=!g.value),title:g.value?"Hide key":"Show key"},L(g.value?"Hide":"Show"),9,Id),c("button",{class:"llm-btn llm-btn--sm llm-btn--danger",onClick:F,title:"Cancel"}," Cancel ")])])])])):K("",!0)])):K("",!0)])]),c("div",Od,[c("button",{class:"llm-btn llm-btn--secondary",onClick:D}," Add New Key "),z[8]||(z[8]=c("div",{class:"llm-footer-spacer"},null,-1)),c("button",{class:"llm-btn llm-btn--ghost",onClick:z[4]||(z[4]=B=>O.$emit("close"))}," Close ")])]))}},Nd=De(Ld,[["__scopeId","data-v-9c5fd459"]]),Dd={class:"llm-modal-header"},Bd={key:0},Fd={class:"llm-modal-body"},Ud={key:0},Hd={class:"llm-form-grid"},Kd=["value"],qd=["placeholder"],jd=["placeholder"],zd={class:"llm-api-key-field"},Vd={class:"llm-api-key-input-row"},Gd=["placeholder","required"],Wd={class:"llm-security-note"},Jd={key:0},Yd={class:"llm-model-selector"},Qd=["disabled"],Zd={value:""},Xd=["value"],ef=["disabled"],tf={key:0,class:"llm-model-error"},nf={key:1,class:"llm-thinking-toggle"},sf={class:"llm-checkbox-label"},rf={class:"llm-temperature-field"},af=["disabled"],lf={key:0,class:"llm-field-note"},of={key:1,class:"llm-field-note"},cf={key:1},uf={key:0,class:"llm-provider-list"},df=["onClick"],ff={class:"llm-provider-info"},hf={class:"llm-provider-name-row"},pf={class:"llm-provider-name"},gf={key:0,class:"llm-disabled-badge"},mf={key:0,class:"llm-active-badge"},vf={key:1,class:"llm-judge-badge"},yf={class:"llm-provider-details-row"},bf=["onClick","disabled"],kf={class:"llm-provider-details"},wf=["onClick","title"],xf=["onClick","title"],Cf=["onClick"],Sf=["onClick"],_f={key:1,class:"llm-empty-state"},$f={class:"llm-modal-footer"},Tf=["disabled"],oi="judge-provider",Ef={__name:"LLMConfigModal",props:{isVisible:Boolean,editTarget:Object,showJudge:{type:Boolean,default:!1},showAllMode:{type:Boolean,default:!1}},emits:["close","configChanged"],setup(e,{emit:t}){const n=e,s=t,i=Ll,{getAllConfigs:r,getActiveProviderId:a,setActiveProviderId:l,saveConfig:o,deleteConfig:u,enableProvider:d,disableProvider:h,getAvailableModels:p,testConnection:f,refresh:k,getStoredKey:g,hasStoredKey:S,getAllStoredKeys:R}=on(),y=I(fa("")),x=I([]),$=I(null),P=I(null),C=I(!1),m=I(null),A=I(!1),F=I(null),D=I([]),O=I(!1),z=I(null),B=I(new Map),M=I(!1),ae=I(0),Z=I(null),ne=ie(()=>y.value.provider?i[y.value.provider]:null),ee=I(new Set),pe=ie(()=>y.value.model&&ee.value.has("thinking")),Ee=ie(()=>{var N,he;if(!((N=y.value)!=null&&N.provider)||!((he=y.value)!=null&&he.model)||y.value.provider!=="openai")return!1;const E=String(y.value.model).toLowerCase();return ee.value.has("thinking")||E.startsWith("o1")||E.startsWith("o2")||E.startsWith("o3")||E.startsWith("o-")||E.includes("gpt-5")||E==="gpt5"||E.includes("reasoning")}),Oe=ie(()=>ae.value>0),Be=ie(()=>{var E;return!(!y.value.name||!y.value.provider||!y.value.baseUrl||(E=ne.value)!=null&&E.requiresApiKey&&!y.value.apiKey)}),Dt=E=>{const N=B.value.get(E);return N==="testing"?"Testing...":N==="success"?"Ok":N==="failed"?"Failed":"Test"},Ct=E=>{const N=B.value.get(E);return{"llm-test-testing":N==="testing","llm-test-success":N==="success","llm-test-failed":N==="failed","llm-test-default":!N||N==="default"}},st=()=>{if(x.value=r(),$.value=a()||"",n.showJudge)try{P.value=localStorage.getItem("llm:"+oi)||null}catch{P.value=null}},Xe=()=>{const E=R();ae.value=Object.keys(E).length},pt=async()=>{const E=ne.value;if(E){y.value.baseUrl=E.baseUrl,y.value.model="",y.value.enableThinking=!1,ee.value.clear(),m.value||(y.value.name="");const N=g(y.value.provider);N&&!y.value.apiKey&&(y.value.apiKey=N),await it()}F.value=null,z.value=null},it=async()=>{if(!y.value.provider||!y.value.baseUrl){D.value=[],z.value=null;return}O.value=!0,z.value=null;try{const E=await p(y.value.provider,y.value);D.value=E,E.length>0&&!y.value.model&&(y.value.model=E[0],await gt())}catch(E){console.warn("Failed to load models:",E),D.value=[],z.value=E.message||"Failed to load models"}finally{O.value=!1}},gt=async()=>{if(!y.value.provider||!y.value.model){ee.value.clear();return}try{const E={...y.value},N=nr(E.provider,E);await N.initialize(),ee.value=new Set(N.capabilities),ee.value.has("thinking")||(y.value.enableThinking=!1)}catch(E){console.warn("Failed to detect model capabilities:",E),ee.value.clear()}},X=()=>`provider_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,le=()=>{if(!y.value.provider)return"";const E=i[y.value.provider];return`e.g., My ${(E==null?void 0:E.name)||"Provider"}`},v=()=>{if(!y.value.provider||!y.value.model)return"";const E=i[y.value.provider],N=(E==null?void 0:E.name)||"Provider";let he=y.value.model;return he.includes("/")&&(he=he.split("/").pop()),he=he.replace(/-(instruct|chat|base|completion)$/i,"").replace(/^(gpt-|claude-|llama-|gemini-)/i,"").replace(/-vision$/,"").replace(/-\d+b?$/i,""),he=he.split("-").map(Ue=>Ue.charAt(0).toUpperCase()+Ue.slice(1)).join(" ").substring(0,20),`${N} ${he}`.trim()},w=async()=>{if(Be.value){A.value=!0,F.value=null;try{await f(y.value);const E=C.value&&m.value?m.value:X();o(E,y.value)?(a()||(l(E),$.value=E),await k(),F.value={success:!0,message:C.value?"Provider updated!":"Provider added!"},st(),q(),te(),setTimeout(()=>s("close"),1500)):F.value={success:!1,message:"Failed to save configuration."}}catch(E){console.error("LLM connection test failed:",E),F.value={success:!1,message:`Connection failed: ${E.message}`}}finally{A.value=!1}}},T=E=>{l(E),$.value=E,k(),te()},U=async E=>{B.value.set(E.id,"testing");try{await f(E),B.value.set(E.id,"success"),setTimeout(()=>B.value.set(E.id,"default"),3e3)}catch(N){console.error("LLM connection test failed:",N),B.value.set(E.id,"failed"),setTimeout(()=>B.value.set(E.id,"default"),5e3)}},j=E=>{var N;y.value={...E},C.value=!0,m.value=E.id,F.value=null,it().then(()=>{y.value.model&&gt()}),(N=n.editTarget)!=null&&N.focusField&&$n(()=>{var he,Ue;n.editTarget.focusField==="maxTokens"&&(Z!=null&&Z.value)&&(Z.value.focus(),(Ue=(he=Z.value).select)==null||Ue.call(he))})},V=()=>{q(),C.value=!0,m.value=null},Q=()=>q(),J=E=>{confirm("Are you sure you want to delete this provider?")&&u(E)&&(st(),E===m.value&&q(),k(),te())},W=E=>{(E.enabled!==!1?h(E.id):d(E.id))&&(st(),k(),te())},q=()=>{y.value=fa(""),C.value=!1,m.value=null,F.value=null,D.value=[],z.value=null,ee.value.clear()},re=()=>{q(),s("close")},Y=E=>{n.isVisible&&E.key==="Escape"&&(E.preventDefault(),re())},te=()=>{s("configChanged");try{window.dispatchEvent(new CustomEvent("llm-config-changed"))}catch{}};Ne(()=>n.isVisible,E=>{var N;if(E&&(st(),Xe(),q(),(N=n.editTarget)!=null&&N.name&&x.value.length>0)){const he=x.value.find(Ue=>Ue.name===n.editTarget.name);he&&j(he)}}),Ne(()=>y.value.model,E=>{if(E){if(gt(),!m.value){const N=v();N&&(y.value.name=N)}Ee.value&&(y.value.temperature=1)}else ee.value.clear(),y.value.enableThinking=!1}),Ne(()=>y.value.temperature,E=>{Ee.value&&E!==1&&(y.value.temperature=1)});const ce=()=>{M.value=!0},fe=()=>{M.value=!1},be=()=>{Xe()},ge=()=>y.value.provider==="custom"?"Enter your API key (optional)":S(y.value.provider)?"Using stored key (or enter new)":"Enter your API key",Le=()=>{const E=g(y.value.provider);E&&(y.value.apiKey=E)},H=E=>{if(!n.showJudge)return;const N=E.id===P.value?null:E.id;try{N?localStorage.setItem("llm:"+oi,N):localStorage.removeItem("llm:"+oi),P.value=N,te()}catch{}};return Qe(()=>{document.addEventListener("keydown",Y),Xe()}),xt(()=>{document.removeEventListener("keydown",Y)}),(E,N)=>{var he,Ue,Fe;return e.isVisible?(b(),_("div",{key:0,class:"llm-modal-overlay",onClick:re},[c("div",{class:"llm-modal",onClick:N[11]||(N[11]=Me(()=>{},["stop"]))},[c("div",Dd,[c("h2",null,[N[12]||(N[12]=nt(" Manage LLM Providers ",-1)),C.value?(b(),_("span",Bd,L(m.value?" - Edit":" - Add"),1)):K("",!0)]),c("button",{class:"llm-btn llm-btn--ghost llm-btn--sm llm-close-btn",onClick:re},"")]),c("div",Fd,[C.value?(b(),_("div",Ud,[c("div",Hd,[N[22]||(N[22]=c("label",{class:"llm-field-label"},"Provider Type:",-1)),me(c("select",{"onUpdate:modelValue":N[0]||(N[0]=se=>y.value.provider=se),onChange:pt,class:"llm-form-control"},[N[13]||(N[13]=c("option",{value:""},"Select a provider...",-1)),(b(!0),_(oe,null,_e(G(i),(se,lt)=>(b(),_("option",{key:lt,value:lt},L(se.name),9,Kd))),128))],544),[[wn,y.value.provider]]),y.value.provider?(b(),_(oe,{key:0},[N[14]||(N[14]=c("label",{class:"llm-field-label"},"Provider Name:",-1)),me(c("input",{"onUpdate:modelValue":N[1]||(N[1]=se=>y.value.name=se),type:"text",placeholder:le(),class:"llm-form-control",required:""},null,8,qd),[[Re,y.value.name]])],64)):K("",!0),y.value.provider?(b(),_(oe,{key:1},[N[18]||(N[18]=c("label",{class:"llm-field-label"},"Base URL:",-1)),me(c("input",{"onUpdate:modelValue":N[2]||(N[2]=se=>y.value.baseUrl=se),type:"url",placeholder:(he=ne.value)==null?void 0:he.baseUrl,class:"llm-form-control",required:""},null,8,jd),[[Re,y.value.baseUrl]]),(Ue=ne.value)!=null&&Ue.requiresApiKey||y.value.provider==="custom"?(b(),_(oe,{key:0},[N[16]||(N[16]=c("label",{class:"llm-field-label"},"API Key:",-1)),c("div",zd,[c("div",Vd,[me(c("input",{"onUpdate:modelValue":N[3]||(N[3]=se=>y.value.apiKey=se),type:"password",placeholder:ge(),class:"llm-form-control",required:(Fe=ne.value)==null?void 0:Fe.requiresApiKey},null,8,Gd),[[Re,y.value.apiKey]]),G(S)(y.value.provider)?(b(),_("button",{key:0,type:"button",class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:Le,title:"Use stored key"}," Use Stored ")):K("",!0)]),c("small",Wd,[N[15]||(N[15]=nt("  API key is stored locally in your browser ",-1)),y.value.provider==="custom"?(b(),_("span",Jd," (optional for custom providers)")):K("",!0)])])],64)):K("",!0),N[19]||(N[19]=c("label",{class:"llm-field-label"},"Model:",-1)),c("div",Yd,[me(c("select",{"onUpdate:modelValue":N[4]||(N[4]=se=>y.value.model=se),disabled:O.value,class:"llm-form-control"},[c("option",Zd,L(O.value?"Loading models...":"Select a model..."),1),(b(!0),_(oe,null,_e(D.value,se=>(b(),_("option",{key:se,value:se},L(se),9,Xd))),128))],8,Qd),[[wn,y.value.model]]),c("button",{class:"llm-btn llm-btn--ghost llm-btn--sm llm-refresh-btn",onClick:it,disabled:!y.value.baseUrl||O.value,title:"Refresh models list"},L(O.value?"Loading...":"Refresh"),9,ef),z.value?(b(),_("div",tf,L(z.value),1)):K("",!0),pe.value?(b(),_("div",nf,[c("label",sf,[me(c("input",{type:"checkbox","onUpdate:modelValue":N[5]||(N[5]=se=>y.value.enableThinking=se),class:"llm-checkbox"},null,512),[[Ts,y.value.enableThinking]]),N[17]||(N[17]=nt(" Enable Thinking: Show model's reasoning process ",-1))])])):K("",!0)]),N[20]||(N[20]=c("label",{class:"llm-field-label"},"Temperature:",-1)),c("div",rf,[me(c("input",{"onUpdate:modelValue":N[6]||(N[6]=se=>y.value.temperature=se),type:"number",min:"0",max:"2",step:"0.1",class:"llm-form-control",disabled:Ee.value},null,8,af),[[Re,y.value.temperature,void 0,{number:!0}]]),Ee.value?(b(),_("small",of," This model uses a fixed temperature of 1. ")):(b(),_("small",lf," Controls randomness: 0 = deterministic, 2 = very creative "))]),N[21]||(N[21]=c("label",{class:"llm-field-label"},"Max Tokens:",-1)),me(c("input",{"onUpdate:modelValue":N[7]||(N[7]=se=>y.value.maxTokens=se),type:"number",min:"1",max:"100000",class:"llm-form-control",ref_key:"maxTokensInput",ref:Z},null,512),[[Re,y.value.maxTokens,void 0,{number:!0}]])],64)):K("",!0)])])):(b(),_("div",cf,[x.value.length>0?(b(),_("div",uf,[N[23]||(N[23]=c("h3",null,"Configured Providers",-1)),(b(!0),_(oe,null,_e(x.value,se=>(b(),_("div",{key:se.id,class:Se(["llm-provider-item",{active:se.id===$.value,disabled:se.enabled===!1}]),onClick:lt=>se.enabled!==!1?T(se.id):null},[c("div",ff,[c("div",hf,[c("div",pf,[nt(L(se.name)+" ",1),se.enabled===!1?(b(),_("span",gf,"Disabled")):K("",!0)]),se.id===$.value?(b(),_("span",mf,"Active")):K("",!0),e.showJudge&&se.id===P.value?(b(),_("span",vf,"Judge")):K("",!0)]),c("div",yf,[c("button",{class:Se(["llm-test-status-btn",Ct(se.id)]),onClick:Me(lt=>U(se),["stop"]),disabled:A.value},L(Dt(se.id)),11,bf),c("div",kf,L(se.provider)+"  "+L(se.baseUrl),1)])]),c("div",{class:"llm-provider-actions",onClick:N[8]||(N[8]=Me(()=>{},["stop"]))},[e.showJudge&&se.enabled!==!1?(b(),_("button",{key:0,class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:lt=>H(se),title:se.id===P.value?"Unset as judge":"Set as judge"},L(se.id===P.value?"Unmark Judge":"Mark Judge"),9,wf)):K("",!0),c("button",{class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:lt=>W(se),title:se.enabled===!1?"Enable provider":"Disable provider"},L(se.enabled===!1?"Enable":"Disable"),9,xf),c("button",{class:"llm-btn llm-btn--ghost llm-btn--sm",onClick:lt=>j(se)}," Edit ",8,Cf),c("button",{class:"llm-btn llm-btn--sm llm-btn--danger",onClick:lt=>J(se.id)}," Delete ",8,Sf)])],10,df))),128))])):(b(),_("div",_f,[...N[24]||(N[24]=[c("p",null,"Connect your first AI provider to start chatting.",-1),c("p",null,`Click "Add New Provider" below. You'll need a base URL and, for some providers, an API key.`,-1),c("p",{class:"llm-security-note"},"API keys are stored locally in your browser.",-1)])]))])),M.value?(b(),_("div",{key:2,class:"llm-keys-manager-overlay",onClick:fe},[c("div",{class:"llm-keys-manager-content",onClick:N[9]||(N[9]=Me(()=>{},["stop"]))},[Ae(Nd,{onClose:fe,onKeysUpdated:be})])])):K("",!0)]),c("div",$f,[C.value?K("",!0):(b(),_("button",{key:0,class:"llm-btn llm-btn--secondary",onClick:V}," Add New Provider ")),!C.value&&Oe.value?(b(),_("button",{key:1,class:"llm-btn llm-btn--ghost",onClick:ce}," Manage Keys ")):K("",!0),N[25]||(N[25]=c("div",{class:"llm-footer-spacer"},null,-1)),c("button",{class:"llm-btn llm-btn--ghost",onClick:N[10]||(N[10]=se=>C.value?Q():re())}," Close "),C.value?(b(),_("button",{key:2,class:"llm-btn llm-btn--primary",onClick:w,disabled:!Be.value||A.value},L(A.value?"Testing...":"Save"),9,Tf)):K("",!0)])])])):K("",!0)}}},ql=De(Ef,[["__scopeId","data-v-aa76c54b"]]);Kl({});let et=null,Xt=null,Kn=null;function Rf(e){if(!e||e.startsWith("#"))return null;const t=e.match(/^(\S+)\s+(\S+)\s+\[([^\]]+)\]\s+\/(.+)\/\s*$/);if(!t)return null;const[,n,s,i,r]=t;return{traditional:n,simplified:s,pinyin:i,definitions:r.split("/").filter(Boolean),raw:e}}function Af(e){if(!e||e.startsWith("#"))return null;const t=e.split("	");return t.length<2?null:{character:t[0],decomposition:t[1]}}async function js(){if(et)return et;const t=await(await fetch("./cedict-tones.txt")).text();et=new Map,Kn=new Map;for(const n of t.split(`
`)){const s=Rf(n);if(s){et.has(s.simplified)||et.set(s.simplified,[]),et.get(s.simplified).push(s),s.traditional!==s.simplified&&(et.has(s.traditional)||et.set(s.traditional,[]),et.get(s.traditional).push(s));for(const i of s.simplified)Kn.set(i,(Kn.get(i)||0)+1)}}return et}function jl(e){if(!Kn)return 0;let t=0;for(const n of e)t+=Kn.get(n)||0;return t/e.length}async function zl(){if(Xt)return Xt;const t=await(await fetch("./ids-compact.txt")).text();Xt=new Map;for(const n of t.split(`
`)){const s=Af(n);s&&Xt.set(s.character,s)}return Xt}function Cn(e){const t=e.definitions;return!!(t.some(i=>/surname\b/i.test(i))||t.every(i=>/^(old |archaic )?variant of /i.test(i)))}function Pf(e){return!e||e.length<=1?e:e.sort((t,n)=>{const s=Cn(t),i=Cn(n);return s&&!i?1:!s&&i?-1:0})}async function Mf(){await Promise.all([js(),zl()])}async function ht(e){await js(),await zl();const t=et.get(e)||[],n=Pf(t),s=Xt.get(e),i=[];if(e.length>1)for(const r of e){const a=Xt.get(r);a&&i.push(a)}return{cedict:n,ids:s,componentIds:i.length?i:null}}function Es(e){return e.toLowerCase().replace(/[]/g,"a").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"v").replace(/[1-5]/g,"").replace(/\s+/g,"")}function If(e,t,n){return n?0:e.startsWith(t)?1:2}async function Of(e,t=20){await js();const n=[],s=new Set,i=Es(e);for(const r of et.values())for(const a of r){const l=Es(a.pinyin);if(l.includes(i)){const o=a.simplified+a.pinyin;if(!s.has(o)){s.add(o);const d=If(l,i,l===i),h=jl(a.simplified);n.push({entry:a,score:d,freq:h})}}}return n.sort((r,a)=>{const l=Cn(r.entry),o=Cn(a.entry);return l!==o?l?1:-1:r.score!==a.score?r.score-a.score:r.entry.simplified.length!==a.entry.simplified.length?r.entry.simplified.length-a.entry.simplified.length:a.freq-r.freq}),n.slice(0,t).map(r=>r.entry)}async function Lf(e,t=20){await js();const n=[],s=new Set,i=e.toLowerCase();for(const r of et.values())for(const a of r)if(a.definitions.join(" ").toLowerCase().includes(i)){const o=a.simplified+a.pinyin;if(!s.has(o)){s.add(o);const u=a.definitions.some(f=>f.toLowerCase()===i),d=a.definitions.some(f=>f.toLowerCase().startsWith(i)),h=u?0:d?1:2,p=jl(a.simplified);n.push({entry:a,score:h,freq:p})}}return n.sort((r,a)=>{const l=Cn(r.entry),o=Cn(a.entry);return l!==o?l?1:-1:r.score!==a.score?r.score-a.score:r.entry.simplified.length!==a.entry.simplified.length?r.entry.simplified.length-a.entry.simplified.length:a.freq-r.freq}),n.slice(0,t).map(r=>r.entry)}function Nf(e){return/^[a-zA-Z\s1-5]+$/.test(e)}async function ha(e,t=20){if(!e||!e.trim())return[];if(e=e.trim(),/[\u4e00-\u9fff]/.test(e))return(await ht(e)).cedict;const s=new Set,i=[];if(Nf(e)){const r=await Of(e,t);for(const a of r){const l=a.simplified+a.pinyin;s.has(l)||(s.add(l),i.push(a))}}if(i.length<t){const r=await Lf(e,t-i.length);for(const a of r){const l=a.simplified+a.pinyin;s.has(l)||(s.add(l),i.push(a))}}return i.slice(0,t)}function Df(e){return e.replace(/CL:([^\s/]+)/g,(t,n)=>`(measure word: ${n.split(",").map(i=>{const r=i.match(/(?:([^\|]+)\|)?([^\[]+)\[([^\]]+)\]/);if(r){const a=r[2],l=r[3];return`${a} ${l}`}return i}).join(", ")})`)}const Bf={"(Tw)":"(Taiwan)","(PRC)":"(Mainland China)","(coll.)":"(colloquial)","(fig.)":"(figurative)","(lit.)":"(literal)","(onom.)":"(onomatopoeia)","(TCM)":"(Traditional Chinese Medicine)","(med.)":"(medical)","(math.)":"(mathematics)","(abbr.)":"(abbreviation)"};function Ff(e){let t=Df(e);for(const[n,s]of Object.entries(Bf))t=t.replace(n,s);return t}function Sn(e,t=null){return(t?e.slice(0,t):e).map(Ff).join("; ")}function Rs(e){const t=[];if(e.cedict&&e.cedict.length>0){const n=e.cedict[0];if(t.push(`${n.simplified} [${n.pinyin}] /${n.definitions.join("/")}/`),e.cedict.length>1)for(let s=1;s<e.cedict.length;s++){const i=e.cedict[s];t.push(`  Also: [${i.pinyin}] /${i.definitions.join("/")}/`)}}if(e.ids&&t.push(`
Component breakdown: ${e.ids.decomposition}`),e.componentIds){t.push(`
Character components:`);for(const n of e.componentIds)t.push(`  ${n.character}: ${n.decomposition}`)}return t.join(`
`)}const Uf={class:"search-input-wrapper"},Hf=["placeholder","aria-expanded"],Kf={key:0,id:"search-results",class:"search-results",role:"listbox"},qf={key:0,class:"dict-results"},jf=["onClick","aria-selected"],zf={class:"dict-entry-head"},Vf={class:"dict-entry-char"},Gf={key:0,class:"dict-entry-trad"},Wf={class:"dict-entry-pinyin"},Jf={class:"dict-entry-def"},Yf={key:1,class:"search-empty-state"},Qf={__name:"SearchBar",props:{placeholder:{type:String,default:"Search Chinese or English..."}},emits:["select","freeform"],setup(e,{expose:t,emit:n}){const s=n,i=I(null),r=I(""),a=I([]),l=I(!1),o=I(!1),u=I(-1);let d=null;function h(){(r.value.trim()||a.value.length>0)&&(o.value=!0)}function p(){var C;o.value=!1,u.value=-1,(C=i.value)==null||C.blur()}function f(){var C;r.value="",a.value=[],l.value=!1,u.value=-1,o.value=!1,(C=i.value)==null||C.focus()}function k(){u.value=-1,clearTimeout(d),d=setTimeout(async()=>{r.value.trim().length>=1?(a.value=await ha(r.value,100),l.value=!0,o.value=!0):(a.value=[],l.value=!1,o.value=!1)},300)}function g(C){if(C.key==="Escape"){C.stopPropagation(),r.value?f():p();return}if(C.key==="Enter"){C.preventDefault(),u.value>=0&&u.value<a.value.length?R(a.value[u.value]):S();return}if(C.key==="ArrowDown"){C.preventDefault(),C.stopPropagation(),a.value.length>0&&(o.value=!0,u.value=Math.min(u.value+1,a.value.length-1),x());return}if(C.key==="ArrowUp"){C.preventDefault(),C.stopPropagation(),a.value.length>0&&(u.value=Math.max(u.value-1,-1),x());return}}async function S(){r.value.trim()&&(a.value.length>0?R(a.value[0]):(s("freeform",r.value),y()))}function R(C){s("select",C),y()}function y(){a.value=[],r.value="",l.value=!1,u.value=-1,o.value=!1}function x(){if(u.value<0)return;const C=document.getElementById("search-results"),m=C==null?void 0:C.querySelector(".dict-entry-focused");m&&C&&m.scrollIntoView({block:"nearest"})}function $(C){var m;(C.metaKey||C.ctrlKey)&&C.key==="k"&&(C.preventDefault(),(m=i.value)==null||m.focus())}async function P(C){var m;r.value=C,C.trim().length>=1&&(a.value=await ha(C,100),l.value=!0,o.value=!0),(m=i.value)==null||m.focus(),window.scrollTo({top:0,behavior:"smooth"})}return Qe(()=>{document.addEventListener("keydown",$)}),xt(()=>{document.removeEventListener("keydown",$),clearTimeout(d)}),t({prepopulateSearch:P}),(C,m)=>(b(),_("div",{class:Se(["search-container",{"search-active":o.value}])},[o.value?(b(),_("div",{key:0,class:"search-backdrop",onClick:p,"aria-hidden":"true"})):K("",!0),c("div",{class:Se(["search-box",{"search-box-active":o.value}])},[c("div",Uf,[m[2]||(m[2]=c("svg",{class:"search-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[c("circle",{cx:"11",cy:"11",r:"8"}),c("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),me(c("input",{ref_key:"inputRef",ref:i,type:"text","onUpdate:modelValue":m[0]||(m[0]=A=>r.value=A),placeholder:e.placeholder,onInput:k,onKeydown:g,onFocus:h,"aria-label":"Search for Chinese words or English meanings","aria-autocomplete":"list","aria-expanded":o.value&&(a.value.length>0||l.value&&r.value),"aria-controls":"search-results"},null,40,Hf),[[Re,r.value]]),r.value&&!o.value?(b(),_("button",{key:0,class:"search-icon-btn",onClick:f,type:"button","aria-label":"Clear search"},[...m[1]||(m[1]=[c("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[c("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),c("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])):K("",!0)]),o.value?(b(),_("div",Kf,[a.value.length>0?(b(),_("div",qf,[(b(!0),_(oe,null,_e(a.value,(A,F)=>(b(),_("div",{key:A.simplified+A.pinyin,class:Se(["dict-entry",{"dict-entry-focused":u.value===F}]),onClick:D=>R(A),role:"option","aria-selected":u.value===F},[c("div",zf,[c("span",Vf,L(A.simplified),1),A.traditional!==A.simplified?(b(),_("span",Gf," ("+L(A.traditional)+") ",1)):K("",!0),c("span",Wf,L(A.pinyin),1)]),c("div",Jf,L(G(Sn)(A.definitions,3)),1)],10,jf))),128))])):l.value&&r.value?(b(),_("div",Yf,[c("p",null,'No dictionary results for "'+L(r.value)+'"',1),m[3]||(m[3]=c("p",{class:"search-hint"},"Press Enter to ask AI about this term",-1))])):K("",!0)])):K("",!0)],2)],2))}},Zf=De(Qf,[["__scopeId","data-v-5a35f3e9"]]),Xf="flashcards-images",eh=1,zt="images";let os=null;function sr(){return os||(os=new Promise((e,t)=>{const n=indexedDB.open(Xf,eh);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=s=>{const i=s.target.result;i.objectStoreNames.contains(zt)||i.createObjectStore(zt,{keyPath:"cardId"})}}),os)}async function th(e,t){var i,r,a,l;if(!t)throw new Error("OpenAI API key not provided");const n=await fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-image-1",prompt:e,size:"1024x1024",quality:"medium",n:1})});if(!n.ok){const o=await n.text();throw new Error(`Image generation failed: ${o}`)}const s=await n.json();if((r=(i=s.data)==null?void 0:i[0])!=null&&r.b64_json)return s.data[0].b64_json;if((l=(a=s.data)==null?void 0:a[0])!=null&&l.url)return await nh(s.data[0].url);throw new Error("Unexpected response format from image API")}async function nh(e){const n=await(await fetch(e)).blob();return new Promise((s,i)=>{const r=new FileReader;r.onloadend=()=>{const a=r.result.split(",")[1];s(a)},r.onerror=i,r.readAsDataURL(n)})}async function sh(e,t){const n=await sr();return new Promise((s,i)=>{const l=n.transaction(zt,"readwrite").objectStore(zt).put({cardId:e,data:t,savedAt:new Date().toISOString()});l.onsuccess=()=>s(),l.onerror=()=>i(l.error)})}async function ih(e){if(!e)return null;const t=await sr();return new Promise((n,s)=>{const a=t.transaction(zt,"readonly").objectStore(zt).get(e);a.onsuccess=()=>{var l;n(((l=a.result)==null?void 0:l.data)||null)},a.onerror=()=>s(a.error)})}async function rh(e){if(!e)return;const t=await sr();return new Promise((n,s)=>{const a=t.transaction(zt,"readwrite").objectStore(zt).delete(e);a.onsuccess=()=>n(),a.onerror=()=>s(a.error)})}function pa(e){return e?e.startsWith("data:")?e:`data:image/png;base64,${e}`:null}function ir(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var cn=ir();function Vl(e){cn=e}var qn={exec:()=>null};function ve(e,t=""){let n=typeof e=="string"?e:e.source,s={replace:(i,r)=>{let a=typeof r=="string"?r:r.source;return a=a.replace(Je.caret,"$1"),n=n.replace(i,a),s},getRegex:()=>new RegExp(n,t)};return s}var ah=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Je={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},lh=/^(?:[ \t]*(?:\n|$))+/,oh=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,ch=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,ts=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,uh=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,rr=/(?:[*+-]|\d{1,9}[.)])/,Gl=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Wl=ve(Gl).replace(/bull/g,rr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),dh=ve(Gl).replace(/bull/g,rr).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),ar=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,fh=/^[^\n]+/,lr=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,hh=ve(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",lr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ph=ve(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,rr).getRegex(),zs="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",or=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gh=ve("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",or).replace("tag",zs).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Jl=ve(ar).replace("hr",ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zs).getRegex(),mh=ve(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Jl).getRegex(),cr={blockquote:mh,code:oh,def:hh,fences:ch,heading:uh,hr:ts,html:gh,lheading:Wl,list:ph,newline:lh,paragraph:Jl,table:qn,text:fh},ga=ve("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zs).getRegex(),vh={...cr,lheading:dh,table:ga,paragraph:ve(ar).replace("hr",ts).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ga).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zs).getRegex()},yh={...cr,html:ve(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",or).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:qn,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ve(ar).replace("hr",ts).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Wl).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},bh=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,kh=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Yl=/^( {2,}|\\)\n(?!\s*$)/,wh=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Vs=/[\p{P}\p{S}]/u,ur=/[\s\p{P}\p{S}]/u,Ql=/[^\s\p{P}\p{S}]/u,xh=ve(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ur).getRegex(),Zl=/(?!~)[\p{P}\p{S}]/u,Ch=/(?!~)[\s\p{P}\p{S}]/u,Sh=/(?:[^\s\p{P}\p{S}]|~)/u,_h=ve(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",ah?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Xl=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,$h=ve(Xl,"u").replace(/punct/g,Vs).getRegex(),Th=ve(Xl,"u").replace(/punct/g,Zl).getRegex(),eo="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Eh=ve(eo,"gu").replace(/notPunctSpace/g,Ql).replace(/punctSpace/g,ur).replace(/punct/g,Vs).getRegex(),Rh=ve(eo,"gu").replace(/notPunctSpace/g,Sh).replace(/punctSpace/g,Ch).replace(/punct/g,Zl).getRegex(),Ah=ve("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Ql).replace(/punctSpace/g,ur).replace(/punct/g,Vs).getRegex(),Ph=ve(/\\(punct)/,"gu").replace(/punct/g,Vs).getRegex(),Mh=ve(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Ih=ve(or).replace("(?:-->|$)","-->").getRegex(),Oh=ve("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Ih).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),As=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Lh=ve(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",As).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),to=ve(/^!?\[(label)\]\[(ref)\]/).replace("label",As).replace("ref",lr).getRegex(),no=ve(/^!?\[(ref)\](?:\[\])?/).replace("ref",lr).getRegex(),Nh=ve("reflink|nolink(?!\\()","g").replace("reflink",to).replace("nolink",no).getRegex(),ma=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,dr={_backpedal:qn,anyPunctuation:Ph,autolink:Mh,blockSkip:_h,br:Yl,code:kh,del:qn,emStrongLDelim:$h,emStrongRDelimAst:Eh,emStrongRDelimUnd:Ah,escape:bh,link:Lh,nolink:no,punctuation:xh,reflink:to,reflinkSearch:Nh,tag:Oh,text:wh,url:qn},Dh={...dr,link:ve(/^!?\[(label)\]\((.*?)\)/).replace("label",As).getRegex(),reflink:ve(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",As).getRegex()},Ai={...dr,emStrongRDelimAst:Rh,emStrongLDelim:Th,url:ve(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",ma).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:ve(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",ma).getRegex()},Bh={...Ai,br:ve(Yl).replace("{2,}","*").getRegex(),text:ve(Ai.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},cs={normal:cr,gfm:vh,pedantic:yh},An={normal:dr,gfm:Ai,breaks:Bh,pedantic:Dh},Fh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},va=e=>Fh[e];function _t(e,t){if(t){if(Je.escapeTest.test(e))return e.replace(Je.escapeReplace,va)}else if(Je.escapeTestNoEncode.test(e))return e.replace(Je.escapeReplaceNoEncode,va);return e}function ya(e){try{e=encodeURI(e).replace(Je.percentDecode,"%")}catch{return null}return e}function ba(e,t){var r;let n=e.replace(Je.findPipe,(a,l,o)=>{let u=!1,d=l;for(;--d>=0&&o[d]==="\\";)u=!u;return u?"|":" |"}),s=n.split(Je.splitPipe),i=0;if(s[0].trim()||s.shift(),s.length>0&&!((r=s.at(-1))!=null&&r.trim())&&s.pop(),t)if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;i<s.length;i++)s[i]=s[i].trim().replace(Je.slashPipe,"|");return s}function Pn(e,t,n){let s=e.length;if(s===0)return"";let i=0;for(;i<s&&e.charAt(s-i-1)===t;)i++;return e.slice(0,s-i)}function Uh(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let s=0;s<e.length;s++)if(e[s]==="\\")s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return n>0?-2:-1}function ka(e,t,n,s,i){let r=t.href,a=t.title||null,l=e[1].replace(i.other.outputLinkReplace,"$1");s.state.inLink=!0;let o={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:r,title:a,text:l,tokens:s.inlineTokens(l)};return s.state.inLink=!1,o}function Hh(e,t,n){let s=e.match(n.other.indentCodeCompensation);if(s===null)return t;let i=s[1];return t.split(`
`).map(r=>{let a=r.match(n.other.beginningSpace);if(a===null)return r;let[l]=a;return l.length>=i.length?r.slice(i.length):r}).join(`
`)}var Ps=class{constructor(e){xe(this,"options");xe(this,"rules");xe(this,"lexer");this.options=e||cn}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Pn(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],s=Hh(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:s}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let s=Pn(n,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(n=s.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Pn(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Pn(t[0],`
`).split(`
`),s="",i="",r=[];for(;n.length>0;){let a=!1,l=[],o;for(o=0;o<n.length;o++)if(this.rules.other.blockquoteStart.test(n[o]))l.push(n[o]),a=!0;else if(!a)l.push(n[o]);else break;n=n.slice(o);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${u}`:u,i=i?`${i}
${d}`:d;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,r,!0),this.lexer.state.top=h,n.length===0)break;let p=r.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){let f=p,k=f.raw+`
`+n.join(`
`),g=this.blockquote(k);r[r.length-1]=g,s=s.substring(0,s.length-f.raw.length)+g.raw,i=i.substring(0,i.length-f.text.length)+g.text;break}else if((p==null?void 0:p.type)==="list"){let f=p,k=f.raw+`
`+n.join(`
`),g=this.list(k);r[r.length-1]=g,s=s.substring(0,s.length-p.raw.length)+g.raw,i=i.substring(0,i.length-f.raw.length)+g.raw,n=k.substring(r.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:r,text:i}}}list(e){var n,s;let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim(),r=i.length>1,a={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");let l=this.rules.other.listItemRegex(i),o=!1;for(;e;){let d=!1,h="",p="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;h=t[0],e=e.substring(h.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,R=>" ".repeat(3*R.length)),k=e.split(`
`,1)[0],g=!f.trim(),S=0;if(this.options.pedantic?(S=2,p=f.trimStart()):g?S=t[1].length+1:(S=t[2].search(this.rules.other.nonSpaceChar),S=S>4?1:S,p=f.slice(S),S+=t[1].length),g&&this.rules.other.blankLine.test(k)&&(h+=k+`
`,e=e.substring(k.length+1),d=!0),!d){let R=this.rules.other.nextBulletRegex(S),y=this.rules.other.hrRegex(S),x=this.rules.other.fencesBeginRegex(S),$=this.rules.other.headingBeginRegex(S),P=this.rules.other.htmlBeginRegex(S);for(;e;){let C=e.split(`
`,1)[0],m;if(k=C,this.options.pedantic?(k=k.replace(this.rules.other.listReplaceNesting,"  "),m=k):m=k.replace(this.rules.other.tabCharGlobal,"    "),x.test(k)||$.test(k)||P.test(k)||R.test(k)||y.test(k))break;if(m.search(this.rules.other.nonSpaceChar)>=S||!k.trim())p+=`
`+m.slice(S);else{if(g||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||x.test(f)||$.test(f)||y.test(f))break;p+=`
`+k}!g&&!k.trim()&&(g=!0),h+=C+`
`,e=e.substring(C.length+1),f=m.slice(S)}}a.loose||(o?a.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(o=!0)),a.items.push({type:"list_item",raw:h,task:!!this.options.gfm&&this.rules.other.listIsTask.test(p),loose:!1,text:p,tokens:[]}),a.raw+=h}let u=a.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let d of a.items){if(this.lexer.state.top=!1,d.tokens=this.lexer.blockTokens(d.text,[]),d.task){if(d.text=d.text.replace(this.rules.other.listReplaceTask,""),((n=d.tokens[0])==null?void 0:n.type)==="text"||((s=d.tokens[0])==null?void 0:s.type)==="paragraph"){d.tokens[0].raw=d.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),d.tokens[0].text=d.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let p=this.lexer.inlineQueue.length-1;p>=0;p--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[p].src)){this.lexer.inlineQueue[p].src=this.lexer.inlineQueue[p].src.replace(this.rules.other.listReplaceTask,"");break}}let h=this.rules.other.listTaskCheckbox.exec(d.raw);if(h){let p={type:"checkbox",raw:h[0]+" ",checked:h[0]!=="[ ]"};d.checked=p.checked,a.loose?d.tokens[0]&&["paragraph","text"].includes(d.tokens[0].type)&&"tokens"in d.tokens[0]&&d.tokens[0].tokens?(d.tokens[0].raw=p.raw+d.tokens[0].raw,d.tokens[0].text=p.raw+d.tokens[0].text,d.tokens[0].tokens.unshift(p)):d.tokens.unshift({type:"paragraph",raw:p.raw,text:p.raw,tokens:[p]}):d.tokens.unshift(p)}}if(!a.loose){let h=d.tokens.filter(f=>f.type==="space"),p=h.length>0&&h.some(f=>this.rules.other.anyLine.test(f.raw));a.loose=p}}if(a.loose)for(let d of a.items){d.loose=!0;for(let h of d.tokens)h.type==="text"&&(h.type="paragraph")}return a}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:s,title:i}}}table(e){var a;let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=ba(t[1]),s=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],r={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===s.length){for(let l of s)this.rules.other.tableAlignRight.test(l)?r.align.push("right"):this.rules.other.tableAlignCenter.test(l)?r.align.push("center"):this.rules.other.tableAlignLeft.test(l)?r.align.push("left"):r.align.push(null);for(let l=0;l<n.length;l++)r.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:r.align[l]});for(let l of i)r.rows.push(ba(l,r.header.length).map((o,u)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:r.align[u]})));return r}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let r=Pn(n.slice(0,-1),"\\");if((n.length-r.length)%2===0)return}else{let r=Uh(t[2],"()");if(r===-2)return;if(r>-1){let a=(t[0].indexOf("!")===0?5:4)+t[1].length+r;t[2]=t[2].substring(0,r),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let s=t[2],i="";if(this.options.pedantic){let r=this.rules.other.pedanticHrefTitle.exec(s);r&&(s=r[1],i=r[3])}else i=t[3]?t[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?s=s.slice(1):s=s.slice(1,-1)),ka(t,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let s=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[s.toLowerCase()];if(!i){let r=n[0].charAt(0);return{type:"text",raw:r,text:r}}return ka(n,i,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!(!s||s[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!n||this.rules.inline.punctuation.exec(n))){let i=[...s[0]].length-1,r,a,l=i,o=0,u=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(s=u.exec(t))!=null;){if(r=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!r)continue;if(a=[...r].length,s[3]||s[4]){l+=a;continue}else if((s[5]||s[6])&&i%3&&!((i+a)%3)){o+=a;continue}if(l-=a,l>0)continue;a=Math.min(a,a+l+o);let d=[...s[0]][0].length,h=e.slice(0,i+s.index+d+a);if(Math.min(i,a)%2){let f=h.slice(1,-1);return{type:"em",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}let p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(n),i=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return s&&i&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,s;return t[2]==="@"?(n=t[1],s="mailto:"+n):(n=t[1],s=n),{type:"link",raw:t[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let s,i;if(t[2]==="@")s=t[0],i="mailto:"+s;else{let r;do r=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(r!==t[0]);s=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:s,href:i,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},ot=class Pi{constructor(t){xe(this,"tokens");xe(this,"options");xe(this,"state");xe(this,"inlineQueue");xe(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||cn,this.options.tokenizer=this.options.tokenizer||new Ps,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:Je,block:cs.normal,inline:An.normal};this.options.pedantic?(n.block=cs.pedantic,n.inline=An.pedantic):this.options.gfm&&(n.block=cs.gfm,this.options.breaks?n.inline=An.breaks:n.inline=An.gfm),this.tokenizer.rules=n}static get rules(){return{block:cs,inline:An}}static lex(t,n){return new Pi(n).lex(t)}static lexInline(t,n){return new Pi(n).inlineTokens(t)}lex(t){t=t.replace(Je.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let s=this.inlineQueue[n];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],s=!1){var i,r,a;for(this.options.pedantic&&(t=t.replace(Je.tabCharGlobal,"    ").replace(Je.spaceLine,""));t;){let l;if((r=(i=this.options.extensions)==null?void 0:i.block)!=null&&r.some(u=>(l=u.call({lexer:this},t,n))?(t=t.substring(l.raw.length),n.push(l),!0):!1))continue;if(l=this.tokenizer.space(t)){t=t.substring(l.raw.length);let u=n.at(-1);l.raw.length===1&&u!==void 0?u.raw+=`
`:n.push(l);continue}if(l=this.tokenizer.code(t)){t=t.substring(l.raw.length);let u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.at(-1).src=u.text):n.push(l);continue}if(l=this.tokenizer.fences(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.heading(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.hr(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.blockquote(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.list(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.html(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.def(t)){t=t.substring(l.raw.length);let u=n.at(-1);(u==null?void 0:u.type)==="paragraph"||(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.raw,this.inlineQueue.at(-1).src=u.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title},n.push(l));continue}if(l=this.tokenizer.table(t)){t=t.substring(l.raw.length),n.push(l);continue}if(l=this.tokenizer.lheading(t)){t=t.substring(l.raw.length),n.push(l);continue}let o=t;if((a=this.options.extensions)!=null&&a.startBlock){let u=1/0,d=t.slice(1),h;this.options.extensions.startBlock.forEach(p=>{h=p.call({lexer:this},d),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(o=t.substring(0,u+1))}if(this.state.top&&(l=this.tokenizer.paragraph(o))){let u=n.at(-1);s&&(u==null?void 0:u.type)==="paragraph"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(l),s=o.length!==t.length,t=t.substring(l.raw.length);continue}if(l=this.tokenizer.text(t)){t=t.substring(l.raw.length);let u=n.at(-1);(u==null?void 0:u.type)==="text"?(u.raw+=(u.raw.endsWith(`
`)?"":`
`)+l.raw,u.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=u.text):n.push(l);continue}if(t){let u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,u,d,h,p;let s=t,i=null;if(this.tokens.links){let f=Object.keys(this.tokens.links);if(f.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)f.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,i.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r;for(;(i=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)r=i[2]?i[2].length:0,s=s.slice(0,i.index+r)+"["+"a".repeat(i[0].length-r-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((u=(o=this.options.hooks)==null?void 0:o.emStrongMask)==null?void 0:u.call({lexer:this},s))??s;let a=!1,l="";for(;t;){a||(l=""),a=!1;let f;if((h=(d=this.options.extensions)==null?void 0:d.inline)!=null&&h.some(g=>(f=g.call({lexer:this},t,n))?(t=t.substring(f.raw.length),n.push(f),!0):!1))continue;if(f=this.tokenizer.escape(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.tag(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.link(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(f.raw.length);let g=n.at(-1);f.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=f.raw,g.text+=f.text):n.push(f);continue}if(f=this.tokenizer.emStrong(t,s,l)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.codespan(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.br(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.del(t)){t=t.substring(f.raw.length),n.push(f);continue}if(f=this.tokenizer.autolink(t)){t=t.substring(f.raw.length),n.push(f);continue}if(!this.state.inLink&&(f=this.tokenizer.url(t))){t=t.substring(f.raw.length),n.push(f);continue}let k=t;if((p=this.options.extensions)!=null&&p.startInline){let g=1/0,S=t.slice(1),R;this.options.extensions.startInline.forEach(y=>{R=y.call({lexer:this},S),typeof R=="number"&&R>=0&&(g=Math.min(g,R))}),g<1/0&&g>=0&&(k=t.substring(0,g+1))}if(f=this.tokenizer.inlineText(k)){t=t.substring(f.raw.length),f.raw.slice(-1)!=="_"&&(l=f.raw.slice(-1)),a=!0;let g=n.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=f.raw,g.text+=f.text):n.push(f);continue}if(t){let g="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return n}},Ms=class{constructor(e){xe(this,"options");xe(this,"parser");this.options=e||cn}space(e){return""}code({text:e,lang:t,escaped:n}){var r;let s=(r=(t||"").match(Je.notSpaceStart))==null?void 0:r[0],i=e.replace(Je.endingNewline,"")+`
`;return s?'<pre><code class="language-'+_t(s)+'">'+(n?i:_t(i,!0))+`</code></pre>
`:"<pre><code>"+(n?i:_t(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,s="";for(let a=0;a<e.items.length;a++){let l=e.items[a];s+=this.listitem(l)}let i=t?"ol":"ul",r=t&&n!==1?' start="'+n+'"':"";return"<"+i+r+`>
`+s+"</"+i+`>
`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let i=0;i<e.header.length;i++)n+=this.tablecell(e.header[i]);t+=this.tablerow({text:n});let s="";for(let i=0;i<e.rows.length;i++){let r=e.rows[i];n="";for(let a=0;a<r.length;a++)n+=this.tablecell(r[a]);s+=this.tablerow({text:n})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+s+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${_t(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let s=this.parser.parseInline(n),i=ya(e);if(i===null)return s;e=i;let r='<a href="'+e+'"';return t&&(r+=' title="'+_t(t)+'"'),r+=">"+s+"</a>",r}image({href:e,title:t,text:n,tokens:s}){s&&(n=this.parser.parseInline(s,this.parser.textRenderer));let i=ya(e);if(i===null)return _t(n);e=i;let r=`<img src="${e}" alt="${n}"`;return t&&(r+=` title="${_t(t)}"`),r+=">",r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:_t(e.text)}},fr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},ct=class Mi{constructor(t){xe(this,"options");xe(this,"renderer");xe(this,"textRenderer");this.options=t||cn,this.options.renderer=this.options.renderer||new Ms,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new fr}static parse(t,n){return new Mi(n).parse(t)}static parseInline(t,n){return new Mi(n).parseInline(t)}parse(t){var s,i;let n="";for(let r=0;r<t.length;r++){let a=t[r];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[a.type]){let o=a,u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){n+=u||"";continue}}let l=a;switch(l.type){case"space":{n+=this.renderer.space(l);break}case"hr":{n+=this.renderer.hr(l);break}case"heading":{n+=this.renderer.heading(l);break}case"code":{n+=this.renderer.code(l);break}case"table":{n+=this.renderer.table(l);break}case"blockquote":{n+=this.renderer.blockquote(l);break}case"list":{n+=this.renderer.list(l);break}case"checkbox":{n+=this.renderer.checkbox(l);break}case"html":{n+=this.renderer.html(l);break}case"def":{n+=this.renderer.def(l);break}case"paragraph":{n+=this.renderer.paragraph(l);break}case"text":{n+=this.renderer.text(l);break}default:{let o='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return n}parseInline(t,n=this.renderer){var i,r;let s="";for(let a=0;a<t.length;a++){let l=t[a];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[l.type]){let u=this.options.extensions.renderers[l.type].call({parser:this},l);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(l.type)){s+=u||"";continue}}let o=l;switch(o.type){case"escape":{s+=n.text(o);break}case"html":{s+=n.html(o);break}case"link":{s+=n.link(o);break}case"image":{s+=n.image(o);break}case"checkbox":{s+=n.checkbox(o);break}case"strong":{s+=n.strong(o);break}case"em":{s+=n.em(o);break}case"codespan":{s+=n.codespan(o);break}case"br":{s+=n.br(o);break}case"del":{s+=n.del(o);break}case"text":{s+=n.text(o);break}default:{let u='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return s}},hs,On=(hs=class{constructor(e){xe(this,"options");xe(this,"block");this.options=e||cn}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?ot.lex:ot.lexInline}provideParser(){return this.block?ct.parse:ct.parseInline}},xe(hs,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),xe(hs,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),hs),Kh=class{constructor(...e){xe(this,"defaults",ir());xe(this,"options",this.setOptions);xe(this,"parse",this.parseMarkdown(!0));xe(this,"parseInline",this.parseMarkdown(!1));xe(this,"Parser",ct);xe(this,"Renderer",Ms);xe(this,"TextRenderer",fr);xe(this,"Lexer",ot);xe(this,"Tokenizer",Ps);xe(this,"Hooks",On);this.use(...e)}walkTokens(e,t){var s,i;let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let a=r;for(let l of a.header)n=n.concat(this.walkTokens(l.tokens,t));for(let l of a.rows)for(let o of l)n=n.concat(this.walkTokens(o.tokens,t));break}case"list":{let a=r;n=n.concat(this.walkTokens(a.items,t));break}default:{let a=r;(i=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(l=>{let o=a[l].flat(1/0);n=n.concat(this.walkTokens(o,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let s={...n};if(s.async=this.defaults.async||s.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let r=t.renderers[i.name];r?t.renderers[i.name]=function(...a){let l=i.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let r=t[i.level];r?r.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),s.extensions=t),n.renderer){let i=this.defaults.renderer||new Ms(this.defaults);for(let r in n.renderer){if(!(r in i))throw new Error(`renderer '${r}' does not exist`);if(["options","parser"].includes(r))continue;let a=r,l=n.renderer[a],o=i[a];i[a]=(...u)=>{let d=l.apply(i,u);return d===!1&&(d=o.apply(i,u)),d||""}}s.renderer=i}if(n.tokenizer){let i=this.defaults.tokenizer||new Ps(this.defaults);for(let r in n.tokenizer){if(!(r in i))throw new Error(`tokenizer '${r}' does not exist`);if(["options","rules","lexer"].includes(r))continue;let a=r,l=n.tokenizer[a],o=i[a];i[a]=(...u)=>{let d=l.apply(i,u);return d===!1&&(d=o.apply(i,u)),d}}s.tokenizer=i}if(n.hooks){let i=this.defaults.hooks||new On;for(let r in n.hooks){if(!(r in i))throw new Error(`hook '${r}' does not exist`);if(["options","block"].includes(r))continue;let a=r,l=n.hooks[a],o=i[a];On.passThroughHooks.has(r)?i[a]=u=>{if(this.defaults.async&&On.passThroughHooksRespectAsync.has(r))return(async()=>{let h=await l.call(i,u);return o.call(i,h)})();let d=l.call(i,u);return o.call(i,d)}:i[a]=(...u)=>{if(this.defaults.async)return(async()=>{let h=await l.apply(i,u);return h===!1&&(h=await o.apply(i,u)),h})();let d=l.apply(i,u);return d===!1&&(d=o.apply(i,u)),d}}s.hooks=i}if(n.walkTokens){let i=this.defaults.walkTokens,r=n.walkTokens;s.walkTokens=function(a){let l=[];return l.push(r.call(this,a)),i&&(l=l.concat(i.call(this,a))),l}}this.defaults={...this.defaults,...s}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ot.lex(e,t??this.defaults)}parser(e,t){return ct.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let s={...n},i={...this.defaults,...s},r=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||t===null)return r(new Error("marked(): input parameter is undefined or null"));if(typeof t!="string")return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(i.hooks&&(i.hooks.options=i,i.hooks.block=e),i.async)return(async()=>{let a=i.hooks?await i.hooks.preprocess(t):t,l=await(i.hooks?await i.hooks.provideLexer():e?ot.lex:ot.lexInline)(a,i),o=i.hooks?await i.hooks.processAllTokens(l):l;i.walkTokens&&await Promise.all(this.walkTokens(o,i.walkTokens));let u=await(i.hooks?await i.hooks.provideParser():e?ct.parse:ct.parseInline)(o,i);return i.hooks?await i.hooks.postprocess(u):u})().catch(r);try{i.hooks&&(t=i.hooks.preprocess(t));let a=(i.hooks?i.hooks.provideLexer():e?ot.lex:ot.lexInline)(t,i);i.hooks&&(a=i.hooks.processAllTokens(a)),i.walkTokens&&this.walkTokens(a,i.walkTokens);let l=(i.hooks?i.hooks.provideParser():e?ct.parse:ct.parseInline)(a,i);return i.hooks&&(l=i.hooks.postprocess(l)),l}catch(a){return r(a)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let s="<p>An error occurred:</p><pre>"+_t(n.message+"",!0)+"</pre>";return t?Promise.resolve(s):s}if(t)return Promise.reject(n);throw n}}},an=new Kh;function ye(e,t){return an.parse(e,t)}ye.options=ye.setOptions=function(e){return an.setOptions(e),ye.defaults=an.defaults,Vl(ye.defaults),ye};ye.getDefaults=ir;ye.defaults=cn;ye.use=function(...e){return an.use(...e),ye.defaults=an.defaults,Vl(ye.defaults),ye};ye.walkTokens=function(e,t){return an.walkTokens(e,t)};ye.parseInline=an.parseInline;ye.Parser=ct;ye.parser=ct.parse;ye.Renderer=Ms;ye.TextRenderer=fr;ye.Lexer=ot;ye.lexer=ot.lex;ye.Tokenizer=Ps;ye.Hooks=On;ye.parse=ye;ye.options;ye.setOptions;ye.use;ye.walkTokens;ye.parseInline;ct.parse;ot.lex;const qh=["innerHTML"],jh={__name:"MarkdownText",props:{text:{type:String,default:""}},setup(e){const t=e,n=ie(()=>t.text?ye.parse(t.text,{breaks:!0}):"");return(s,i)=>(b(),_("span",{class:"markdown-text",innerHTML:n.value},null,8,qh))}},sn=De(jh,[["__scopeId","data-v-56f13102"]]),zh={class:"card-view-inner"},Vh={class:"card-view-back"},Gh={class:"card-view-back-header"},Wh={key:0,class:"card-view-section image-story-section"},Jh={class:"image-story-header"},Yh=["disabled"],Qh={key:1,class:"text-muted image-hint"},Zh={class:"image-story-content"},Xh={key:0,class:"image-story-preview"},ep=["src"],tp={class:"image-story-text"},np={key:0,class:"image-prompt-text"},sp={key:0,class:"card-view-loading"},ip={class:"actions-right"},rp={__name:"BaseCard",props:{card:{type:Object,required:!0},loading:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},canEdit:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},initialFlipped:{type:Boolean,default:!1},scrollTargetRef:{type:Object,default:null}},emits:["delete","close","edit","flip"],setup(e,{expose:t,emit:n}){const s=I(null),i=e,r=n,{getStoredKey:a,hasStoredKey:l,getActiveConfig:o}=on(),u=I(i.initialFlipped),d=I(null),h=I(!1),p=I(null);t({flipped:u,imageDataUrl:d});const f=ie(()=>{const $=o();return($==null?void 0:$.provider)==="openai"&&($!=null&&$.apiKey)?!0:l("openai")});function k(){const $=o();return($==null?void 0:$.provider)==="openai"&&($!=null&&$.apiKey)?$.apiKey:l("openai")?a("openai"):null}const g=ie(()=>i.card.imagePrompt);Ne(()=>i.card,async $=>{u.value=i.initialFlipped,await S($.id),i.isEditing||R()},{deep:!0}),Qe(async()=>{await S(i.card.id),R()});async function S($){if(!$){d.value=null;return}try{const P=await ih($);d.value=pa(P)}catch{d.value=null}}function R(){$n(()=>{const $=i.scrollTargetRef||s.value;if(!$)return;$.getBoundingClientRect().top<0&&$.scrollIntoView({block:"start"})})}async function y(){if(!i.card.imagePrompt){p.value="No image prompt available";return}const $=k();if(!$){p.value="OpenAI API key not configured. Add OpenAI provider in Settings.";return}h.value=!0,p.value=null;try{const P=await th(i.card.imagePrompt,$);await sh(i.card.id,P),d.value=pa(P)}catch(P){p.value=P.message}finally{h.value=!1}}function x($){if(i.isEditing||$.target.closest("button, input, textarea, a"))return;const P=window.getSelection();P&&P.toString().length>0||(u.value=!u.value,r("flip",u.value),R())}return($,P)=>(b(),_("div",{class:"card-view-container",ref_key:"cardContainer",ref:s},[c("div",{class:Se(["card-view",{flipped:u.value,editing:e.isEditing}]),onClick:x},[c("div",zh,[c("div",{class:Se(["card-view-front",{"has-bg-image":d.value}]),style:Zn(d.value?{backgroundImage:`url(${d.value})`}:{})},[En($.$slots,"front",{},void 0)],6),c("div",Vh,[c("div",Gh,[En($.$slots,"back-header",{},void 0)]),En($.$slots,"back",{},void 0),e.card.imagePrompt||d.value?(b(),_("section",Wh,[c("div",Jh,[P[5]||(P[5]=c("h4",null,"Image Story",-1)),g.value&&!e.loading?(b(),_("button",{key:0,class:"btn btn-small",onClick:Me(y,["stop"]),disabled:h.value},L(h.value?"Generating...":d.value?"Regenerate":"Generate"),9,Yh)):K("",!0),g.value&&!e.loading&&!f.value?(b(),_("span",Qh," (requires OpenAI) ")):K("",!0)]),c("div",Zh,[d.value?(b(),_("div",Xh,[c("img",{src:d.value,alt:"Memory image"},null,8,ep)])):K("",!0),c("div",tp,[e.card.imagePrompt?(b(),_("p",np,[Ae(sn,{text:e.card.imagePrompt},null,8,["text"])])):K("",!0)])]),p.value?(b(),_("div",{key:0,class:"image-error",onClick:P[0]||(P[0]=Me(()=>{},["stop"]))},L(p.value),1)):K("",!0)])):K("",!0)])]),e.loading&&!e.isEditing?(b(),_("div",sp,[...P[6]||(P[6]=[c("span",{class:"spinner"},null,-1),nt(" Generating... ",-1)])])):K("",!0)],2),e.isEditing?En($.$slots,"edit-panel",{key:0},void 0):K("",!0),e.loading?K("",!0):(b(),_("div",{key:1,class:"card-view-external-actions",onClick:P[4]||(P[4]=Me(()=>{},["stop"]))},[En($.$slots,"actions",{},()=>[c("button",{class:"btn btn-danger-text btn-small",onClick:P[1]||(P[1]=C=>$.$emit("delete"))},"Delete"),c("div",ip,[e.canEdit?(b(),_("button",{key:0,class:"btn btn-small",onClick:P[2]||(P[2]=C=>$.$emit("edit"))},"Edit")):K("",!0),e.showClose?(b(),_("button",{key:1,class:"btn btn-small",onClick:P[3]||(P[3]=C=>$.$emit("close"))}," Back")):K("",!0)])])]))],512))}},so=De(rp,[["__scopeId","data-v-360503ad"]]);let dn=null,Mn=!1,hn=null;function Gs(){return"speechSynthesis"in window}function ap(e){let t=0;return e.lang==="zh-CN"?t+=10:e.lang==="zh-TW"?t+=5:e.lang.startsWith("zh")&&(t+=1),["Tingting","Sinji","Meijia","Lili","Xiaoxiao","Yunyang","Xiaoyi","Google"].some(s=>e.name.includes(s))&&(t+=100),e.name.toLowerCase().includes("compact")&&(t-=50),e.localService&&(t+=200),t}function ci(){var n;const e=speechSynthesis.getVoices();return e.length===0?null:((n=e.filter(s=>s.lang.startsWith("zh")).map(s=>({voice:s,score:ap(s)})).sort((s,i)=>i.score-s.score)[0])==null?void 0:n.voice)||null}function io(){return new Promise(e=>{if(dn){e(dn);return}const t=ci();if(t){dn=t,Mn=!0,e(t);return}if(Mn){e(null);return}const n=()=>{const s=ci();dn=s,Mn=!0,speechSynthesis.removeEventListener("voiceschanged",n),e(s)};speechSynthesis.addEventListener("voiceschanged",n),setTimeout(()=>{Mn||(Mn=!0,dn=ci(),speechSynthesis.removeEventListener("voiceschanged",n),e(dn))},2e3)})}function lp(){Gs()&&io()}async function ro(e,{rate:t=1}={}){if(!Gs()||!e)return Promise.resolve();ao();const n=await io();return new Promise(s=>{const i=new SpeechSynthesisUtterance(e);i.lang="zh-CN",i.rate=t,n&&(i.voice=n),hn=i,i.onend=()=>{hn=null,s()},i.onerror=()=>{hn=null,s()},speechSynthesis.cancel(),setTimeout(()=>{speechSynthesis.speak(i),speechSynthesis.paused&&speechSynthesis.resume();const r=Math.max(5e3,e.length*500);setTimeout(()=>{hn===i&&(hn=null,s())},r)},50)})}function ao(){Gs()&&(speechSynthesis.cancel(),hn=null)}function hr(){const e=I(!1),t=Gs();t&&lp();async function n(i,r){if(!(!t||!i)){e.value=!0;try{await ro(i,r)}finally{e.value=!1}}}function s(){ao(),e.value=!1}return xt(()=>{s()}),{speak:n,stop:s,isSpeaking:e,isSupported:t}}const op={class:"card-view-character"},cp=["disabled"],up={class:"card-view-pinyin"},dp={class:"card-view-hint"},fp={class:"back-header-char"},hp={class:"back-header-pinyin"},pp=["disabled"],gp={key:1,class:"back-header-badge hsk-badge-small"},mp={key:0,class:"card-view-section card-view-translation"},vp={class:"translation-text"},yp={class:"card-view-section"},bp={key:1,class:"card-view-section"},kp={key:2,class:"card-view-section"},wp={class:"example-zh"},xp=["onClick","disabled"],Cp={class:"example-pinyin"},Sp={class:"example-en"},_p={key:3,class:"card-view-section"},$p={key:4,class:"card-view-section"},Tp={class:"related-words"},Ep=["href","onClick"],Rp={class:"related-zh"},Ap={class:"related-pinyin"},Pp={class:"related-en"},Mp={key:5,class:"card-view-generate"},Ip={class:"card-view-edit-panel"},Op={class:"edit-panel-header"},Lp=["disabled"],Np={class:"edit-front-preview"},Dp={class:"preview-character"},Bp={class:"edit-field"},Fp={class:"edit-field"},Up={class:"edit-field"},Hp={class:"edit-field"},Kp=["onUpdate:modelValue"],qp=["onUpdate:modelValue"],jp=["onUpdate:modelValue"],zp=["onClick"],Vp={class:"edit-field"},Gp={class:"edit-field"},Wp={class:"actions-left"},Jp={key:1,class:"collection-badge"},Yp={class:"actions-right"},Qp={__name:"CardView",props:{card:{type:Object,required:!0},isNew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},initialFlipped:{type:Boolean,default:!1},hskBadge:{type:Object,default:null},isInCollection:{type:Boolean,default:!1},regeneratedData:{type:Object,default:null},scrollTargetRef:{type:Object,default:null}},emits:["save","delete","close","generate","regenerate","addToCollection","navigate","clearRegenerated"],setup(e,{emit:t}){const n=e,s=t,i=I(g(n.card)),r=I(!1),a=I(null),{speak:l,isSpeaking:o,isSupported:u}=hr();async function d(){i.value.character&&(a.value=await ht(i.value.character))}const h=ie(()=>!!(i.value.meaning&&i.value.meaning.trim())),p=ie(()=>{var C,m;return i.value.translation?i.value.translation:(m=(C=a.value)==null?void 0:C.cedict)!=null&&m[0]?Sn(a.value.cedict[0].definitions):""}),f=ie(()=>{var C,m;return i.value.meaning?i.value.meaning:(m=(C=a.value)==null?void 0:C.cedict)!=null&&m[0]?Sn(a.value.cedict[0].definitions):""}),k=ie(()=>{var C,m;return i.value.components?i.value.components:(C=a.value)!=null&&C.ids?a.value.ids.decomposition:(m=a.value)!=null&&m.componentIds?a.value.componentIds.map(A=>`${A.character}: ${A.decomposition}`).join(" | "):""});Ne(()=>n.card,C=>{r.value||(i.value=g(C)),h.value&&n.isNew&&(r.value=!1),d()},{deep:!0}),Ne(()=>n.regeneratedData,C=>{C&&r.value&&(i.value=g(C))}),Qe(()=>{d()});function g(C){return JSON.parse(JSON.stringify(C))}function S(){s("close")}function R(){r.value=!0}function y(){i.value=g(n.card),r.value=!1,s("clearRegenerated")}function x(){s("save",i.value),r.value=!1,s("clearRegenerated")}function $(){i.value.examples||(i.value.examples=[]),i.value.examples.push({zh:"",pinyin:"",en:""})}function P(C){i.value.examples.splice(C,1)}return(C,m)=>(b(),Pe(so,{card:i.value,loading:e.loading,"show-close":e.showClose,"can-edit":!e.isNew||h.value,"is-editing":r.value,"initial-flipped":e.initialFlipped,"scroll-target-ref":e.scrollTargetRef,onDelete:m[13]||(m[13]=A=>C.$emit("delete")),onClose:S,onEdit:R},{front:Rt(()=>[c("div",op,[nt(L(i.value.character)+" ",1),G(u)?(b(),_("button",{key:0,class:"speak-btn speak-btn-large",onClick:m[0]||(m[0]=Me(A=>G(l)(i.value.character),["stop"])),disabled:G(o),title:"Listen"},[...m[14]||(m[14]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),c("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})],-1)])],8,cp)):K("",!0)]),c("div",up,L(i.value.pinyin),1),c("div",dp,L(i.value.microClue||""),1),e.hskBadge?(b(),_("div",{key:0,class:Se(["hsk-badge","hsk-"+e.hskBadge.level])}," HSK "+L(e.hskBadge.level),3)):K("",!0)]),"back-header":Rt(()=>[c("span",fp,L(i.value.character),1),c("span",hp,L(i.value.pinyin),1),G(u)?(b(),_("button",{key:0,class:"speak-btn",onClick:m[1]||(m[1]=Me(A=>G(l)(i.value.character),["stop"])),disabled:G(o),title:"Listen"},[...m[15]||(m[15]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),c("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})],-1)])],8,pp)):K("",!0),e.hskBadge?(b(),_("span",gp,"HSK "+L(e.hskBadge.level),1)):K("",!0)]),back:Rt(()=>[p.value?(b(),_("section",mp,[c("span",vp,L(p.value),1)])):K("",!0),c("section",yp,[m[16]||(m[16]=c("h4",null,"Meaning",-1)),c("p",null,[Ae(sn,{text:f.value},null,8,["text"])])]),k.value?(b(),_("section",bp,[m[17]||(m[17]=c("h4",null,"Components",-1)),c("p",null,[Ae(sn,{text:k.value},null,8,["text"])])])):K("",!0),i.value.examples&&i.value.examples.length?(b(),_("section",kp,[m[19]||(m[19]=c("h4",null,"Examples",-1)),(b(!0),_(oe,null,_e(i.value.examples,(A,F)=>(b(),_("div",{key:F,class:"example"},[c("div",wp,[nt(L(A.zh)+" ",1),G(u)?(b(),_("button",{key:0,class:"speak-btn",onClick:Me(D=>G(l)(A.zh),["stop"]),disabled:G(o),title:"Listen"},[...m[18]||(m[18]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"}),c("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"})],-1)])],8,xp)):K("",!0)]),c("div",Cp,L(A.pinyin),1),c("div",Sp,L(A.en),1)]))),128))])):K("",!0),i.value.memoryStory?(b(),_("section",_p,[m[20]||(m[20]=c("h4",null,"Memory Story",-1)),c("p",null,[Ae(sn,{text:i.value.memoryStory},null,8,["text"])])])):K("",!0),i.value.relatedWords&&i.value.relatedWords.length?(b(),_("section",$p,[m[21]||(m[21]=c("h4",null,"Related",-1)),c("div",Tp,[(b(!0),_(oe,null,_e(i.value.relatedWords,(A,F)=>(b(),_("a",{key:F,href:"?card="+encodeURIComponent(A.zh),class:"related-word",onClick:Me(D=>C.$emit("navigate",A.zh),["prevent"])},[c("span",Rp,L(A.zh),1),c("span",Ap,L(A.pinyin),1),c("span",Pp,L(A.en),1)],8,Ep))),128))])])):K("",!0),e.isNew&&!h.value&&!e.loading?(b(),_("div",Mp,[c("button",{class:"btn btn-primary",onClick:m[2]||(m[2]=Me(A=>C.$emit("generate"),["stop"]))}," Generate with AI ")])):K("",!0)]),"edit-panel":Rt(()=>[c("div",Ip,[c("div",Op,[m[22]||(m[22]=c("h4",null,"Front Side",-1)),c("button",{class:"btn btn-small btn-secondary",onClick:m[3]||(m[3]=A=>C.$emit("regenerate")),disabled:e.loading,title:"Regenerate content with AI"},L(e.loading?"Regenerating...":"Regenerate"),9,Lp)]),c("div",Np,[c("div",Dp,L(i.value.character),1),me(c("input",{"onUpdate:modelValue":m[4]||(m[4]=A=>i.value.pinyin=A),class:"card-view-input",placeholder:"Pinyin"},null,512),[[Re,i.value.pinyin]]),me(c("input",{"onUpdate:modelValue":m[5]||(m[5]=A=>i.value.microClue=A),class:"card-view-input",placeholder:"Hint"},null,512),[[Re,i.value.microClue]])]),m[29]||(m[29]=c("h4",null,"Back Side",-1)),c("div",Bp,[m[23]||(m[23]=c("label",null,"Translation (short)",-1)),me(c("input",{"onUpdate:modelValue":m[6]||(m[6]=A=>i.value.translation=A),placeholder:"Concise translation, e.g. 'no; not; un-'"},null,512),[[Re,i.value.translation]])]),c("div",Fp,[m[24]||(m[24]=c("label",null,"Meaning",-1)),me(c("textarea",{"onUpdate:modelValue":m[7]||(m[7]=A=>i.value.meaning=A),rows:"2",placeholder:"Meaning"},null,512),[[Re,i.value.meaning]])]),c("div",Up,[m[25]||(m[25]=c("label",null,"Components",-1)),me(c("textarea",{"onUpdate:modelValue":m[8]||(m[8]=A=>i.value.components=A),rows:"2",placeholder:"Components"},null,512),[[Re,i.value.components]])]),c("div",Hp,[m[26]||(m[26]=c("label",null,"Examples",-1)),(b(!0),_(oe,null,_e(i.value.examples,(A,F)=>(b(),_("div",{key:F,class:"example-edit"},[me(c("input",{"onUpdate:modelValue":D=>A.zh=D,placeholder:"Chinese"},null,8,Kp),[[Re,A.zh]]),me(c("input",{"onUpdate:modelValue":D=>A.pinyin=D,placeholder:"Pinyin"},null,8,qp),[[Re,A.pinyin]]),me(c("input",{"onUpdate:modelValue":D=>A.en=D,placeholder:"English"},null,8,jp),[[Re,A.en]]),c("button",{class:"btn btn-small",onClick:D=>P(F)},"",8,zp)]))),128)),c("button",{class:"btn btn-small",onClick:$},"+ Add Example")]),c("div",Vp,[m[27]||(m[27]=c("label",null,"Memory Story",-1)),me(c("textarea",{"onUpdate:modelValue":m[9]||(m[9]=A=>i.value.memoryStory=A),rows:"2",placeholder:"Memory story"},null,512),[[Re,i.value.memoryStory]])]),c("div",Gp,[m[28]||(m[28]=c("label",null,"Image Prompt",-1)),me(c("textarea",{"onUpdate:modelValue":m[10]||(m[10]=A=>i.value.imagePrompt=A),rows:"2",placeholder:"Image prompt"},null,512),[[Re,i.value.imagePrompt]])])])]),actions:Rt(()=>[r.value?(b(),_(oe,{key:0},[c("button",{class:"btn",onClick:y},"Cancel"),c("button",{class:"btn btn-primary",onClick:x},"Save")],64)):(b(),_(oe,{key:1},[c("div",Wp,[c("button",{class:"btn btn-danger-text btn-small",onClick:m[11]||(m[11]=A=>C.$emit("delete"))},"Delete"),!e.isInCollection&&h.value?(b(),_("button",{key:0,class:"btn btn-primary btn-small",onClick:m[12]||(m[12]=A=>C.$emit("addToCollection"))}," + Add to My Cards ")):e.isInCollection&&!e.isNew?(b(),_("span",Jp," In collection")):K("",!0)]),c("div",Yp,[h.value?(b(),_("button",{key:0,class:"btn btn-small",onClick:R},"Edit")):K("",!0),e.showClose?(b(),_("button",{key:1,class:"btn btn-small",onClick:S}," Back")):K("",!0)])],64))]),_:1},8,["card","loading","show-close","can-edit","is-editing","initial-flipped","scroll-target-ref"]))}},Zp=De(Qp,[["__scopeId","data-v-b288539f"]]),Xp={class:"trivia-question"},eg={class:"back-header-question"},tg={class:"card-view-section"},ng={class:"trivia-answer"},sg={key:0,class:"card-view-section"},ig={key:1,class:"card-view-section"},rg={class:"related-words"},ag=["href","onClick"],lg={class:"related-zh"},og={class:"related-pinyin"},cg={class:"related-en"},ug={key:2,class:"card-view-section"},dg={__name:"TriviaCardView",props:{card:{type:Object,required:!0},initialFlipped:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},scrollTargetRef:{type:Object,default:null}},emits:["delete","close","navigate"],setup(e){return(t,n)=>(b(),Pe(so,{card:e.card,"show-close":e.showClose,"can-edit":!1,"initial-flipped":e.initialFlipped,"scroll-target-ref":e.scrollTargetRef,onDelete:n[0]||(n[0]=s=>t.$emit("delete")),onClose:n[1]||(n[1]=s=>t.$emit("close"))},{front:Rt(()=>[n[2]||(n[2]=c("div",{class:"trivia-label"},"Question",-1)),c("div",Xp,L(e.card.question),1)]),"back-header":Rt(()=>[c("span",eg,L(e.card.question),1)]),back:Rt(()=>{var s;return[c("section",tg,[n[3]||(n[3]=c("h4",null,"Answer",-1)),c("p",ng,[Ae(sn,{text:e.card.answer},null,8,["text"])])]),e.card.explanation?(b(),_("section",sg,[n[4]||(n[4]=c("h4",null,"Explanation",-1)),c("p",null,[Ae(sn,{text:e.card.explanation},null,8,["text"])])])):K("",!0),(s=e.card.relatedWords)!=null&&s.length?(b(),_("section",ig,[n[5]||(n[5]=c("h4",null,"Related Words",-1)),c("div",rg,[(b(!0),_(oe,null,_e(e.card.relatedWords,(i,r)=>(b(),_("a",{key:r,href:"?card="+encodeURIComponent(i.zh),class:"related-word",onClick:Me(a=>t.$emit("navigate",i.zh),["prevent"])},[c("span",lg,L(i.zh),1),c("span",og,L(i.pinyin),1),c("span",cg,L(i.en),1)],8,ag))),128))])])):K("",!0),e.card.memoryStory?(b(),_("section",ug,[n[6]||(n[6]=c("h4",null,"Memory Tip",-1)),c("p",null,[Ae(sn,{text:e.card.memoryStory},null,8,["text"])])])):K("",!0)]}),_:1},8,["card","show-close","initial-flipped","scroll-target-ref"]))}},fg=De(dg,[["__scopeId","data-v-dbca16a1"]]);function wa(e,t,n=""){const s=n?`
USER'S PERSONAL CONNECTION:
${n}
Use this to personalize the image prompt and examples where appropriate.
`:"";return`You are a Chinese language learning assistant creating a flashcard for: "${e}"

DICTIONARY DEFINITION:
${t||"Not found in dictionary"}
${s}
Generate a flashcard in markdown format with these sections:

#Front
${e} (pinyin with tone marks)

##Hint
A 3-6 word hint that suggests the meaning without giving it away

#Back
![Describe a vivid scene: one person experiencing the concept. Split composition - LEFT shows the concept, RIGHT shows the opposite/absence. No text. Under 50 words.](card://generate)

## Examples
- Chinese sentence (pinyin) - English translation
- Another example (pinyin) - Translation
- Third example (pinyin) - Translation

## Related
- word1 (pinyin) - meaning
- word2 (pinyin) - meaning
- word3 (pinyin) - meaning

## Meaning
Clear, comprehensive English definition.

Output only the markdown, no code fences or additional text.`}function hg(e,t=""){const n=t?`
USER'S PERSONAL CONNECTION:
${t}
Use this to personalize the content where appropriate.
`:"";return`You are a Chinese language learning assistant. The user entered: "${e}"
${n}
Analyze the input:
- If it's PINYIN: convert to characters and create a vocabulary card
- If it's a CHINESE PHRASE: create a phrase card
- If it's a QUESTION about Chinese: answer it and create a card for the key phrase

Generate a flashcard in markdown format:

#Front
The Chinese word/phrase (pinyin with tone marks)

##Hint
A 3-6 word hint or context for when to use this

#Back
![Describe a scene showing the concept or situation. One person in the scene. No text. Under 50 words.](card://generate)

## Examples
- Chinese sentence (pinyin) - English translation
- Another example (pinyin) - Translation

## Related
- word1 (pinyin) - meaning
- word2 (pinyin) - meaning

## Meaning
Clear explanation of the word/phrase, including context for usage.

Output only the markdown, no code fences or additional text.`}function ks(e){if(!e)return{front:"",back:"",hint:"",character:"",pinyin:""};const t=e.split(`
`);let n=null;const s={front:[],hint:[],back:[]};for(const u of t){const d=u.trim();if(d.match(/^#\s*Front\s*$/i)){n="front";continue}if(d.match(/^##\s*Hint\s*$/i)){n="hint";continue}if(d.match(/^#\s*Back\s*$/i)){n="back";continue}n&&s[n].push(u)}const i=s.front.join(`
`).trim(),r=s.hint.join(`
`).trim(),a=s.back.join(`
`).trim(),{character:l,pinyin:o}=pg(i);return{front:i,back:a,hint:r,character:l,pinyin:o}}function pg(e){if(!e)return{character:"",pinyin:""};const t=e.split(`
`)[0].trim(),n=t.match(/^([^\s(]+)\s*(?:\(([^)]+)\))?/);return n?{character:n[1]||"",pinyin:n[2]||""}:{character:t,pinyin:""}}function gg(e){return e==="card://generate"||e&&e.includes("/generate")}function ui(e,t=""){const n=t?` (${t})`:"";return`#Front
${e}${n}

##Hint


#Back

## Examples

## Related

## Meaning
`}const mg={class:"md-card-container"},vg={key:0,class:"md-card-face md-card-front"},yg={class:"md-card-character"},bg={key:0,class:"md-card-pinyin"},kg=["disabled"],wg={key:2,class:"md-card-hint"},xg={key:0,class:"hint-text"},Cg={key:1,class:"md-card-face md-card-back"},Sg={class:"md-card-back-header"},_g={class:"back-header-char"},$g={key:0,class:"back-header-pinyin"},Tg=["disabled"],Eg=["innerHTML"],Rg={key:2,class:"md-card-loading"},Ag={key:0,class:"md-card-personalize"},Pg={key:1,class:"md-card-stream-preview"},Mg={class:"stream-content"},Ig={key:2,class:"md-card-edit-panel"},Og={class:"md-card-actions"},Lg={class:"actions-left"},Ng={class:"actions-right"},Dg={__name:"MarkdownCardView",props:{card:{type:Object,required:!0},loading:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},streamingContent:{type:String,default:""}},emits:["save","delete","close","generate","update:card"],setup(e,{emit:t}){const n=e,s=t,{speak:i,isSpeaking:r,isSupported:a}=hr(),l=I(!1),o=I(!1),u=I(!1),d=I(""),h=I(null),p=I(""),f=ie(()=>{var m;const C=n.streamingContent||((m=n.card)==null?void 0:m.markdown)||"";return ks(C)}),k=ie(()=>{var C;return!!((C=n.card)!=null&&C.markdown&&n.card.markdown.trim())}),g=ie(()=>{if(!f.value.back)return"";const C=new ye.Renderer;return C.image=(m,A,F)=>gg(m)?`
        <div class="md-image-placeholder">
          <div class="image-prompt">${F||"No prompt"}</div>
          <button class="btn btn-small" onclick="this.dispatchEvent(new CustomEvent('generate-image', { bubbles: true, detail: { prompt: '${F==null?void 0:F.replace(/'/g,"\\'")}' } }))">
            Generate Image
          </button>
        </div>
      `:m&&m.startsWith("card://")?`<div class="md-image-placeholder"><span>Image: ${F}</span></div>`:`<img src="${m}" alt="${F}" title="${A||""}" />`,ye(f.value.back,{renderer:C,breaks:!0})});Ne(()=>n.card,()=>{l.value=!1,o.value=!1,u.value=!1,p.value=""},{deep:!0});function S(){l.value=!l.value}function R(){s("generate",p.value)}function y(){var C;d.value=((C=n.card)==null?void 0:C.markdown)||"",u.value=!0,$n(()=>{var m;(m=h.value)==null||m.focus()})}function x(){u.value=!1,d.value=""}function $(){s("save",{...n.card,markdown:d.value}),u.value=!1}async function P(C){var A;const m=(A=C.clipboardData)==null?void 0:A.items;if(m){for(const F of m)if(F.type.startsWith("image/")){C.preventDefault();const D=F.getAsFile();D&&console.log("Image paste detected:",D.name);break}}}return(C,m)=>(b(),_("div",mg,[c("div",{class:Se(["md-card",{"is-back":l.value}])},[l.value?(b(),_("div",Cg,[c("div",Sg,[c("span",_g,L(f.value.character),1),f.value.pinyin?(b(),_("span",$g,L(f.value.pinyin),1)):K("",!0),G(a)&&f.value.character?(b(),_("button",{key:1,class:"speak-btn",onClick:m[2]||(m[2]=Me(A=>G(i)(f.value.character),["stop"])),disabled:G(r),title:"Listen"},[...m[8]||(m[8]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"})],-1)])],8,Tg)):K("",!0)]),c("div",{class:"md-card-content",innerHTML:g.value},null,8,Eg)])):(b(),_("div",vg,[c("div",yg,L(f.value.character),1),f.value.pinyin?(b(),_("div",bg,L(f.value.pinyin),1)):K("",!0),G(a)&&f.value.character?(b(),_("button",{key:1,class:"speak-btn speak-btn-inline",onClick:m[0]||(m[0]=Me(A=>G(i)(f.value.character),["stop"])),disabled:G(r),title:"Listen"},[...m[7]||(m[7]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"})],-1)])],8,kg)):K("",!0),f.value.hint?(b(),_("div",wg,[c("button",{class:"reveal-btn",onClick:m[1]||(m[1]=Me(A=>o.value=!o.value,["stop"]))},L(o.value?"Hide hint":"Show hint"),1),o.value?(b(),_("div",xg,L(f.value.hint),1)):K("",!0)])):K("",!0)])),e.loading?(b(),_("div",Rg,[m[9]||(m[9]=c("span",{class:"spinner"},null,-1)),nt(" "+L(e.streamingContent?"Generating...":"Loading..."),1)])):K("",!0)],2),!k.value&&!e.loading&&!u.value?(b(),_("div",Ag,[m[10]||(m[10]=c("div",{class:"personalize-header"},[c("h4",null,"Make it personal"),c("span",{class:"personalize-hint"},"(optional, but helps it stick)")],-1)),me(c("textarea",{"onUpdate:modelValue":m[3]||(m[3]=A=>p.value=A),class:"personalize-input",placeholder:"What does this word mean to you? A memory, a situation, anything personal...",rows:"2"},null,512),[[Re,p.value]])])):K("",!0),e.streamingContent&&e.loading?(b(),_("div",Pg,[m[11]||(m[11]=c("div",{class:"stream-label"},"Preview:",-1)),c("pre",Mg,L(e.streamingContent),1)])):K("",!0),u.value?(b(),_("div",Ig,[c("div",{class:"edit-panel-header"},[m[12]||(m[12]=c("h4",null,"Edit Card",-1)),c("div",{class:"edit-panel-actions"},[c("button",{class:"btn btn-small",onClick:x},"Cancel"),c("button",{class:"btn btn-small btn-primary",onClick:$},"Save")])]),me(c("textarea",{ref_key:"editorRef",ref:h,"onUpdate:modelValue":m[4]||(m[4]=A=>d.value=A),class:"md-editor",onPaste:P,placeholder:"Enter markdown content..."},null,544),[[Re,d.value]])])):K("",!0),c("div",Og,[c("div",Lg,[c("button",{class:"btn btn-danger-text btn-small",onClick:m[5]||(m[5]=A=>C.$emit("delete"))},"Delete")]),c("div",Ng,[c("button",{class:"btn btn-small",onClick:S},L(l.value?"Front":"Back"),1),!u.value&&k.value?(b(),_("button",{key:0,class:"btn btn-small",onClick:y}," Edit ")):K("",!0),!k.value&&!e.loading?(b(),_("button",{key:1,class:"btn btn-small btn-primary",onClick:R}," Generate ")):K("",!0),e.showClose?(b(),_("button",{key:2,class:"btn btn-small",onClick:m[6]||(m[6]=A=>C.$emit("close"))}," Back ")):K("",!0)])])]))}},Bg=De(Dg,[["__scopeId","data-v-3fead231"]]),lo="flashcards_saved_cards";function oo(){return Date.now().toString(36)+Math.random().toString(36).slice(2)}function Nt(){const e=localStorage.getItem(lo);if(!e)return[];try{return JSON.parse(e).sort((n,s)=>{const i=n.type==="trivia"?1:0,r=s.type==="trivia"?1:0;return i-r})}catch{return[]}}function pr(e){localStorage.setItem(lo,JSON.stringify(e))}function Yn(e){const t=e.type||"vocabulary",n={id:e.id||oo(),created:e.created||new Date().toISOString(),type:t,tags:e.tags||["user"]};return t==="markdown"?{...n,character:e.character||"",pinyin:e.pinyin||"",markdown:e.markdown||""}:t==="trivia"?{...n,question:e.question||"",answer:e.answer||"",explanation:e.explanation||"",relatedWords:e.relatedWords||[],memoryStory:e.memoryStory||""}:{...n,character:e.character||"",pinyin:e.pinyin||"",microClue:e.microClue||"",imageUrl:e.imageUrl||null,translation:e.translation||"",meaning:e.meaning||"",components:e.components||"",examples:e.examples||[],relatedWords:e.relatedWords||[],memoryStory:e.memoryStory||"",imagePrompt:e.imagePrompt||"",rawDictEntry:e.rawDictEntry||"",rawIdsEntry:e.rawIdsEntry||""}}function jn(e){return Yn({...e,type:"markdown"})}function ln(e){const t=Nt(),n=t.findIndex(s=>s.id===e.id);return n>=0?t[n]={...t[n],...e}:(e.id||(e.id=oo()),e.created||(e.created=new Date().toISOString()),t.push(e)),pr(t),e}function Fg(e){const n=Nt().filter(s=>s.id!==e);pr(n),rh(e).catch(()=>{})}function gr(e,t){const n=Nt();if(!t)return n.find(i=>i.character===e)||null;const s=Es(t);return n.find(i=>i.character===e&&Es(i.pinyin)===s)||null}function Ug(e){const t=gr(e.character,e.pinyin);if(t)return{success:!1,reason:"exists",card:t};const n=Yn({...e,id:void 0,created:void 0,tags:[...e.tags||[],"user"]});return ln(n),{success:!0,card:n}}function Hg(){const e=Nt(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.download=`flashcards-backup-${new Date().toISOString().slice(0,10)}.json`,s.click(),URL.revokeObjectURL(n)}function Kg(e){try{const t=JSON.parse(e);if(!Array.isArray(t))throw new Error("Invalid format: expected array");const n=Nt(),s=new Set(n.map(r=>r.id));let i=0;for(const r of t)s.has(r.id)||(n.push(r),i++);return pr(n),{added:i,total:n.length}}catch(t){throw new Error("Failed to import: "+t.message)}}const qg={class:"modal"},jg={class:"editor-field"},zg={class:"provider-row"},Vg={class:"editor-field"},Gg={style:{display:"flex",gap:"8px"}},Wg={class:"btn btn-small",style:{cursor:"pointer"}},Jg={key:0,class:"text-muted",style:{"margin-top":"8px","font-size":"0.85rem"}},Yg={class:"modal-actions"},Qg={__name:"Settings",emits:["close","saved"],setup(e,{emit:t}){const n=t,{refresh:s}=on(),i=I(!1),r=I("");function a(h){h.key==="Escape"&&(i.value?i.value=!1:n("close"),h.stopPropagation())}Qe(()=>{document.addEventListener("keydown",a)}),xt(()=>{document.removeEventListener("keydown",a)});async function l(){try{await s()}catch{}n("saved")}async function o(){try{await s()}catch{}n("saved")}function u(){Hg()}async function d(h){const p=h.target.files[0];if(p){try{const f=await p.text(),k=Kg(f);r.value=`Imported ${k.added} new cards (${k.total} total)`,n("saved")}catch(f){r.value="Import failed: "+f.message}h.target.value=""}}return(h,p)=>(b(),_(oe,null,[c("div",{class:"modal-overlay",onClick:p[3]||(p[3]=Me(f=>h.$emit("close"),["self"]))},[c("div",qg,[p[8]||(p[8]=c("h2",null,"Settings",-1)),c("div",jg,[p[5]||(p[5]=c("label",null,"LLM Provider",-1)),c("div",zg,[Ae(G(cd),{onChanged:l,onOpenConfig:p[0]||(p[0]=f=>i.value=!0)}),c("button",{class:"btn btn-small",onClick:p[1]||(p[1]=f=>i.value=!0)},"Configure")])]),p[9]||(p[9]=c("hr",{style:{margin:"20px 0",border:"none","border-top":"1px solid var(--border)"}},null,-1)),c("div",Vg,[p[7]||(p[7]=c("label",null,"Data Management",-1)),c("div",Gg,[c("button",{class:"btn btn-small",onClick:u},"Export Cards"),c("label",Wg,[p[6]||(p[6]=nt(" Import Cards ",-1)),c("input",{type:"file",accept:".json",onChange:d,style:{display:"none"}},null,32)])]),r.value?(b(),_("p",Jg,L(r.value),1)):K("",!0)]),c("div",Yg,[c("button",{class:"btn btn-primary",onClick:p[2]||(p[2]=f=>h.$emit("close"))},"Done")])])]),(b(),Pe(Ji,{to:"body"},[Ae(G(ql),{"is-visible":i.value,onClose:p[4]||(p[4]=f=>i.value=!1),onConfigChanged:o},null,8,["is-visible"])]))],64))}},Zg=De(Qg,[["__scopeId","data-v-915df4cf"]]),mr=[1,2],di=new Map;let Bt=null;function co(){return mr}async function Ws(e){if(!mr.includes(e))throw new Error(`HSK ${e} deck not available`);if(di.has(e))return xa(di.get(e));try{const t=await fetch(`./hsk/hsk${e}.json`);if(!t.ok)throw new Error(`Failed to load HSK ${e}: ${t.status}`);const n=await t.json();for(const s of n)s.tags||(s.tags=[]),s.tags.includes(`hsk${e}`)||s.tags.push(`hsk${e}`);return di.set(e,n),xa(n)}catch(t){throw console.error(`Error loading HSK ${e}:`,t),t}}function xa(e){const t=Nt(),n=new Map(t.map(s=>[s.id,s]));return e.map(s=>n.get(s.id)||s)}async function Xg(){if(Bt)return Bt;Bt=new Map;for(const e of mr)try{const t=await Ws(e);for(const n of t){const s=n.character;Bt.has(s)||Bt.set(s,[]),Bt.get(s).push({level:e,id:n.id,card:n})}}catch{}return Bt}async function Ii(e){return await Xg(),Bt.get(e)||null}async function em(e){const t=await Ii(e);return!t||t.length===0?null:{level:t.sort((s,i)=>s.level-i.level)[0].level}}async function tm(e){const t=await Ws(e);return{level:e,totalCards:t.length}}const nm={class:"deck-browser"},sm={key:0,class:"deck-section"},im={class:"deck-grid"},rm={class:"deck-tile-count"},am={class:"deck-tile-count"},lm={class:"deck-tile-count"},om={class:"deck-section"},cm={class:"deck-grid"},um=["onClick"],dm={class:"deck-tile-badge"},fm={key:0,class:"deck-tile-count"},hm={key:1,class:"deck-tile-count loading-text"},pm={class:"deck-tile-badge"},gm={class:"deck-section"},mm={class:"games-grid"},vm={class:"deck-section"},ym={class:"games-grid"},bm={key:1,class:"empty-hint"},km={__name:"DeckBrowser",props:{userCards:{type:Array,default:()=>[]}},emits:["openDeck","openCard","openGames","openReader"],setup(e,{emit:t}){const n=e,s=t,i=I([]),r=I({}),a=I(new Set),l=ie(()=>n.userCards.filter(p=>p.type!=="trivia")),o=ie(()=>l.value),u=ie(()=>n.userCards.filter(p=>p.type==="trivia")),d=ie(()=>{const p=new Set(i.value);return[3,4,5,6].filter(f=>!p.has(f))});Qe(async()=>{i.value=co();for(const p of i.value){a.value.add(p);try{const f=await tm(p);r.value[p]=f}catch(f){console.error(`Failed to load HSK ${p} stats:`,f)}finally{a.value.delete(p)}}});function h(p){a.value.has(p)||s("openDeck",{type:"hsk",level:p})}return(p,f)=>(b(),_("div",nm,[o.value.length>0||u.value.length>0?(b(),_("section",sm,[f[8]||(f[8]=c("h2",{class:"section-title"},"Your Cards",-1)),c("div",im,[o.value.length>0?(b(),_("div",{key:0,class:"deck-tile",onClick:f[0]||(f[0]=k=>p.$emit("openDeck",{type:"user",filter:"vocabulary"}))},[f[5]||(f[5]=c("div",{class:"deck-tile-title"},"Words",-1)),c("div",rm,L(o.value.length),1)])):K("",!0),u.value.length>0?(b(),_("div",{key:1,class:"deck-tile",onClick:f[1]||(f[1]=k=>p.$emit("openDeck",{type:"user",filter:"trivia"}))},[f[6]||(f[6]=c("div",{class:"deck-tile-title"},"Questions",-1)),c("div",am,L(u.value.length),1)])):K("",!0),o.value.length>0||u.value.length>0?(b(),_("div",{key:2,class:"deck-tile deck-tile-all",onClick:f[2]||(f[2]=k=>p.$emit("openDeck",{type:"user",filter:"all"}))},[f[7]||(f[7]=c("div",{class:"deck-tile-title"},"All",-1)),c("div",lm,L(o.value.length+u.value.length),1)])):K("",!0)])])):K("",!0),c("section",om,[f[10]||(f[10]=c("h2",{class:"section-title"},"HSK Decks",-1)),c("div",cm,[(b(!0),_(oe,null,_e(i.value,k=>(b(),_("div",{key:k,class:Se(["deck-tile deck-tile-hsk",{loading:a.value.has(k)}]),onClick:g=>h(k)},[c("div",dm,"HSK "+L(k),1),r.value[k]?(b(),_("div",fm,L(r.value[k].totalCards)+" cards ",1)):(b(),_("div",hm," Loading... "))],10,um))),128)),(b(!0),_(oe,null,_e(d.value,k=>(b(),_("div",{key:"soon-"+k,class:"deck-tile deck-tile-hsk deck-tile-disabled"},[c("div",pm,"HSK "+L(k),1),f[9]||(f[9]=c("div",{class:"deck-tile-count"},"Coming soon",-1))]))),128))])]),c("section",gm,[f[13]||(f[13]=c("h2",{class:"section-title"},"Games",-1)),c("div",mm,[c("div",{class:"game-tile",onClick:f[3]||(f[3]=k=>p.$emit("openGames"))},[...f[11]||(f[11]=[ii('<div class="game-tile-icon" data-v-6d730466><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6d730466><rect x="3" y="3" width="7" height="7" rx="1" data-v-6d730466></rect><rect x="14" y="3" width="7" height="7" rx="1" data-v-6d730466></rect><rect x="3" y="14" width="7" height="7" rx="1" data-v-6d730466></rect><rect x="14" y="14" width="7" height="7" rx="1" data-v-6d730466></rect><path d="M10 6.5h4M10 17.5h4" stroke-dasharray="2 2" data-v-6d730466></path></svg></div><div class="game-tile-title" data-v-6d730466>Flash Match</div><div class="game-tile-desc" data-v-6d730466>Match characters with pinyin or English meanings. Race against the clock!</div>',3)])]),f[12]||(f[12]=ii('<div class="game-tile game-tile-disabled" data-v-6d730466><div class="game-tile-icon" data-v-6d730466><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6d730466><rect x="4" y="4" width="16" height="16" rx="2" data-v-6d730466></rect><path d="M9 9h6M9 12h6M9 15h3" data-v-6d730466></path></svg></div><div class="game-tile-title" data-v-6d730466>Type It</div><div class="game-tile-desc" data-v-6d730466>Type the pinyin for displayed characters</div></div><div class="game-tile game-tile-disabled" data-v-6d730466><div class="game-tile-icon" data-v-6d730466><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6d730466><circle cx="12" cy="12" r="10" data-v-6d730466></circle><path d="M12 6v6l4 2" data-v-6d730466></path></svg></div><div class="game-tile-title" data-v-6d730466>Flash Cards</div><div class="game-tile-desc" data-v-6d730466>Classic flashcard review with spaced repetition</div></div><div class="game-tile game-tile-disabled" data-v-6d730466><div class="game-tile-icon" data-v-6d730466><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6d730466><path d="M9 11l3 3 8-8" data-v-6d730466></path><path d="M20 12v6a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h9" data-v-6d730466></path></svg></div><div class="game-tile-title" data-v-6d730466>Multiple Choice</div><div class="game-tile-desc" data-v-6d730466>Choose the correct meaning from four options</div></div>',3))])]),c("section",vm,[f[15]||(f[15]=c("h2",{class:"section-title"},"Reader",-1)),c("div",ym,[c("div",{class:"game-tile",onClick:f[4]||(f[4]=k=>p.$emit("openReader"))},[...f[14]||(f[14]=[ii('<div class="game-tile-icon" data-v-6d730466><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6d730466><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" data-v-6d730466></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" data-v-6d730466></path></svg></div><div class="game-tile-title" data-v-6d730466>Reader</div><div class="game-tile-desc" data-v-6d730466>Paste any text and read it at your level with word-by-word translations</div>',3)])])])]),o.value.length===0&&u.value.length===0?(b(),_("div",bm,[...f[16]||(f[16]=[c("p",null,"Search for a word above to create your first flashcard",-1),c("p",{class:"text-muted"},"Or browse the HSK decks to get started",-1)])])):K("",!0)]))}},wm=De(km,[["__scopeId","data-v-6d730466"]]),xm={class:"deck-view"},Cm={class:"deck-view-header"},Sm={class:"deck-view-title"},_m={class:"deck-view-grid"},$m=["onClick"],Tm={class:"card-item-question"},Em={class:"card-item-char"},Rm={class:"card-item-pinyin"},Am={key:0,class:"deck-view-more"},Pm={__name:"DeckView",props:{title:{type:String,default:"Cards"},cards:{type:Array,required:!0},pageSize:{type:Number,default:500}},emits:["back","selectCard"],setup(e,{emit:t}){const n=e,s=t,i=I(n.pageSize),r=I([...n.cards]),a=I(!1);Ne(()=>n.cards,k=>{r.value=[...k],i.value=n.pageSize,a.value=!1},{immediate:!0});const l=ie(()=>r.value.slice(0,i.value)),o=ie(()=>i.value<r.value.length),u=ie(()=>r.value.length-i.value);function d(){i.value+=n.pageSize}function h(){const k=[...r.value];for(let g=k.length-1;g>0;g--){const S=Math.floor(Math.random()*(g+1));[k[g],k[S]]=[k[S],k[g]]}r.value=k,i.value=n.pageSize,a.value=!0}function p(k){if(a.value){const g=r.value.map(S=>n.cards.findIndex(R=>R.id===S.id));s("selectCard",k,g)}else s("selectCard",k,null)}function f(k,g){return k?k.length>g?k.slice(0,g)+"...":k:""}return(k,g)=>(b(),_("div",xm,[c("div",Cm,[c("button",{class:"btn btn-small",onClick:g[0]||(g[0]=S=>k.$emit("back"))}," Back"),c("h2",Sm,L(e.title),1),c("div",{class:"deck-view-actions"},[c("button",{class:"btn btn-small",onClick:h},"Shuffle")])]),c("div",_m,[(b(!0),_(oe,null,_e(l.value,S=>(b(),_("div",{key:S.id,class:Se(["deck-card-item",{"trivia-item":S.type==="trivia"}]),onClick:R=>p(S)},[S.type==="trivia"?(b(),_(oe,{key:0},[g[1]||(g[1]=c("span",{class:"card-item-label"},"Q:",-1)),c("span",Tm,L(f(S.question,30)),1)],64)):(b(),_(oe,{key:1},[c("span",Em,L(S.character),1),c("span",Rm,L(S.pinyin),1)],64))],10,$m))),128))]),o.value?(b(),_("div",Am,[c("button",{class:"btn",onClick:d},"Load more ("+L(u.value)+" remaining)",1)])):K("",!0)]))}},Mm=De(Pm,[["__scopeId","data-v-c6ff3304"]]);function uo(){const e=[],t=co();for(const i of t)e.push({id:`hsk${i}`,label:`HSK ${i}`,type:"hsk"});return Nt().filter(i=>i.type!=="trivia").length>0&&e.push({id:"user",label:"My Cards",type:"user"}),e}async function Im(e){return(await fo([e])).length}async function fo(e){const t=[],n=new Set;for(const s of e){let i=[];const r=s.match(/^hsk(\d)$/i);if(r){const a=parseInt(r[1]);try{i=await Ws(a)}catch{continue}}s==="user"&&(i=Nt());for(const a of i)a.type!=="trivia"&&(!a.character||!a.pinyin||n.has(a.id)||(n.add(a.id),t.push(a)))}return t}async function Om(e){const t=await fo(e);return(await Promise.all(t.map(async s=>{if(s.translation)return{id:s.id,character:s.character,pinyin:s.pinyin,english:Ca(s.translation),originalCard:s};const i=await ht(s.character);if(i.cedict&&i.cedict.length>0){const r=Sn(i.cedict[0].definitions,3);return{id:s.id,character:s.character,pinyin:s.pinyin,english:Ca(r),originalCard:s}}return null}))).filter(s=>s!==null)}function Ca(e){if(!e)return"";const t=e.split(";")[0].trim();return t.length<=50?t:t.slice(0,47)+"..."}function Sa(e){const t=[...e];for(let n=t.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[t[n],t[s]]=[t[s],t[n]]}return t}const ho="flash-match-stats",po="flash-match-settings",Lm=30;function _a(){return{audioEnabled:!0,defaultTimeLimit:60,defaultMode:"hanzi-pinyin",recentSessions:[]}}function Js(){try{const e=localStorage.getItem(po);if(e)return{..._a(),...JSON.parse(e)}}catch{}return _a()}function go(e){const n={...Js(),...e};localStorage.setItem(po,JSON.stringify(n))}function Nm(e){const t=Js(),n=t.recentSessions||[],s=`${e.tags.sort().join(",")}-${e.mode}-${e.hidePinyin}`,i=n.filter(r=>`${r.tags.sort().join(",")}-${r.mode}-${r.hidePinyin}`!==s);i.unshift({...e,lastPlayed:new Date().toISOString()}),t.recentSessions=i.slice(0,5),go(t)}function mo(){try{const e=localStorage.getItem(ho);if(e)return JSON.parse(e)}catch{}return{scores:[],problemCards:{}}}function Dm(e){localStorage.setItem(ho,JSON.stringify(e))}function Bm(e){const t=mo(),n={mode:e.mode,tags:e.tags.sort(),hidePinyin:e.hidePinyin||!1,timeLimit:e.timeLimit,correct:e.correct,incorrect:e.incorrect,accuracy:e.correct/Math.max(1,e.correct+e.incorrect),date:new Date().toISOString()};t.scores.push(n),t.scores.length>100&&(t.scores=t.scores.slice(-100));const s=new Date().toISOString();for(const i of e.matchHistory)i.wasCorrect||(t.problemCards[i.cardId]||(t.problemCards[i.cardId]={character:i.character,misses:0,lastMiss:null}),t.problemCards[i.cardId].misses++,t.problemCards[i.cardId].lastMiss=s);return Fm(t),Dm(t),Nm({tags:e.tags,mode:e.mode,hidePinyin:e.hidePinyin,timeLimit:e.timeLimit}),n}function Fm(e){const t=Date.now()-Lm*24*60*60*1e3;for(const[n,s]of Object.entries(e.problemCards))s.lastMiss&&new Date(s.lastMiss).getTime()<t&&delete e.problemCards[n]}function Um(e,t,n=!1){const s=mo(),i=t.sort().join(","),r=s.scores.filter(a=>a.mode===e&&a.tags.join(",")===i&&(a.hidePinyin||!1)===n);return r.length===0?null:r.reduce((a,l)=>l.accuracy>a.accuracy||l.accuracy===a.accuracy&&l.correct>a.correct?l:a)}const Hm={class:"flash-match-setup"},Km={class:"setup-header"},qm={class:"setup-header-actions"},jm=["disabled"],zm={class:"setup-section"},Vm={class:"mode-options"},Gm={key:0,class:"checkbox-option"},Wm={class:"setup-section"},Jm={class:"tag-grid"},Ym=["value","disabled"],Qm={class:"tag-label"},Zm={class:"tag-count"},Xm={key:0,class:"total-cards"},ev={key:1,class:"warning-text"},tv={class:"setup-section"},nv={class:"time-options"},sv=["value"],iv={key:0,class:"setup-section"},rv={class:"recent-sessions"},av=["onClick"],lv={class:"session-tags"},ov={class:"session-mode"},cv={key:1,class:"error-text"},uv={__name:"FlashMatchSetup",emits:["start","back"],setup(e,{emit:t}){const n=t,s=I("hanzi-pinyin"),i=I(!1),r=I([]),a=I(90),l=I(null),o=I([]),u=I({}),d=I([]),h=[30,60,90,120],p=ie(()=>r.value.reduce((y,x)=>y+(u.value[x]||0),0)),f=ie(()=>r.value.length>0&&p.value>=10);Qe(async()=>{o.value=uo();for(const x of o.value)u.value[x.id]=await Im(x.id);const y=Js();if(s.value=y.defaultMode||"hanzi-pinyin",d.value=y.recentSessions||[],o.value.length>0&&r.value.length===0){const x=o.value.find($=>u.value[$.id]>0);x&&(r.value=[x.id])}}),Ne(s,y=>{y==="hanzi-pinyin"&&(i.value=!1)});function k(y){r.value=[...y.tags],s.value=y.mode,i.value=y.hidePinyin||!1,a.value=y.timeLimit||60}function g(y){return y.map(x=>{const $=o.value.find(P=>P.id===x);return $?$.label:x}).join(", ")}function S(y,x){return y==="hanzi-pinyin"?"Hanzi  Pinyin":x?"Hanzi  English (no pinyin)":"Hanzi+Pinyin  English"}function R(){f.value&&(l.value=null,n("start",{mode:s.value,hidePinyin:i.value,tags:r.value,timeLimit:a.value}))}return(y,x)=>(b(),_("div",Hm,[c("div",Km,[c("button",{class:"btn btn-small",onClick:x[0]||(x[0]=$=>y.$emit("back"))}," Back"),x[6]||(x[6]=c("h2",{class:"setup-header-title"},"Flash Match",-1)),c("div",qm,[c("button",{class:"btn btn-primary",onClick:R,disabled:!f.value}," Start Game ",8,jm)])]),c("section",zm,[x[12]||(x[12]=c("h3",null,"Mode",-1)),c("div",Vm,[c("label",{class:Se(["mode-option",{active:s.value==="hanzi-pinyin"}])},[me(c("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=$=>s.value=$),value:"hanzi-pinyin"},null,512),[[bs,s.value]]),x[7]||(x[7]=c("span",{class:"mode-label"},"Hanzi to Pinyin",-1)),x[8]||(x[8]=c("span",{class:"mode-hint"},"Match characters with pronunciation",-1))],2),c("label",{class:Se(["mode-option",{active:s.value==="hanzi-english"}])},[me(c("input",{type:"radio","onUpdate:modelValue":x[2]||(x[2]=$=>s.value=$),value:"hanzi-english"},null,512),[[bs,s.value]]),x[9]||(x[9]=c("span",{class:"mode-label"},"Hanzi to English",-1)),x[10]||(x[10]=c("span",{class:"mode-hint"},"Match characters with meaning",-1))],2)]),s.value==="hanzi-english"?(b(),_("label",Gm,[me(c("input",{type:"checkbox","onUpdate:modelValue":x[3]||(x[3]=$=>i.value=$)},null,512),[[Ts,i.value]]),x[11]||(x[11]=c("span",null,"Hide pinyin (harder)",-1))])):K("",!0)]),c("section",Wm,[x[13]||(x[13]=c("h3",null,"Card Sources",-1)),x[14]||(x[14]=c("p",{class:"section-hint"},"Select which decks to practice",-1)),c("div",Jm,[(b(!0),_(oe,null,_e(o.value,$=>(b(),_("label",{key:$.id,class:Se(["tag-option",{active:r.value.includes($.id),disabled:u.value[$.id]===0}])},[me(c("input",{type:"checkbox",value:$.id,"onUpdate:modelValue":x[4]||(x[4]=P=>r.value=P),disabled:u.value[$.id]===0},null,8,Ym),[[Ts,r.value]]),c("span",Qm,L($.label),1),c("span",Zm,L(u.value[$.id]??"...")+" cards",1)],2))),128))]),p.value>0?(b(),_("p",Xm," Total: "+L(p.value)+" cards selected ",1)):K("",!0),p.value>0&&p.value<10?(b(),_("p",ev," Need at least 10 cards to play ")):K("",!0)]),c("section",tv,[x[15]||(x[15]=c("h3",null,"Time Limit",-1)),c("div",nv,[(b(),_(oe,null,_e(h,$=>c("label",{key:$,class:Se(["time-option",{active:a.value===$}])},[me(c("input",{type:"radio","onUpdate:modelValue":x[5]||(x[5]=P=>a.value=P),value:$},null,8,sv),[[bs,a.value]]),c("span",null,L($)+"s",1)],2)),64))])]),d.value.length>0?(b(),_("section",iv,[x[16]||(x[16]=c("h3",null,"Recent",-1)),c("div",rv,[(b(!0),_(oe,null,_e(d.value,($,P)=>(b(),_("button",{key:P,class:"recent-session",onClick:C=>k($)},[c("span",lv,L(g($.tags)),1),c("span",ov,L(S($.mode,$.hidePinyin)),1)],8,av))),128))])])):K("",!0),l.value?(b(),_("p",cv,L(l.value),1)):K("",!0)]))}},dv=De(uv,[["__scopeId","data-v-ccdf844f"]]),fv={class:"flash-match-game"},hv={class:"game-header"},pv={class:"game-score"},gv={class:"score-correct"},mv={class:"score-total"},vv={key:0,class:"audio-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},yv={key:1,class:"audio-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},bv={class:"mode-indicator"},kv={key:0,class:"combo-indicator"},wv={class:"game-board"},xv={class:"game-column left-column"},Cv=["onClick"],Sv={class:"slot-character"},_v={key:0,class:"slot-pinyin"},$v={class:"slot-character slot-faded"},Tv={key:0,class:"slot-pinyin slot-faded"},Ev={key:2,class:"slot-empty-placeholder"},Rv={class:"game-column right-column"},Av=["onClick"],Pv={key:0,class:"slot-text"},Mv={key:1,class:"slot-text slot-faded"},Iv={key:2,class:"slot-empty-placeholder"},Ov={key:0,class:"wrong-feedback"},Lv={key:1,class:"start-overlay"},Nv={class:"start-content"},Dv={__name:"FlashMatchGame",props:{game:{type:Object,required:!0}},emits:["quit","finished"],setup(e,{emit:t}){const n=e,s=t,{speak:i}=hr(),r=I(!1),a=I(!1),l=ie(()=>n.game.mode.value==="hanzi-pinyin"?"Match Hanzi with Pinyin":n.game.hidePinyin.value?"Match Hanzi with English":"Match Hanzi + Pinyin with English"),o=ie(()=>n.game.mode.value==="hanzi-english"&&!n.game.hidePinyin.value);Ne(()=>n.game.status.value,S=>{S==="finished"&&s("finished")}),Ne(()=>n.game.incorrect.value,(S,R)=>{S>R&&(a.value=!0,setTimeout(()=>{a.value=!1},1e3))});function u(S){const R=Math.floor(S/60),y=S%60;return`${R}:${y.toString().padStart(2,"0")}`}function d(){r.value=!0,n.game.startGame()}function h(S,R){r.value&&(!R||R.state!=="active"||(n.game.audioEnabled.value&&i(R.card.character),n.game.selectLeft(S)))}function p(S,R){if(!r.value)return;const y=n.game.slots.value[R];!y||y.state!=="active"||n.game.selectRight(S)}function f(S,R,y,x=null){const $=[];return!R||R.state==="empty"?$.push("slot-empty-state"):R.state==="cooldown"?$.push("slot-cooldown"):R.state==="active"&&(y==="left"&&n.game.selectedLeft.value===S||y==="right"&&n.game.selectedRight.value===x)&&$.push("slot-selected"),$}function k(){n.game.audioEnabled.value=!n.game.audioEnabled.value,n.game.persistSettings()}function g(){if(r.value&&n.game.status.value==="playing"){if(!confirm("Quit the current game? Your progress will be lost."))return;n.game.endGame()}s("quit")}return xt(()=>{n.game.status.value==="playing"&&n.game.endGame()}),(S,R)=>(b(),_("div",fv,[c("div",hv,[c("button",{class:"btn btn-small",onClick:g},"Quit"),c("div",{class:Se(["game-timer",{"low-time":e.game.isLowTime.value}])},L(u(e.game.timeRemainingSeconds.value)),3),c("div",pv,[c("span",gv,L(e.game.correct.value),1),R[0]||(R[0]=c("span",{class:"score-separator"},"/",-1)),c("span",mv,L(e.game.totalAttempts.value),1)]),c("button",{class:Se(["btn btn-small audio-toggle",{active:e.game.audioEnabled.value}]),onClick:k,title:"Toggle pronunciation audio"},[e.game.audioEnabled.value?(b(),_("svg",vv,[...R[1]||(R[1]=[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"},null,-1),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"},null,-1),c("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14"},null,-1)])])):(b(),_("svg",yv,[...R[2]||(R[2]=[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"},null,-1),c("line",{x1:"23",y1:"9",x2:"17",y2:"15"},null,-1),c("line",{x1:"17",y1:"9",x2:"23",y2:"15"},null,-1)])]))],2)]),c("div",bv,[nt(L(l.value)+" ",1),n.game.comboCount.value>0?(b(),_("span",kv,L(n.game.comboCount.value)+"x combo ",1)):K("",!0)]),c("div",wv,[c("div",xv,[(b(!0),_(oe,null,_e(e.game.slots.value,(y,x)=>(b(),_("div",{key:"left-"+x,class:Se(["game-slot",f(x,y,"left")]),onClick:$=>h(x,y)},[y&&y.state==="active"?(b(),_(oe,{key:0},[c("span",Sv,L(y.card.character),1),o.value?(b(),_("span",_v,L(y.card.pinyin),1)):K("",!0)],64)):y&&y.state==="cooldown"?(b(),_(oe,{key:1},[c("span",$v,L(y.card.character),1),o.value?(b(),_("span",Tv,L(y.card.pinyin),1)):K("",!0)],64)):(b(),_("span",Ev,""))],10,Cv))),128))]),c("div",Rv,[(b(!0),_(oe,null,_e(e.game.rightColumnOrder.value,(y,x)=>(b(),_("div",{key:"right-"+x,class:Se(["game-slot",f(y,e.game.slots.value[y],"right",x)]),onClick:$=>p(x,y)},[e.game.slots.value[y]&&e.game.slots.value[y].state==="active"?(b(),_("span",Pv,L(e.game.getRightDisplayText(e.game.slots.value[y].card)),1)):e.game.slots.value[y]&&e.game.slots.value[y].state==="cooldown"?(b(),_("span",Mv,L(e.game.getRightDisplayText(e.game.slots.value[y].card)),1)):(b(),_("span",Iv,""))],10,Av))),128))])]),a.value?(b(),_("div",Ov," -3 seconds! ")):K("",!0),r.value?K("",!0):(b(),_("div",Lv,[c("div",Nv,[R[3]||(R[3]=c("h3",null,"Ready?",-1)),c("p",null,"Match the "+L(e.game.mode.value==="hanzi-pinyin"?"characters with pinyin":"characters with meanings"),1),c("button",{class:"btn btn-primary btn-large",onClick:d}," Start ")])]))]))}},Bv=De(Dv,[["__scopeId","data-v-5944f03d"]]),Fv={class:"flash-match-results"},Uv={class:"results-summary"},Hv={class:"result-stat result-accuracy"},Kv={class:"stat-value"},qv={class:"result-stat"},jv={class:"stat-value stat-correct"},zv={class:"result-stat"},Vv={class:"stat-value stat-incorrect"},Gv={key:0,class:"best-score-comparison"},Wv={key:0,class:"new-best-badge"},Jv={key:1,class:"best-label"},Yv={key:1,class:"results-section"},Qv={class:"problem-words"},Zv=["href","onClick"],Xv={class:"problem-char"},ey={class:"problem-count"},ty={class:"game-config"},ny={class:"results-actions"},sy={__name:"FlashMatchResults",props:{game:{type:Object,required:!0}},emits:["back","setup","playAgain","navigateToCard"],setup(e,{emit:t}){const n=e,s=t,i=I(null),r=I([]),a=ie(()=>Math.round(n.game.accuracy.value*100)),l=ie(()=>i.value?Math.round(i.value.accuracy*100):0),o=ie(()=>!i.value||n.game.accuracy.value>i.value.accuracy||n.game.accuracy.value===i.value.accuracy&&n.game.correct.value>i.value.correct),u=ie(()=>n.game.getSessionProblemCards());Qe(async()=>{i.value=Um(n.game.mode.value,n.game.selectedTags.value,n.game.hidePinyin.value),r.value=uo()});function d(f,k){return f==="hanzi-pinyin"?"Hanzi  Pinyin":k?"Hanzi  English":"Hanzi+Pinyin  English"}function h(f){return f.map(k=>{const g=r.value.find(S=>S.id===k);return g?g.label:k}).join(", ")}function p(f){s("navigateToCard",f)}return(f,k)=>(b(),_("div",Fv,[k[10]||(k[10]=c("h2",null,"Game Over",-1)),c("div",Uv,[c("div",Hv,[c("span",Kv,L(a.value)+"%",1),k[3]||(k[3]=c("span",{class:"stat-label"},"Accuracy",-1))]),c("div",qv,[c("span",jv,L(e.game.correct.value),1),k[4]||(k[4]=c("span",{class:"stat-label"},"Correct",-1))]),c("div",zv,[c("span",Vv,L(e.game.incorrect.value),1),k[5]||(k[5]=c("span",{class:"stat-label"},"Wrong",-1))])]),i.value?(b(),_("div",Gv,[o.value?(b(),_("span",Wv,"New Best!")):(b(),_("span",Jv,"Best: "+L(l.value)+"% ("+L(i.value.correct)+" correct)",1))])):K("",!0),u.value.length>0?(b(),_("section",Yv,[k[6]||(k[6]=c("h3",null,"Words to Practice",-1)),k[7]||(k[7]=c("p",{class:"section-hint"},"These words were missed multiple times",-1)),c("div",Qv,[(b(!0),_(oe,null,_e(u.value,g=>(b(),_("a",{key:g.cardId,href:"?card="+encodeURIComponent(g.character),class:"problem-word",onClick:Me(S=>p(g.character),["prevent"])},[c("span",Xv,L(g.character),1),c("span",ey,"missed "+L(g.count)+"x",1)],8,Zv))),128))])])):K("",!0),c("div",ty,[c("span",null,L(d(e.game.mode.value,e.game.hidePinyin.value)),1),k[8]||(k[8]=c("span",{class:"config-separator"},"|",-1)),c("span",null,L(h(e.game.selectedTags.value)),1),k[9]||(k[9]=c("span",{class:"config-separator"},"|",-1)),c("span",null,L(e.game.timeLimit.value)+"s",1)]),c("div",ny,[c("button",{class:"btn btn-small",onClick:k[0]||(k[0]=g=>f.$emit("back"))}," Back"),c("button",{class:"btn btn-small",onClick:k[1]||(k[1]=g=>f.$emit("setup"))},"Change Settings"),c("button",{class:"btn btn-primary",onClick:k[2]||(k[2]=g=>f.$emit("playAgain"))},"Play Again")])]))}},iy=De(sy,[["__scopeId","data-v-ab934444"]]),ry={class:"reader-home"},ay={class:"reader-header"},ly={key:0,class:"loading-state"},oy={key:1,class:"empty-state"},cy={key:2,class:"book-list"},uy=["onClick"],dy={class:"book-info"},fy={class:"book-title"},hy={class:"book-meta"},py={class:"book-progress"},gy={class:"book-level"},my=["onClick"],vy={__name:"ReaderHome",props:{books:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["back","newBook","openBook","deleteBook"],setup(e,{emit:t}){const n=t,s={"hsk1-2":"Beginner","hsk3-4":"Intermediate","hsk5-6":"Advanced",natural:"Natural"};function i(r){confirm(`Delete "${r.title}"?`)&&n("deleteBook",r.id)}return(r,a)=>(b(),_("div",ry,[c("div",ay,[c("button",{class:"btn btn-small",onClick:a[0]||(a[0]=l=>r.$emit("back"))}," Back"),a[2]||(a[2]=c("h2",null,"Reader",-1))]),c("button",{class:"new-book-btn",onClick:a[1]||(a[1]=l=>r.$emit("newBook"))},[...a[3]||(a[3]=[c("span",{class:"new-book-icon"},"+",-1),c("span",null,"New Book",-1)])]),e.loading?(b(),_("div",ly," Loading books... ")):e.books.length===0?(b(),_("div",oy,[...a[4]||(a[4]=[c("p",null,"No books yet",-1),c("p",{class:"text-muted"},"Create a book by pasting any text",-1)])])):(b(),_("div",cy,[(b(!0),_(oe,null,_e(e.books,l=>(b(),_("div",{key:l.id,class:"book-item",onClick:o=>r.$emit("openBook",l.id)},[a[5]||(a[5]=c("div",{class:"book-icon"},"",-1)),c("div",dy,[c("div",fy,L(l.title),1),c("div",hy,[c("span",py," Page "+L(l.currentPage+1)+"/"+L(l.pages.length),1),c("span",gy,L(s[l.targetLevel]),1)])]),c("button",{class:"book-delete",onClick:Me(o=>i(l),["stop"]),title:"Delete book"},"",8,my)],8,uy))),128))]))]))}},yy=De(vy,[["__scopeId","data-v-1f0a1122"]]),by="flashcards-reader",ky=1,wt="books";let us=null;async function Ys(){return us||new Promise((e,t)=>{const n=indexedDB.open(by,ky);n.onerror=()=>t(n.error),n.onsuccess=()=>{us=n.result,e(us)},n.onupgradeneeded=s=>{const i=s.target.result;i.objectStoreNames.contains(wt)||i.createObjectStore(wt,{keyPath:"id"})}})}function wy(e){return JSON.parse(JSON.stringify(e))}async function Yt(e){const t=await Ys(),n=wy(e);return new Promise((s,i)=>{const l=t.transaction(wt,"readwrite").objectStore(wt).put(n);l.onerror=()=>i(l.error),l.onsuccess=()=>s(n)})}async function xy(e){const t=await Ys();return new Promise((n,s)=>{const a=t.transaction(wt,"readonly").objectStore(wt).get(e);a.onerror=()=>s(a.error),a.onsuccess=()=>n(a.result||null)})}async function fi(){const e=await Ys();return new Promise((t,n)=>{const r=e.transaction(wt,"readonly").objectStore(wt).getAll();r.onerror=()=>n(r.error),r.onsuccess=()=>{const a=r.result||[];a.sort((l,o)=>new Date(o.created)-new Date(l.created)),t(a)}})}async function Cy(e){const t=await Ys();return new Promise((n,s)=>{const a=t.transaction(wt,"readwrite").objectStore(wt).delete(e);a.onerror=()=>s(a.error),a.onsuccess=()=>n()})}function Sy(){return Date.now().toString(36)+Math.random().toString(36).slice(2)}const _y=/[]+/g,$y=/[.!?]+(?=\s|$)|\n{2,}/g,Ty=500;function vr(e){return/[\u4e00-\u9fff]/.test(e)}function Ey(e){return e.replace(/\r\n/g,`
`).replace(/\n{2,}/g,`

`).replace(new RegExp("(?<!\\n)\\n(?!\\n)","g")," ").replace(/  +/g," ")}function vo(e){const t=vr(e),n=[],s=t?e:Ey(e),i=t?_y:$y,r=[];let a=0;for(const d of s.matchAll(i)){const h=d.index+d[0].length,p=s.slice(a,h).trim();p&&r.push({text:p,start:a,end:h}),a=h}const l=s.slice(a).trim();if(l&&r.push({text:l,start:a,end:s.length}),r.length===0)return[{start:0,end:s.length,text:s,translated:null,segments:null}];let o={start:r[0].start,end:r[0].end,sentences:[r[0]]},u=0;for(const d of r){const h=t?d.text.length:d.text.split(/\s+/).filter(Boolean).length;u+h>Ty&&u>0?(o.text=o.sentences.map(p=>p.text).join(" "),n.push(o),o={start:d.start,end:d.end,sentences:[d]},u=h):(o.end=d.end,o.sentences.push(d),u+=h)}return o.sentences&&o.sentences.length>0&&(o.text=o.sentences.map(d=>d.text).join(" "),n.push(o)),n.map(d=>({start:d.start,end:d.end,text:d.text,translated:null,segments:null}))}function Ry({sourceText:e,targetLevel:t}){const n=vr(e)?"zh":"en",s=vo(e);return{id:Sy(),created:new Date().toISOString(),title:"Untitled",sourceText:e,sourceLanguage:n,targetLevel:t,pages:s,currentPage:0}}const Ay={class:"book-creator"},Py={class:"creator-header"},My={class:"form-field"},Iy={key:0,class:"field-hint"},Oy={key:0},Ly={class:"generate-helper"},Ny={class:"toggle-icon"},Dy={key:0,class:"generate-form"},By={class:"inspiration-prompts"},Fy=["onClick"],Uy={class:"generate-actions"},Hy=["disabled"],Ky={class:"level-field"},qy={class:"level-row"},jy=["value"],zy={class:"creator-actions"},Vy=["disabled"],Gy={__name:"BookCreator",emits:["cancel","create"],setup(e,{emit:t}){const n=t,{client:s}=on(),i=I(""),r=I("hsk1-2"),a=I(!1),l=I(""),o=I(!1);let u=0;const d=I(null),h=I(null),p=[{id:"hsk1-2",label:"Beginner",desc:"HSK 1-2"},{id:"hsk3-4",label:"Intermediate",desc:"HSK 3-4"},{id:"hsk5-6",label:"Advanced",desc:"HSK 5-6"},{id:"natural",label:"Natural",desc:"No adjustment"}],f=["The history of Chinese tea culture","How the Great Wall was built","Describe a day in the life of a delivery rider in Shanghai.","What are 9 things we should understand before its too late?","What are 7 lies we tell ourselves that feel like protection but are actually prisons?","Tips for learning Chinese effectively","The art of Chinese calligraphy","A travel guide to Shanghai","Famous Chinese inventions and their impact","A story about friendship and adventure","The significance of the Chinese New Year","What are things that feel productive but are actually sophisticated procrastination?","How to stay motivated while learning a new language","The role of family in Chinese culture","A day at a traditional Chinese market","The evolution of Chinese cuisine","Why do we give advice we don't follow ourselves?","What would happen if everyone suddenly told the truth for 24 hours?","How does living in a megacity like Shanghai change ones sense of identity compared to staying in a hometown county-level city?","Describe a day in the life of a migrant worker building high-rises in Shenzhen.","Describe a day in the life of a junior engineer at a big tech company in Beijing.","Describe a day in the life of a primary school teacher in a small city in Henan.","Describe a day in the life of a middle-aged factory owner in Guangdong facing shrinking margins.","Describe a day in the life of a university student in Wuhan preparing for the postgraduate entrance exam.","Describe a day in the life of a delivery rider in a smaller city like Chengdu, not just Shanghai.","Describe a day in the life of an elderly retiree in Shanghai who dances in the square every evening.","Describe a day in the life of a young couple in Hangzhou deciding whether to have a second child.","Describe a day in the life of an online content moderator working for a social media platform in China.","Describe a day in the life of a rural doctor in a village in Gansu."],k=I([...f].sort(()=>Math.random()-.5)),g=ie(()=>k.value.slice(0,3));function S(){k.value=[...f].sort(()=>Math.random()-.5)}Qe(()=>{var C;(C=d.value)==null||C.focus()});const R=ie(()=>i.value.trim().length>0),y=ie(()=>{const C=i.value.trim();if(!C)return"";const m=vr(C),A=vo(C);return m?`${C.length} characters, ${A.length} page${A.length!==1?"s":""}, Chinese detected`:`${C.split(/\s+/).filter(Boolean).length} words, ${A.length} page${A.length!==1?"s":""}, will be translated`});async function x(){if(!l.value.trim())return;if(!s){alert("LLM not configured. Please configure in Settings.");return}o.value=!0;const C=++u,m=`Generate a Chinese text about the following topic. Write in Chinese characters (Simplified Chinese), approximately 400-500 characters.

Topic: ${l.value}

Requirements:
- Write entirely in Chinese (Simplified characters)
- Make it engaging and natural-sounding
- Include some dialogue if appropriate for the topic
- Do not include pinyin or English translations
- Just output the Chinese text, nothing else`;try{a.value=!1,i.value="",await s.stream({messages:[{role:"user",content:m}]},A=>{C===u&&(i.value=A.fullContent)}),C===u&&(i.value=i.value.trim(),l.value="")}catch(A){C===u&&(console.error("Generation failed:",A),alert("Failed to generate text. Please check your LLM settings and try again."))}finally{C===u&&(o.value=!1)}}function $(){u++,o.value=!1,i.value=i.value.trim()}function P(){R.value&&n("create",{sourceText:i.value.trim(),targetLevel:r.value})}return(C,m)=>(b(),_("div",Ay,[c("div",Py,[c("button",{class:"btn btn-small",onClick:m[0]||(m[0]=A=>C.$emit("cancel"))}," Back"),m[5]||(m[5]=c("h2",null,"New Book",-1))]),m[11]||(m[11]=c("p",{class:"welcome-hint"}," Paste text from a book, article, or anywhere. Interesting content makes better flashcards. ",-1)),c("div",My,[m[6]||(m[6]=c("label",null,"Your text",-1)),me(c("textarea",{ref_key:"textareaRef",ref:d,"onUpdate:modelValue":m[1]||(m[1]=A=>i.value=A),placeholder:"Paste English or Chinese text here...",class:"form-textarea",rows:"8"},null,512),[[Re,i.value]]),i.value.trim()||o.value?(b(),_("div",Iy,[i.value.trim()?(b(),_("span",Oy,L(y.value),1)):K("",!0),o.value?(b(),_("button",{key:1,class:"btn-stop",onClick:$},"  Stop ")):K("",!0)])):K("",!0)]),c("div",Ly,[c("button",{class:Se(["generate-toggle",{expanded:a.value}]),onClick:m[2]||(m[2]=A=>a.value=!a.value)},[c("span",Ny,L(a.value?"":"+"),1),m[7]||(m[7]=nt(" Need content? Generate from a topic ",-1))],2),a.value?(b(),_("div",Dy,[me(c("textarea",{ref_key:"generateTextareaRef",ref:h,"onUpdate:modelValue":m[3]||(m[3]=A=>l.value=A),placeholder:"Describe what you want to read about...",class:"form-textarea generate-textarea",rows:"2"},null,512),[[Re,l.value]]),c("div",By,[m[8]||(m[8]=c("span",{class:"inspiration-label"},"Try:",-1)),(b(!0),_(oe,null,_e(g.value,A=>(b(),_("button",{key:A,class:"prompt-chip",onClick:F=>l.value=A},L(A),9,Fy))),128)),c("button",{class:"btn-link",onClick:S},"more")]),c("div",Uy,[c("button",{class:"btn btn-primary",onClick:x,disabled:!l.value.trim()||o.value},L(o.value?"Generating...":"Generate"),9,Hy)])])):K("",!0)]),c("div",Ky,[c("div",qy,[m[9]||(m[9]=c("label",null,"Target level",-1)),me(c("select",{"onUpdate:modelValue":m[4]||(m[4]=A=>r.value=A),class:"level-select"},[(b(),_(oe,null,_e(p,A=>c("option",{key:A.id,value:A.id},L(A.label)+" ("+L(A.desc)+") ",9,jy)),64))],512),[[wn,r.value]])]),m[10]||(m[10]=c("div",{class:"level-hint"}," Translations and generated text will use vocabulary appropriate for this level. ",-1))]),c("div",zy,[c("button",{class:"btn btn-primary btn-large",onClick:P,disabled:!R.value}," Create Book ",8,Vy)])]))}},Wy=De(Gy,[["__scopeId","data-v-399a5f93"]]),Jy="modulepreload",Yy=function(e,t){return new URL(e,t).href},$a={},Ta=function(t,n,s){let i=Promise.resolve();if(n&&n.length>0){const a=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(n.map(u=>{if(u=Yy(u,s),u in $a)return;$a[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(!!s)for(let k=a.length-1;k>=0;k--){const g=a[k];if(g.href===u&&(!d||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":Jy,d||(f.as="script"),f.crossOrigin="",f.href=u,o&&f.setAttribute("nonce",o),document.head.appendChild(f),d)return new Promise((k,g)=>{f.addEventListener("load",k),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&r(l.reason);return t().catch(r)})};let ds=null;async function yo(){if(ds)return ds;const[{segment:e,addDict:t},n]=await Promise.all([Ta(()=>import("./index-x7yZI9K1.js"),[],import.meta.url),Ta(()=>import("./complete-js9n5Jbc.js"),[],import.meta.url).then(s=>s.default)]);return t(n),ds=e,ds}async function fs(e){return(await yo())(e).map(s=>({text:s.origin,pinyin:s.result}))}async function Qy(e){var n,s;const t=await ht(e);if((n=t.cedict)!=null&&n[0])return Sn(t.cedict[0].definitions,3);if(e.length>1){const i=[];for(const r of e){const a=await ht(r);if((s=a.cedict)!=null&&s[0]){const l=Sn(a.cedict[0].definitions,1);i.push(`${r}: ${l}`)}}if(i.length>0)return i.join(" + ")}return""}async function Zy(e){return(await yo())(e).map(s=>s.result).join(" ")}function Xy(e,t){const n=e.pages[t],s=e.sourceText.slice(n.start,n.end);let i="",r="";if(t>0){const d=e.pages[t-1];i=e.sourceText.slice(d.start,d.end).split(/[.!?\n]+/).filter(Boolean).slice(-2).join("")}if(t<e.pages.length-1){const d=e.pages[t+1];r=e.sourceText.slice(d.start,d.end).split(/[.!?\n]+/).filter(Boolean).slice(0,2).join("")}const a={"hsk1-2":{vocab:"~300 basic words",guidelines:`- Natural sentence flow, not fragmented
- Keep the original style and tone
- Simplify or skip complex details
- Combine related ideas into single sentences`},"hsk3-4":{vocab:"~1200 words, common idioms OK",guidelines:`- Natural sentence flow
- Keep the original style and tone
- Can use common idioms with context
- Simplify obscure references`},"hsk5-6":{vocab:"~2500+ words",guidelines:`- Natural Chinese expression
- Preserve literary style when possible
- Avoid obscure classical expressions`},natural:{vocab:"no restrictions",guidelines:`- Translate naturally and accurately
- Preserve the author's voice and style
- Prioritize fluency and accuracy`}},l=a[e.targetLevel]||a.natural;let o="";return(i||r)&&(o=`
For continuity, here is surrounding context (DO NOT translate this):
${i?`Previous: ${i}`:""}
${r?`Next: ${r}`:""}
`),t===0&&e.title==="Untitled"?`Rewrite this in simple Chinese for learners (${e.targetLevel} level, ${l.vocab}).

Guidelines:
${l.guidelines}
${o}
Text to translate:
${s}

Return JSON with a short title (2-5 words, in the source language) and the Chinese translation:
{"title": "Short Title Here", "translation": "Chinese text here..."}`:`Rewrite this in simple Chinese for learners (${e.targetLevel} level, ${l.vocab}).

Guidelines:
${l.guidelines}
${o}
Text to translate:
${s}

Chinese version:`}function eb(e){return`Split this Chinese text into sentences and translate each to English.
Return a JSON array where each element has "zh" (the Chinese sentence) and "en" (English translation).

Chinese text:
${e}

Return ONLY valid JSON, no other text:
[{"zh": "", "en": "First sentence in English."}, ...]`}function tb(e,t){return`Generate a short title (2-5 words) for this ${t==="zh"?"Chinese":"English"} text. Return only the title, nothing else.

Text:
${e.slice(0,500)}

Title:`}function nb(e){const t=I([]),n=I(null),s=I(!1),i=I(!1),r=I(!1),a=I(null),l=I(null),o=ie(()=>{var D;return((D=n.value)==null?void 0:D.currentPage)??0}),u=ie(()=>{var D,O;return((O=(D=n.value)==null?void 0:D.pages)==null?void 0:O[o.value])??null}),d=ie(()=>{var D,O;return((O=(D=n.value)==null?void 0:D.pages)==null?void 0:O.length)??0}),h=ie(()=>!n.value||!u.value?"":n.value.sourceText.slice(u.value.start,u.value.end));async function p(){s.value=!0,a.value=null;try{t.value=await fi()}catch(D){a.value="Failed to load books: "+D.message,console.error(D)}finally{s.value=!1}}async function f(D){s.value=!0,a.value=null;try{if(n.value=await xy(D),!n.value)throw new Error("Book not found")}catch(O){a.value="Failed to open book: "+O.message,console.error(O)}finally{s.value=!1}}function k(){n.value=null}async function g({sourceText:D,targetLevel:O}){s.value=!0,a.value=null;try{const z=Ry({sourceText:D,targetLevel:O});return await Yt(z),t.value=await fi(),n.value=z,z}catch(z){return a.value="Failed to create book: "+z.message,console.error(z),null}finally{s.value=!1}}async function S(D){try{const O=e();if(!O)return;const z=tb(D.sourceText,D.sourceLanguage),M=(await O.stream({messages:[{role:"user",content:z}]})).trim().replace(/^["']|["']$/g,"");M&&M.length<100&&(D.title=M)}catch(O){console.error("Title generation failed:",O)}}async function R(D){var O;s.value=!0,a.value=null;try{await Cy(D),t.value=await fi(),((O=n.value)==null?void 0:O.id)===D&&(n.value=null)}catch(z){a.value="Failed to delete book: "+z.message,console.error(z)}finally{s.value=!1}}async function y(D){n.value&&(D<0||D>=n.value.pages.length||(n.value.currentPage=D,await Yt(n.value),await P(D)))}async function x(){await y(o.value+1)}async function $(){await y(o.value-1)}async function P(D=o.value){if(!n.value)return;const O=n.value.pages[D];if(O){if(n.value.sourceLanguage==="zh"&&n.value.targetLevel==="natural"){if(!O.segments){i.value=!0;try{const z=n.value.sourceText.slice(O.start,O.end);O.translated=z,O.segments=await fs(z),D===0&&n.value.title==="Untitled"&&await S(n.value),await Yt(n.value)}catch(z){a.value="Segmentation failed: "+z.message,console.error(z)}finally{i.value=!1}}O.backTranslation||await C(D);return}if(O.translated){if(!O.segments){i.value=!0;try{O.segments=await fs(O.translated),await Yt(n.value)}catch(z){a.value="Segmentation failed: "+z.message,console.error(z)}finally{i.value=!1}}}else{i.value=!0,a.value=null;try{const z=e();if(!z)throw new Error("LLM not configured. Please configure in Settings.");const B=Xy(n.value,D),M=await z.stream({messages:[{role:"user",content:B}]});if(D===0&&n.value.title==="Untitled"){const Z=M.match(/\{[\s\S]*\}/);if(Z)try{const ne=JSON.parse(Z[0]);ne.title&&(n.value.title=ne.title),O.translated=(ne.translation||M).trim()}catch{O.translated=M.trim()}else O.translated=M.trim()}else O.translated=M.trim();O.segments=await fs(O.translated),await Yt(n.value)}catch(z){a.value="Translation failed: "+z.message,console.error(z)}finally{i.value=!1}}O.backTranslation||await C(D)}}async function C(D=o.value){if(!n.value)return;const O=n.value.pages[D];if(!(!(O!=null&&O.translated)||O.backTranslation)){r.value=!0,l.value=null;try{const z=e();if(!z)throw new Error("LLM not configured. Please configure in Settings.");const B=eb(O.translated),M=await z.stream({messages:[{role:"user",content:B}],maxTokens:4e4});console.log("Back-translation response:",M);const ae=M.match(/\[[\s\S]*\]/);if(ae){const Z=JSON.parse(ae[0]),ne=await Promise.all(Z.map(async ee=>({zh:ee.zh,en:ee.en,segments:await fs(ee.zh)})));O.backTranslation=ne}else throw console.error("No JSON array found in response:",M),new Error("Invalid response format - no JSON array found");await Yt(n.value)}catch(z){l.value="Back-translation failed: "+z.message,console.error(z)}finally{r.value=!1}}}async function m(){!n.value||!u.value||(u.value.backTranslation=null,l.value=null,await C())}async function A(){!n.value||!u.value||(u.value.translated=null,u.value.segments=null,await P())}async function F(D){n.value&&(n.value.displaySettings=D,await Yt(n.value))}return{books:t,currentBook:n,loading:s,translating:i,backTranslating:r,error:a,backTranslationError:l,currentPageIndex:o,currentPage:u,totalPages:d,currentPageOriginal:h,loadBooks:p,openBook:f,closeBook:k,createNewBook:g,removeBook:R,goToPage:y,nextPage:x,prevPage:$,ensurePageTranslated:P,ensureBackTranslation:C,retryTranslation:A,retryBackTranslation:m,updateDisplaySettings:F}}const sb={class:"reading-view"},ib={class:"reading-header"},rb={class:"reading-title"},ab={class:"reading-nav"},lb=["disabled"],ob={class:"page-indicator"},cb=["disabled"],ub={class:"reading-content"},db={key:0,class:"reading-text"},fb={key:1,class:"reading-error"},hb={class:"chinese-line"},pb={key:0,class:"word-group"},gb={key:0,class:"word-pinyin"},mb=["data-block-index","data-segment-index","onClick"],vb={key:1,class:"punct"},yb={key:0,class:"english-line"},bb={key:1,class:"skeleton-line skeleton-english"},kb=["onClick"],wb={key:1,class:"sentence-block"},xb={class:"chinese-line"},Cb={key:0,class:"word-group"},Sb={key:0,class:"word-pinyin"},_b=["data-segment-index","onClick"],$b={key:1,class:"punct"},Tb={key:3,class:"reading-placeholder"},Eb={class:"mini-card-header"},Rb={class:"mini-card-char"},Ab={class:"mini-card-pinyin"},Pb={class:"mini-card-meaning"},Mb={key:1,class:"mini-card-actions"},Ib={class:"reading-footer"},Ob={key:0,class:"back-translation-loading"},Lb={key:1,class:"back-translation-error"},Nb={key:2,class:"original-text"},Db={__name:"ReadingView",props:{book:{type:Object,required:!0},page:{type:Object,default:null},currentPageIndex:{type:Number,default:0},totalPages:{type:Number,default:0},originalText:{type:String,default:""},translating:{type:Boolean,default:!1},backTranslating:{type:Boolean,default:!1},error:{type:String,default:null},backTranslationError:{type:String,default:null},onAddWord:{type:Function,default:null}},emits:["back","prevPage","nextPage","translate","retry","openWord","miniCardChange","backTranslate","retryBackTranslation","settingsChange"],setup(e,{emit:t}){var D,O,z;const n=e,s=t,i=I(((D=n.book.displaySettings)==null?void 0:D.showPinyin)??!0),r=I(((O=n.book.displaySettings)==null?void 0:O.showEnglish)??!1),a=I(((z=n.book.displaySettings)==null?void 0:z.showOriginal)??!1),l=I(null),o=I({x:0,y:0}),u=I(null);Ne(l,B=>{s("miniCardChange",!!B),B||(u.value=null)}),Ne([i,r,a],()=>{s("settingsChange",{showPinyin:i.value,showEnglish:r.value,showOriginal:a.value})});function d(B){return/^[\s""''\-,.!?;:'"()\[\]{}<>]+$/.test(B)}const h=ie(()=>{var ne,ee;if((ne=n.page)!=null&&ne.backTranslation&&Array.isArray(n.page.backTranslation))return n.page.backTranslation.map(pe=>({segments:pe.segments||[],pinyin:(pe.segments||[]).map(Ee=>Ee.pinyin||"").join(" ").replace(/\s+/g," ").trim(),en:pe.en||""}));if(!((ee=n.page)!=null&&ee.segments))return[];const B=[];let M=[],ae=!1;for(const pe of n.page.segments){const Ee=/^["']+$/.test(pe.text);if(ae&&Ee&&B.length>0){B[B.length-1].segments.push(pe);continue}M.push(pe),ae=!1,/[\n]/.test(pe.text)&&(B.push({segments:M,pinyin:M.map(Oe=>Oe.pinyin||"").join(" ").replace(/\s+/g," ").trim(),en:""}),M=[],ae=!0)}M.length&&B.push({segments:M,pinyin:M.map(pe=>pe.pinyin||"").join(" ").replace(/\s+/g," ").trim(),en:""});const Z=/^[\s""''\-,.!?;:'"()\[\]{}<>\n]+$/;return B.filter(pe=>pe.segments.some(Ee=>!Z.test(Ee.text)))}),p=ie(()=>{const{x:B,y:M}=o.value,ae=window.innerWidth-280,Z=window.innerHeight-200;return{position:"fixed",left:`${Math.min(B,ae)}px`,top:`${Math.min(M,Z)}px`,zIndex:1e3}}),f=I(null);async function k(B,M,ae){var ne;o.value={x:ae.left,y:ae.bottom+8},l.value={text:B,pinyin:M||"",meaning:""};const Z=await Qy(B);((ne=l.value)==null?void 0:ne.text)===B&&(l.value.meaning=Z||"No definition found",l.value.pinyin||(l.value.pinyin=await Zy(B)))}async function g(B,M,ae){var Ee,Oe;const Z=window.getSelection();if(Z&&Z.toString().trim())return;B.stopPropagation();const ne=B.target.closest(".word");if(!ne)return;let ee=null;if(M!==null?ee=(Oe=(Ee=h.value[M])==null?void 0:Ee.segments)==null?void 0:Oe[ae]:ee=n.page.segments[ae],!ee)return;const pe=ne.getBoundingClientRect();await k(ee.text,ee.pinyin,pe)}function S(B){return B.replace(/[^\u4e00-\u9fff]/g,"")}function R(){const B=window.getSelection();if(!B||B.isCollapsed)return;const M=B.toString().trim();if(!M)return;const ae=S(M);if(!ae||!f.value)return;const Z=B.anchorNode;if(!f.value.contains(Z))return;const ee=B.getRangeAt(0).getBoundingClientRect();k(ae,"",ee),B.removeAllRanges()}function y(){if(!l.value||!n.onAddWord)return;const B=n.onAddWord({text:l.value.text,pinyin:l.value.pinyin,meaning:l.value.meaning,bookTitle:n.book.title,bookId:n.book.id});B.success?(u.value={type:"success",message:"Added to your cards!"},setTimeout(()=>{l.value=null},1200)):B.reason==="exists"&&(u.value={type:"error",message:"Already in your collection"})}function x(){l.value&&(s("openWord",l.value.text),l.value=null)}function $(){l.value=null,u.value=null}function P(B){const M=B.segments.map(ae=>ae.text).join("");ro(M)}function C(){var B,M;r.value&&((B=n.page)!=null&&B.translated)&&!((M=n.page)!=null&&M.backTranslation)&&s("backTranslate")}function m(B){l.value&&!B.target.closest(".mini-card")&&!B.target.closest(".word")&&(l.value=null)}function A(){setTimeout(R,10)}function F(B){var ae,Z,ne;const M=((ae=document.activeElement)==null?void 0:ae.tagName)==="INPUT"||((Z=document.activeElement)==null?void 0:Z.tagName)==="TEXTAREA"||((ne=document.activeElement)==null?void 0:ne.isContentEditable);if(B.key==="Escape"&&l.value){l.value=null,B.stopPropagation();return}M||(B.key==="ArrowLeft"&&s("prevPage"),B.key==="ArrowRight"&&s("nextPage"))}return Qe(()=>{document.addEventListener("click",m),document.addEventListener("keydown",F),document.addEventListener("mouseup",A)}),xt(()=>{document.removeEventListener("click",m),document.removeEventListener("keydown",F),document.removeEventListener("mouseup",A)}),Ne(()=>[n.page,n.currentPageIndex],()=>{n.page&&!n.page.segments&&!n.translating&&s("translate")},{immediate:!0}),Ne(()=>{var B,M;return[(B=n.page)==null?void 0:B.translated,(M=n.page)==null?void 0:M.backTranslation]},()=>{var B,M;r.value&&((B=n.page)!=null&&B.translated)&&!((M=n.page)!=null&&M.backTranslation)&&!n.backTranslating&&s("backTranslate")},{immediate:!0}),(B,M)=>{var ae;return b(),_("div",sb,[c("div",ib,[c("button",{class:"btn btn-small",onClick:M[0]||(M[0]=Z=>B.$emit("back"))}," Back"),c("div",rb,L(e.book.title),1),c("div",ab,[c("button",{class:"nav-btn",onClick:M[1]||(M[1]=Z=>B.$emit("prevPage")),disabled:e.currentPageIndex===0},"",8,lb),c("span",ob,L(e.currentPageIndex+1)+" / "+L(e.totalPages),1),c("button",{class:"nav-btn",onClick:M[2]||(M[2]=Z=>B.$emit("nextPage")),disabled:e.currentPageIndex===e.totalPages-1},"",8,cb)])]),c("div",ub,[e.translating?(b(),_("div",db,[(b(),_(oe,null,_e(3,Z=>c("div",{class:"sentence-block skeleton-block",key:Z},[...M[10]||(M[10]=[c("div",{class:"skeleton-line skeleton-pinyin"},null,-1),c("div",{class:"skeleton-line skeleton-hanzi"},null,-1)])])),64))])):e.error?(b(),_("div",fb,[c("p",null,L(e.error),1),c("button",{class:"btn btn-small",onClick:M[3]||(M[3]=Z=>B.$emit("retry"))},"Retry")])):(ae=e.page)!=null&&ae.segments?(b(),_("div",{key:2,class:"reading-text",ref_key:"readingTextRef",ref:f},[h.value.length?(b(!0),_(oe,{key:0},_e(h.value,(Z,ne)=>(b(),_("div",{key:ne,class:"sentence-block"},[c("div",hb,[(b(!0),_(oe,null,_e(Z.segments,(ee,pe)=>(b(),_(oe,{key:pe},[d(ee.text)?(b(),_("span",vb,L(ee.text),1)):(b(),_("span",pb,[i.value?(b(),_("span",gb,L(ee.pinyin),1)):K("",!0),c("span",{class:"word","data-block-index":ne,"data-segment-index":pe,onClick:Ee=>g(Ee,ne,pe)},L(ee.text),9,mb)]))],64))),128))]),r.value&&Z.en?(b(),_("div",yb,L(Z.en),1)):r.value&&e.backTranslating?(b(),_("div",bb)):K("",!0),c("button",{class:"speak-btn",onClick:Me(ee=>P(Z),["stop"]),title:"Read aloud"},[...M[11]||(M[11]=[c("svg",{class:"speak-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[c("path",{d:"M11 5L6 9H2v6h4l5 4V5z"}),c("path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07"})],-1)])],8,kb)]))),128)):(b(),_("div",wb,[c("div",xb,[(b(!0),_(oe,null,_e(e.page.segments,(Z,ne)=>(b(),_(oe,{key:ne},[d(Z.text)?(b(),_("span",$b,L(Z.text),1)):(b(),_("span",Cb,[i.value?(b(),_("span",Sb,L(Z.pinyin),1)):K("",!0),c("span",{class:"word","data-segment-index":ne,onClick:ee=>g(ee,null,ne)},L(Z.text),9,_b)]))],64))),128))])]))],512)):(b(),_("div",Tb,[M[12]||(M[12]=c("p",null,"Ready to translate",-1)),c("button",{class:"btn btn-primary",onClick:M[4]||(M[4]=Z=>B.$emit("translate"))},"Translate Page")]))]),(b(),Pe(Ji,{to:"body"},[l.value?(b(),_("div",{key:0,class:"mini-card",style:Zn(p.value),onClick:M[5]||(M[5]=Me(()=>{},["stop"]))},[c("div",Eb,[c("span",Rb,L(l.value.text),1),c("span",Ab,L(l.value.pinyin),1),c("button",{class:"mini-card-close",onClick:$},"")]),c("div",Pb,L(l.value.meaning||"Loading..."),1),u.value?(b(),_("div",{key:0,class:Se(["mini-card-feedback",u.value.type])},L(u.value.message),3)):(b(),_("div",Mb,[c("button",{class:"btn btn-small btn-primary",onClick:y}," + Add to Cards "),c("button",{class:"btn btn-small",onClick:x}," Look up ")]))],4)):K("",!0)])),c("div",Ib,[c("button",{class:Se(["toggle-pill",{active:i.value}]),onClick:M[6]||(M[6]=Z=>i.value=!i.value)},[...M[13]||(M[13]=[c("span",{class:"toggle-pill-indicator"},null,-1),c("span",{class:"toggle-pill-label"},"Show Pinyin",-1)])],2),c("button",{class:Se(["toggle-pill",{active:r.value}]),onClick:M[7]||(M[7]=Z=>{r.value=!r.value,C()})},[...M[14]||(M[14]=[c("span",{class:"toggle-pill-indicator"},null,-1),c("span",{class:"toggle-pill-label"},"Show English",-1)])],2),c("button",{class:Se(["toggle-pill",{active:a.value}]),onClick:M[8]||(M[8]=Z=>a.value=!a.value)},[...M[15]||(M[15]=[c("span",{class:"toggle-pill-indicator"},null,-1),c("span",{class:"toggle-pill-label"},"Show Original",-1)])],2)]),r.value&&e.backTranslating?(b(),_("div",Ob,[...M[16]||(M[16]=[c("span",{class:"loading-dot"},null,-1),nt(" Loading English translations... ",-1)])])):K("",!0),r.value&&e.backTranslationError?(b(),_("div",Lb,[c("p",null,L(e.backTranslationError),1),c("button",{class:"btn btn-small",onClick:M[9]||(M[9]=Z=>B.$emit("retryBackTranslation"))},"Retry")])):K("",!0),a.value?(b(),_("div",Nb,[M[17]||(M[17]=c("h4",null,"Original Text",-1)),c("p",null,L(e.originalText),1)])):K("",!0)])}}},Bb=De(Db,[["__scopeId","data-v-1c5bf431"]]);function bo(){return{view:"home",deck:null,card:null,cardIndex:-1,gameStage:null,readerStage:null,bookId:null}}function Oi(e){if(!e)return null;const t=e.match(/^hsk(\d)$/i);if(t){const n=parseInt(t[1]);if(n>=1&&n<=6)return{type:"hsk",level:n}}return e==="vocabulary"||e==="trivia"||e==="all"?{type:"user",filter:e}:null}function Ea(e){return e?e.type==="hsk"?`hsk${e.level}`:e.type==="user"?e.filter||"all":null:null}function hi(){const e=new URLSearchParams(window.location.search),t=bo(),n=e.get("view"),s=e.get("deck"),i=e.get("card"),r=e.get("stage"),a=e.get("book");return n==="games"?(t.view="games",t.gameStage=r==="play"?"play":r==="results"?"results":"setup"):n==="reader"?(t.view="reader",a?(t.readerStage="reading",t.bookId=a):r==="create"?t.readerStage="create":t.readerStage="home"):i?(t.view="card",t.card=i,t.deck=Oi(s)):s?(t.view="deck",t.deck=Oi(s)):t.view="home",t}function pi(e){const t=new URLSearchParams;e.view==="games"?(t.set("view","games"),e.gameStage&&e.gameStage!=="setup"&&t.set("stage",e.gameStage)):e.view==="reader"?(t.set("view","reader"),e.bookId?t.set("book",e.bookId):e.readerStage==="create"&&t.set("stage","create")):e.view==="card"||e.card?(e.deck&&t.set("deck",Ea(e.deck)),e.card&&t.set("card",e.card)):e.view==="deck"&&e.deck&&t.set("deck",Ea(e.deck));const n=t.toString();return n?`?${n}`:window.location.pathname}function gi(e){return{view:e.view,deck:e.deck?JSON.parse(JSON.stringify(e.deck)):null,card:e.card,cardIndex:e.cardIndex,gameStage:e.gameStage,readerStage:e.readerStage,bookId:e.bookId}}function Fb(e,t){return!e||!t?e===t:e.view===t.view&&e.card===t.card&&e.gameStage===t.gameStage&&e.readerStage===t.readerStage&&e.bookId===t.bookId&&JSON.stringify(e.deck)===JSON.stringify(t.deck)}function Ub({onNavigate:e}){const t=I(bo()),n=ie(()=>t.value.view==="home"),s=ie(()=>t.value.view==="deck"),i=ie(()=>t.value.view==="card"||!!t.value.card),r=ie(()=>t.value.view==="games"),a=ie(()=>t.value.view==="reader"),l=ie(()=>!!t.value.deck),o=ie(()=>t.value.gameStage),u=ie(()=>t.value.readerStage);function d(P,{replace:C=!1}={}){const m={...t.value,...P};P.view==="home"?(m.deck=null,m.card=null,m.cardIndex=-1,m.gameStage=null,m.readerStage=null,m.bookId=null):P.view==="deck"?(m.card=null,m.cardIndex=-1,m.gameStage=null,m.readerStage=null,m.bookId=null):P.view==="games"?(m.deck=null,m.card=null,m.cardIndex=-1,m.readerStage=null,m.bookId=null):P.view==="reader"&&(m.deck=null,m.card=null,m.cardIndex=-1,m.gameStage=null),!P.view&&m.card&&m.view!=="games"&&m.view!=="reader"&&(m.view="card"),m.view==="card"&&(m.gameStage=null,m.readerStage=null,m.bookId=null);const A=pi(m),F=gi(m);C?history.replaceState(F,"",A):Fb(t.value,m)||history.pushState(F,"",A),t.value=m}function h(P){d(P,{replace:!0})}function p(P){t.value.cardIndex=P;const C=pi(t.value);history.replaceState(gi(t.value),"",C)}function f(){history.back()}function k(){d({view:"home"})}function g(P){const C=P?JSON.parse(JSON.stringify(P)):null;d({view:"deck",deck:C})}function S(P,C=null,m=-1){const A=C?JSON.parse(JSON.stringify(C)):null;d({view:"card",card:P,deck:A,cardIndex:m})}function R(P="setup"){d({view:"games",gameStage:P})}function y(P="home",C=null){d({view:"reader",readerStage:P,bookId:C})}function x(P){const C=P.state;C&&C.view?t.value=C:t.value=hi(),e==null||e(t.value)}function $(){return t.value=hi(),history.replaceState(gi(t.value),"",pi(t.value)),t.value}return Qe(()=>{window.addEventListener("popstate",x)}),xt(()=>{window.removeEventListener("popstate",x)}),{currentRoute:t,isHome:n,isDeck:s,isCard:i,isGames:r,isReader:a,hasDeckContext:l,gameStage:o,readerStage:u,navigate:d,replace:h,updateCardIndex:p,back:f,goHome:k,goToDeck:g,goToCard:S,goToGames:R,goToReader:y,init:$,parseUrl:hi,parseDeckParam:Oi}}function Hb(e){const t=[...e];for(let n=t.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[t[n],t[s]]=[t[s],t[n]]}return t}function Kb({savedCards:e,onCardChange:t}){const n=I(null),s=I([]),i=I(""),r=I(-1),a=I([]),l=ie(()=>a.value.length>0&&r.value>=0);async function o(y){n.value=y,y.type==="hsk"?(i.value=`HSK ${y.level}`,s.value=await Ws(y.level)):y.type==="user"&&(y.filter==="vocabulary"?(i.value="Your Words",s.value=e.value.filter(x=>x.type!=="trivia")):y.filter==="trivia"?(i.value="Your Questions",s.value=e.value.filter(x=>x.type==="trivia")):(i.value="All Your Cards",s.value=[...e.value]))}function u(){n.value=null,s.value=[],i.value="",a.value=[],r.value=-1}function d(y,x=null){const $=s.value.findIndex(P=>P.id===y.id);if(x&&x.length>0){a.value=x;const P=a.value.indexOf($);r.value=P>=0?P:0}else if(a.value.length===0)a.value=s.value.map((P,C)=>C),r.value=$>=0?$:0;else{const P=a.value.indexOf($);r.value=P>=0?P:0}return y}function h(){if(r.value>0){r.value--;const y=a.value[r.value],x=s.value[y];return t==null||t(x),x}return null}function p(){if(r.value<a.value.length-1){r.value++;const y=a.value[r.value],x=s.value[y];return t==null||t(x),x}return null}function f(){if(s.value.length===0)return null;a.value=Hb(s.value.map((x,$)=>$)),r.value=0;const y=s.value[a.value[0]];return t==null||t(y),y}function k(y){return s.value.find(x=>x.character===y)}function g(y){a.value=e.value.map(($,P)=>P);const x=e.value.findIndex($=>$.id===y.id);r.value=x>=0?x:0,s.value=e.value}function S(y){const x=s.value.findIndex(P=>P.id===y),$=a.value.indexOf(x);return $>=0&&a.value.splice($,1),r.value>=a.value.length&&(r.value=Math.max(0,a.value.length-1)),a.value.length>0?s.value[a.value[r.value]]:null}function R(){a.value=[],r.value=-1}return{activeDeck:n,activeDeckCards:s,activeDeckTitle:i,currentIndex:r,displayOrder:a,isBrowsingCards:l,openDeck:o,closeDeck:u,openCardFromDeck:d,prevCard:h,nextCard:p,shuffleCurrentDeck:f,findCardInDeck:k,setupSavedCardsNavigation:g,removeFromDisplayOrder:S,clearNavigation:R}}function qb({savedCards:e,loadCards:t}){const n=I(null),s=I(!1),i=I(null),r=I(null),a=I(!1),l=I(null),o=I(null),u=I(null),d=ie(()=>{var C;return n.value?(C=n.value.tags)!=null&&C.includes("user")?!0:e.value.some(m=>m.id===n.value.id):!1});async function h(){var C;(C=n.value)!=null&&C.character?r.value=await em(n.value.character):r.value=null}function p(C){return n.value=C,s.value=!1,o.value=null,u.value=null,i.value=null,h(),C}function f(C){return n.value=C,s.value=!1,o.value=null,u.value=null,i.value=null,h(),C}async function k(C){const m=e.value.find(F=>F.character===C);if(m)return{type:"saved",card:p(m)};const A=await Ii(C);if(A&&A.length>0){const F=A.sort((D,O)=>D.level-O.level)[0];return{type:"hsk",card:f(F.card),level:F.level}}a.value=!0;try{const F=await ht(C);if(F.cedict&&F.cedict.length>0){const D=F.cedict[0];return n.value=jn({character:D.simplified,pinyin:D.pinyin||"",markdown:ui(D.simplified,D.pinyin)}),s.value=!0,o.value=D,i.value={cedict:F.cedict,ids:F.ids,componentIds:F.componentIds},h(),{type:"new",card:n.value}}else return l.value=`Character "${C}" not found`,{type:"error",error:l.value}}finally{a.value=!1}}async function g(C,{findCardInDeck:m,openCardFromDeck:A,activeDeck:F,activeDeckCards:D}){const O=gr(C.simplified,C.pinyin);if(O)return{action:"openSaved",card:p(O)};if(F!=null&&F.value&&(D==null?void 0:D.value.length)>0){const B=m(C.simplified);if(B)return A(B),n.value=B,s.value=!1,o.value=null,u.value=null,i.value=null,h(),{action:"openDeck",card:B}}const z=await Ii(C.simplified);if(z&&z.length>0){const B=z.sort((M,ae)=>M.level-ae.level)[0];return{action:"openHsk",card:f(B.card)}}return n.value=jn({character:C.simplified,pinyin:C.pinyin||"",markdown:ui(C.simplified,C.pinyin)}),s.value=!0,o.value=C,i.value={cedict:[C],ids:null,componentIds:null},ht(C.simplified).then(B=>{i.value&&(i.value.ids=B.ids,i.value.componentIds=B.componentIds)}),h(),{action:"newCard",card:n.value}}function S(C){return u.value=C,o.value=null,n.value=jn({character:C,pinyin:"",markdown:ui(C)}),s.value=!0,i.value=null,n.value}function R(C){ln(C),t(),n.value=C,s.value=!1,o.value=null,u.value=null}function y(){if(!n.value)return null;const C=Ug(n.value);return C.success?(t(),n.value=C.card,{success:!0,card:C.card}):C.reason==="exists"?(l.value="This card is already in your collection",setTimeout(()=>{l.value=null},2e3),{success:!1,reason:"exists"}):C}function x(){n.value=null,s.value=!1,o.value=null,u.value=null,i.value=null,r.value=null,l.value=null}function $(C){return d.value?(Fg(C),t(),!0):!1}function P(C){n.value=C,s.value=!1,o.value=null,u.value=null,h()}return{currentCard:n,isNewCard:s,currentDictLookup:i,currentHskBadge:r,urlLoading:a,error:l,pendingDictEntry:o,pendingFreeformQuery:u,isCurrentCardInCollection:d,updateHskBadge:h,openSavedCard:p,openHskCard:f,openCardByCharacter:k,handleDictSelect:g,handleFreeform:S,saveCurrentCard:R,addCurrentToCollection:y,closeCard:x,handleDelete:$,markAsGenerated:P}}function Ra(e,t){return`You are a Chinese language learning assistant creating a flashcard for: "${e}"

DICTIONARY DEFINITION:
${t||"Not found in dictionary"}

Generate a flashcard with the following sections:

**FRONT (keep concise):**
- Character: ${e}
- Pinyin: [provide accurate pinyin with tone marks]
- Micro-clue: [3-6 words max that hint at meaning without giving it away completely]

**BACK:**
- Translation: [concise dictionary-style translation, max 10 words, e.g. for  "no; not; un-" or "to eat; to consume"]
- Meaning: [full English definition, clear and comprehensive]
- Components: [explain the radicals/components and their meanings - use the dictionary data provided above if available]
- Examples: [2-3 example sentences in Chinese with pinyin and English translations]
- Related words: [3-5 related Chinese words with pinyin and English]
- Memory story: [create a short, funny or shocking micro-story to help remember components, meaning and tone]

**IMAGE PROMPT:**
[Use split composition:
- LEFT side: the concept being learned (main focus, vivid, detailed)
- RIGHT side: NOT the concept (opposite, absence, or contrast)

One person in the scene experiencing/demonstrating the concept on the left side.
No text. Under 60 words.]

Respond with valid JSON matching this schema:
{
  "pinyin": "...",
  "microClue": "...",
  "translation": "concise dictionary-style, max 10 words",
  "meaning": "...",
  "components": "...",
  "examples": [{"zh": "...", "pinyin": "...", "en": "..."}],
  "relatedWords": [{"zh": "...", "pinyin": "...", "en": "..."}],
  "memoryStory": "...",
  "imagePrompt": "..."
}`}function jb(e){return`You are a Chinese language learning assistant. The user entered something that isn't in the standard dictionary.

USER INPUT: "${e}"

Analyze the input and create an appropriate flashcard:

1. If it looks like PINYIN (romanized Chinese)  convert to characters and create a vocabulary card
2. If it's a CHINESE PHRASE or sentence  create a phrase card  
3. If it's a QUESTION about Chinese language/culture/etymology  create a trivia card

Choose ONE of these JSON formats:

FOR VOCABULARY (pinyin input converted to characters):
{
  "type": "vocabulary",
  "character": "Chinese characters",
  "pinyin": "pinyin with tone marks (e.g., n ho)",
  "microClue": "3-6 word hint",
  "translation": "concise dictionary-style, max 10 words",
  "meaning": "full English definition",
  "components": "breakdown of radicals/parts if single character, or word-by-word for compounds",
  "examples": [{"zh": "example sentence", "pinyin": "pinyin", "en": "English"}],
  "relatedWords": [{"zh": "...", "pinyin": "...", "en": "..."}],
  "memoryStory": "memorable mnemonic story",
  "imagePrompt": "Describe a simple, clear image that visually represents the word's meaning. No text in image. Focus on concrete, memorable visual elements. Keep under 50 words. Sci-fi futuristic style with networks is a plus"
}

FOR PHRASE (Chinese sentence/expression):
{
  "type": "phrase",
  "character": "the Chinese phrase",
  "pinyin": "full pinyin with tone marks",
  "microClue": "when to use this",
  "translation": "concise translation, max 10 words",
  "meaning": "English translation with context",
  "components": "word-by-word breakdown with pinyin: (n, you) + (ho, good) = hello",
  "examples": [{"zh": "example in context", "pinyin": "pinyin", "en": "English"}],
  "relatedWords": [{"zh": "...", "pinyin": "...", "en": "..."}],
  "memoryStory": "memorable way to remember this phrase",
  "imagePrompt": "Describe a simple, clear image showing the situation where this phrase would be used. No text in image. Focus on concrete, memorable visual elements. Keep under 50 words. Sci-fi futuristic style with networks is a plus"
}

FOR TRIVIA (question about Chinese):
{
  "type": "trivia",
  "question": "the question being answered (include any Chinese with pinyin)",
  "answer": "concise 1-2 sentence answer",
  "explanation": "detailed explanation (include pinyin for any Chinese characters)",
  "relatedWords": [{"zh": "", "pinyin": "xing gun", "en": "related"}],
  "memoryStory": "memorable way to remember this fact",
  "imagePrompt": "Describe a simple, clear image that captures the key insight or concept of this answer. No text in image. Focus on concrete, memorable visual elements. Keep under 50 words. Sci-fi futuristic style with networks is a plus"
}

IMPORTANT: Always include pinyin with tone marks for any Chinese text.

Respond with valid JSON matching ONE schema above.`}function mi(e){const t=e.type||"vocabulary",s={vocabulary:["pinyin","microClue","meaning","components","examples","memoryStory"],phrase:["character","pinyin","meaning","components","memoryStory"],trivia:["question","answer","explanation"]}[t];if(!s)throw new Error(`Unknown card type: ${t}`);const i=s.filter(r=>!e[r]);if(i.length>0)throw new Error(`Missing required fields: ${i.join(", ")}`);if((t==="vocabulary"||t==="phrase")&&e.examples&&(!Array.isArray(e.examples)||e.examples.length===0))throw new Error("Examples must be a non-empty array");return!0}function vi(e){try{return JSON.parse(e)}catch{const t=e.match(/\{[\s\S]*\}/);if(!t)throw new Error("Invalid response format: no JSON found");return JSON.parse(t[0])}}function zb({getClient:e,loadCards:t,onCardGenerated:n}){const s=I(!1),i=I(null);async function r(o){var u,d;if(!o)return i.value="No dictionary entry to generate from",null;s.value=!0,i.value=null;try{const h=e(),p=await ht(o.simplified),f=Rs(p),k=Ra(o.simplified,f),g=await h.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Always respond with valid JSON."},{role:"user",content:k}]}),S=vi(g);mi(S);const R=Yn({character:o.simplified,...S,rawDictEntry:((u=p.cedict[0])==null?void 0:u.raw)||"",rawIdsEntry:((d=p.ids)==null?void 0:d.raw)||""});return ln(R),t(),n==null||n(R),R}catch(h){return i.value=h.message,null}finally{s.value=!1}}async function a(o){if(!o)return i.value="No query to generate from",null;s.value=!0,i.value=null;try{const u=e(),d=jb(o),h=await u.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Always respond with valid JSON."},{role:"user",content:d}]}),p=vi(h);mi(p);const f=Yn(p);return ln(f),t(),n==null||n(f),f}catch(u){return i.value=u.message,null}finally{s.value=!1}}async function l(o){var u,d;if(!(o!=null&&o.character))return i.value="No card to regenerate",null;s.value=!0,i.value=null;try{const h=e(),p=await ht(o.character),f=Rs(p),k=Ra(o.character,f),g=await h.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Always respond with valid JSON."},{role:"user",content:k}]}),S=vi(g);return mi(S),{...o,...S,rawDictEntry:((u=p.cedict[0])==null?void 0:u.raw)||o.rawDictEntry||"",rawIdsEntry:((d=p.ids)==null?void 0:d.raw)||o.rawIdsEntry||""}}catch(h){return i.value=h.message,null}finally{s.value=!1}}return{loading:s,error:i,generateFromDictEntry:r,generateFromFreeform:a,regenerateCard:l}}function Vb({getClient:e,loadCards:t,onCardGenerated:n}){const s=I(!1),i=I(null),r=I("");async function a(u,d=""){if(!u)return i.value="No dictionary entry to generate from",null;s.value=!0,i.value=null,r.value="";try{const h=e(),p=await ht(u.simplified),f=Rs(p),k=wa(u.simplified,f,d);let g="";await h.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Output only markdown, no code fences."},{role:"user",content:k}],onChunk:y=>{g+=y,r.value=g}});const S=ks(g),R=jn({character:S.character||u.simplified,pinyin:S.pinyin||u.pinyin||"",markdown:g});return ln(R),t(),n==null||n(R),R}catch(h){return i.value=h.message,null}finally{s.value=!1,r.value=""}}async function l(u,d=""){if(!u)return i.value="No query to generate from",null;s.value=!0,i.value=null,r.value="";try{const h=e(),p=hg(u,d);let f="";await h.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Output only markdown, no code fences."},{role:"user",content:p}],onChunk:S=>{f+=S,r.value=f}});const k=ks(f),g=jn({character:k.character||u,pinyin:k.pinyin||"",markdown:f});return ln(g),t(),n==null||n(g),g}catch(h){return i.value=h.message,null}finally{s.value=!1,r.value=""}}async function o(u,d=""){if(!(u!=null&&u.character))return i.value="No card to regenerate",null;s.value=!0,i.value=null,r.value="";try{const h=e(),p=await ht(u.character),f=Rs(p),k=wa(u.character,f,d);let g="";await h.stream({messages:[{role:"system",content:"You are a helpful Chinese language learning assistant. Output only markdown, no code fences."},{role:"user",content:k}],onChunk:R=>{g+=R,r.value=g}});const S=ks(g);return{...u,character:S.character||u.character,pinyin:S.pinyin||u.pinyin,markdown:g}}catch(h){return i.value=h.message,null}finally{s.value=!1,r.value=""}}return{loading:s,error:i,streamingContent:r,generateFromDictEntry:a,generateFromFreeform:l,regenerateCard:o}}const Qt=5,Gb=2,Wb=3e3,Jb=1e3,Yb=500,Qb=2e3,Zb=3e3,Xb=100;function ek(){const e=I("hanzi-pinyin"),t=I(!1),n=I([]),s=I(60),i=I(!0),r=I("setup"),a=I(0),l=I([]),o=I([]),u=I([]),d=I(null),h=I(null),p=I(0),f=I(0),k=I([]),g=I(0);let S=null,R=null,y=null;const x=ie(()=>p.value+f.value),$=ie(()=>x.value===0?0:p.value/x.value),P=ie(()=>Math.ceil(a.value/1e3)),C=ie(()=>P.value<=10&&P.value>0),m=ie(()=>o.value.filter(X=>X&&X.state==="active").length);function A(){const X=Js();i.value=X.audioEnabled??!0,s.value=X.defaultTimeLimit??60,e.value=X.defaultMode??"hanzi-pinyin"}function F(){go({audioEnabled:i.value,defaultTimeLimit:s.value,defaultMode:e.value})}async function D(){if(n.value.length===0)throw new Error("Please select at least one tag");const X=await Om(n.value);if(X.length<Qt*2)throw new Error(`Need at least ${Qt*2} cards. Selected tags have ${X.length}.`);l.value=Sa(X),o.value=[];for(let le=0;le<Qt;le++)o.value.push(O(l.value.shift()));B(),p.value=0,f.value=0,k.value=[],d.value=null,h.value=null,a.value=s.value*1e3,g.value=0,S=null,r.value="setup"}function O(X){return X?{card:X,state:"active",cooldownUntil:null}:null}function z(){const X=g.value*Yb;return Math.max(Jb,Wb-X)}function B(){u.value=M(Qt)}function M(X){let le=Array.from({length:X},(w,T)=>T),v=0;for(;v<100;){if(le=Sa(le),!le.some((T,U)=>T===U))return le;v++}for(let w=0;w<X;w++)if(le[w]===w){const T=(w+1)%X;[le[w],le[T]]=[le[T],le[w]]}return le}function ae(X){const le=new Set;for(let w=0;w<Qt;w++)if(w!==X){const T=o.value[w];if(T&&(T.state==="active"||T.state==="cooldown")){const U=u.value.indexOf(w);U!==-1&&le.add(U)}}const v=[];for(let w=0;w<Qt;w++)!le.has(w)&&w!==X&&v.push(w);if(v.length===0)for(let w=0;w<Qt;w++)le.has(w)||v.push(w);if(v.length>0){const w=v[Math.floor(Math.random()*v.length)];u.value[w]=X}}function Z(){r.value!=="playing"&&(r.value="playing",y=Date.now(),R=setInterval(ne,Xb))}function ne(){const X=Date.now(),le=X-y;y=X,a.value=Math.max(0,a.value-le);const v=[];for(let T=0;T<o.value.length;T++){const U=o.value[T];U&&U.state==="cooldown"&&v.push({index:T,cooldownUntil:U.cooldownUntil,isReady:U.cooldownUntil<=X})}v.sort((T,U)=>T.cooldownUntil-U.cooldownUntil);for(const{index:T,isReady:U}of v)U&&ee(T);const w=o.value.map((T,U)=>({slot:T,index:U})).filter(({slot:T})=>T&&T.state==="cooldown").sort((T,U)=>T.slot.cooldownUntil-U.slot.cooldownUntil);for(;w.length>Gb;){const T=w.shift();ee(T.index)}(a.value<=0||m.value===0&&l.value.length===0)&&st()}function ee(X){const le=l.value.shift();le?(o.value[X]=O(le),ae(X)):o.value[X]={card:null,state:"empty",cooldownUntil:null}}function pe(X){if(r.value!=="playing")return;const le=o.value[X];!le||le.state!=="active"||(d.value=X,h.value!==null&&Oe())}function Ee(X){if(r.value!=="playing")return;const le=u.value[X],v=o.value[le];!v||v.state!=="active"||(h.value=X,d.value!==null&&Oe())}function Oe(){if(d.value===null||h.value===null)return;const X=d.value,le=u.value[h.value],v=o.value[X],w=o.value[le];if(!v||!w){Ct();return}const T=X===le;k.value.push({cardId:v.card.id,character:v.card.character,wasCorrect:T,timestamp:Date.now()}),T?Be(X):Dt(v.card,w.card),Ct()}function Be(X){p.value++;const le=Date.now(),v=o.value[X];S&&le-S<=Qb?g.value++:g.value=0,S=le;const w=z();return v.state="cooldown",v.cooldownUntil=le+w,v.card}function Dt(X,le){f.value++,g.value=0,S=null,a.value=Math.max(0,a.value-Zb),k.value.push({cardId:le.id,character:le.character,wasCorrect:!1,timestamp:Date.now()})}function Ct(){d.value=null,h.value=null}function st(){return R&&(clearInterval(R),R=null),r.value="finished",Bm({mode:e.value,tags:n.value,hidePinyin:t.value,timeLimit:s.value,correct:p.value,incorrect:f.value,matchHistory:k.value})}function Xe(){R&&(clearInterval(R),R=null),r.value="setup",o.value=[],l.value=[],u.value=[],d.value=null,h.value=null,p.value=0,f.value=0,k.value=[],a.value=0,g.value=0,S=null}function pt(X){return e.value==="hanzi-pinyin"?X.pinyin:X.english}function it(X){return e.value==="hanzi-pinyin"?{character:X.character,pinyin:null}:{character:X.character,pinyin:t.value?null:X.pinyin}}function gt(){const X={};for(const le of k.value)le.wasCorrect||(X[le.cardId]||(X[le.cardId]={cardId:le.cardId,character:le.character,count:0}),X[le.cardId].count++);return Object.values(X).filter(le=>le.count>=2).sort((le,v)=>v.count-le.count)}return A(),{mode:e,hidePinyin:t,selectedTags:n,timeLimit:s,audioEnabled:i,status:r,timeRemaining:a,timeRemainingSeconds:P,isLowTime:C,slots:o,rightColumnOrder:u,selectedLeft:d,selectedRight:h,cardPool:l,correct:p,incorrect:f,totalAttempts:x,accuracy:$,matchHistory:k,comboCount:g,loadSettings:A,persistSettings:F,initGame:D,startGame:Z,selectLeft:pe,selectRight:Ee,clearSelection:Ct,endGame:st,resetGame:Xe,getRightDisplayText:pt,getLeftDisplay:it,getSessionProblemCards:gt}}const tk={class:"app"},nk={class:"header"},sk={class:"header-actions"},ik={key:1,class:"card loading-card"},rk={key:10,class:"card error-card"},ak={class:"error-text"},lk={key:0,class:"error-hint"},ok={class:"error-actions"},ck={class:"study-header-title"},uk={class:"study-header-nav"},dk=["disabled"],fk={class:"study-progress"},hk=["disabled"],pk={__name:"App",setup(e){const{client:t,getActiveProviderId:n,refresh:s}=on(),i=I(!1),r=I(!1),a=I([]),l=I(null),o=I(null),u=I(null),d=ek(),h=nb(()=>t),p=I(!1);function f(){a.value=Nt()}function k(){return!!n()}const g=qb({savedCards:a,loadCards:f}),S=Kb({savedCards:a,onCardChange:H=>{g.currentCard.value=H,g.currentDictLookup.value=null,g.updateHskBadge(),x.updateCardIndex(S.currentIndex.value)}}),R=zb({getClient:()=>t,loadCards:f,onCardGenerated:H=>{g.markAsGenerated(H)}}),y=Vb({getClient:()=>t,loadCards:f,onCardGenerated:H=>{g.markAsGenerated(H)}}),x=Ub({onNavigate:$});async function $(H){if(H.view==="home")g.closeCard(),S.closeDeck(),d.resetGame(),h.closeBook();else if(H.view==="deck")g.closeCard(),d.resetGame(),h.closeBook(),H.deck&&await S.openDeck(H.deck);else if(H.view==="card")d.resetGame(),h.closeBook(),H.deck&&(!S.activeDeck.value||JSON.stringify(S.activeDeck.value)!==JSON.stringify(H.deck))?await S.openDeck(H.deck):!H.deck&&S.activeDeck.value&&S.closeDeck(),H.card&&await P(H);else if(H.view==="games"){if(g.closeCard(),S.closeDeck(),h.closeBook(),(H.gameStage==="play"||H.gameStage==="results")&&d.status.value==="setup"){x.goToGames("setup");return}}else H.view==="reader"&&(g.closeCard(),S.closeDeck(),d.resetGame(),H.readerStage==="reading"&&H.bookId?(await h.loadBooks(),await h.openBook(H.bookId)):H.readerStage==="home"&&(h.closeBook(),await h.loadBooks()))}async function P(H){if(H.card){if(S.activeDeck.value&&S.activeDeckCards.value.length>0){const E=S.findCardInDeck(H.card);if(E){S.openCardFromDeck(E),g.openSavedCard(E),typeof H.cardIndex=="number"&&H.cardIndex>=0&&(S.currentIndex.value=H.cardIndex);return}}await g.openCardByCharacter(H.card),S.activeDeck.value||S.clearNavigation()}}const C=ie(()=>g.currentCard.value&&!g.isNewCard.value&&S.displayOrder.value.length>0&&x.hasDeckContext.value),m=ie(()=>g.error.value||R.error.value),A=ie(()=>{const H=m.value;return H&&(H.includes("JSON")||H.includes("position")||H.includes("Unexpected"))}),F=ie(()=>g.pendingFreeformQuery.value||g.pendingDictEntry.value);async function D(H){S.clearNavigation(),await g.openCardByCharacter(H),x.goToCard(H)}async function O(H){const E=await g.handleDictSelect(H,{findCardInDeck:S.findCardInDeck,openCardFromDeck:S.openCardFromDeck,activeDeck:S.activeDeck,activeDeckCards:S.activeDeckCards});if(E.action==="openSaved")if(S.activeDeck.value){const N=S.activeDeckCards.value.findIndex(he=>he.id===E.card.id);N>=0&&(S.displayOrder.value=S.activeDeckCards.value.map((he,Ue)=>Ue),S.currentIndex.value=N),x.goToCard(H.simplified,S.activeDeck.value,N)}else S.setupSavedCardsNavigation(E.card),x.goToCard(H.simplified);else E.action==="newCard"||E.action==="openHsk"?(S.clearNavigation(),x.goToCard(H.simplified)):E.action==="openDeck"&&x.goToCard(H.simplified,S.activeDeck.value)}async function z(H){if(!k()){r.value=!0;return}g.handleFreeform(H),S.clearNavigation(),x.goToCard(H),await R.generateFromFreeform(g.pendingFreeformQuery.value)}async function B(){if(!k()){r.value=!0;return}g.pendingFreeformQuery.value?await R.generateFromFreeform(g.pendingFreeformQuery.value):g.pendingDictEntry.value?await R.generateFromDictEntry(g.pendingDictEntry.value):g.error.value="No dictionary entry to generate from"}async function M(H=""){if(!k()){r.value=!0;return}g.pendingFreeformQuery.value?await y.generateFromFreeform(g.pendingFreeformQuery.value,H):g.pendingDictEntry.value?await y.generateFromDictEntry(g.pendingDictEntry.value,H):g.error.value="No dictionary entry to generate from"}async function ae(){if(!k()){r.value=!0;return}if(!g.currentCard.value){g.error.value="No card to regenerate";return}const H=await R.regenerateCard(g.currentCard.value);H&&(l.value=H)}function Z(H){g.saveCurrentCard(H)}function ne(){g.addCurrentToCollection()}function ee(){x.goToGames("setup")}function pe(){d.resetGame(),x.goHome()}function Ee(){d.resetGame(),x.goToGames("setup")}function Oe(){x.goToGames("setup")}async function Be(H){d.mode.value=H.mode,d.hidePinyin.value=H.hidePinyin,d.selectedTags.value=H.tags,d.timeLimit.value=H.timeLimit;try{await d.initGame(),x.goToGames("play")}catch(E){g.error.value=E.message}}function Dt(){d.resetGame(),x.goToGames("setup")}function Ct(){x.goToGames("results")}async function st(){try{await d.initGame(),x.goToGames("play")}catch(H){g.error.value=H.message,x.goToGames("setup")}}async function Xe(H){d.resetGame(),await g.openCardByCharacter(H),x.goToCard(H)}async function pt(){await h.loadBooks(),x.goToReader("home")}function it(){h.closeBook(),x.goHome()}function gt(){x.goToReader("create")}function X(){x.goToReader("home")}async function le(H){await h.openBook(H),h.currentBook.value&&x.goToReader("reading",H)}function v(){h.closeBook(),x.goToReader("home")}async function w(H){const E=await h.createNewBook(H);E&&x.goToReader("reading",E.id)}async function T(H){await h.removeBook(H)}function U({text:H,pinyin:E,meaning:N,bookTitle:he,bookId:Ue}){if(gr(H,E))return{success:!1,reason:"exists"};const se=Yn({character:H,pinyin:E,meaning:N,translation:N,tags:["user","reader",`book:${he}`]});return ln(se),f(),{success:!0,card:se}}async function j(H){u.value&&await u.value.prepopulateSearch(H)}async function V(H){await S.openDeck(H),x.goToDeck(H)}function Q(){S.closeDeck(),x.goHome()}function J(H,E){S.openCardFromDeck(H,E),g.openSavedCard(H),x.goToCard(H.character,S.activeDeck.value,S.currentIndex.value)}function W(){S.prevCard()}function q(){S.nextCard()}function re(){S.shuffleCurrentDeck()}function Y(){g.closeCard(),S.activeDeck.value?x.goToDeck(S.activeDeck.value):(S.clearNavigation(),x.goHome())}function te(){var N;if(!confirm("Delete this card?"))return;const H=g.currentCard.value.id,E=((N=S.activeDeck.value)==null?void 0:N.type)==="user";if(g.handleDelete(H),C.value&&S.displayOrder.value.length>1){const he=S.removeFromDisplayOrder(H);he?(g.currentCard.value=he,g.updateHskBadge(),x.replace({card:he.character,cardIndex:S.currentIndex.value})):Y()}else Y();E&&S.activeDeck.value&&S.openDeck(S.activeDeck.value)}function ce(){g.error.value=null,R.error.value=null}async function fe(){ce(),await B()}async function be(){try{await s()}catch{}}function ge(){g.closeCard(),S.closeDeck(),d.resetGame(),h.closeBook(),x.goHome()}function Le(H){if(H.key==="Escape")if(i.value)i.value=!1;else if(r.value)r.value=!1;else{if(x.isGames.value&&x.gameStage.value==="play")return;if(x.isGames.value)x.gameStage.value==="results"?Ee():pe();else if(x.isReader.value&&x.readerStage.value==="reading"){if(p.value)return;v()}else x.isReader.value&&x.readerStage.value==="create"?X():x.isReader.value&&x.readerStage.value==="home"?it():g.currentCard.value?Y():S.activeDeck.value&&Q()}const E=document.activeElement,N=E&&(E.tagName==="INPUT"||E.tagName==="TEXTAREA");C.value&&!N&&!x.isReader.value&&(H.key==="ArrowLeft"?W():H.key==="ArrowRight"&&q())}return Qe(async()=>{document.addEventListener("keydown",Le),await Mf(),f();const H=x.init();await $(H)}),xt(()=>{document.removeEventListener("keydown",Le)}),(H,E)=>(b(),_("div",tk,[c("header",nk,[c("h1",{class:"header-title",onClick:ge},"Chinese Flashcards"),c("div",sk,[c("button",{class:"btn btn-small",onClick:E[0]||(E[0]=N=>i.value=!0)},"Settings")])]),G(x).isGames.value?K("",!0):(b(),Pe(Zf,{key:0,ref_key:"searchBarRef",ref:u,placeholder:"Search Chinese or English...",onSelect:O,onFreeform:z},null,512)),G(g).urlLoading.value?(b(),_("div",ik,[...E[12]||(E[12]=[c("p",null,"Loading card...",-1)])])):K("",!0),G(x).isHome.value&&!G(g).urlLoading.value?(b(),Pe(wm,{key:2,"user-cards":a.value,onOpenDeck:V,onOpenGames:ee,onOpenReader:pt},null,8,["user-cards"])):G(x).isDeck.value?(b(),Pe(Mm,{key:3,title:G(S).activeDeckTitle.value,cards:G(S).activeDeckCards.value,onBack:Q,onSelectCard:J},null,8,["title","cards"])):K("",!0),G(x).isGames.value&&G(x).gameStage.value==="setup"?(b(),Pe(dv,{key:4,onBack:pe,onStart:Be})):K("",!0),G(x).isGames.value&&G(x).gameStage.value==="play"?(b(),Pe(Bv,{key:5,game:G(d),onQuit:Dt,onFinished:Ct},null,8,["game"])):K("",!0),G(x).isGames.value&&G(x).gameStage.value==="results"?(b(),Pe(iy,{key:6,game:G(d),onBack:Ee,onSetup:Oe,onPlayAgain:st,onNavigateToCard:Xe},null,8,["game"])):K("",!0),G(x).isReader.value&&G(x).readerStage.value==="home"?(b(),Pe(yy,{key:7,books:G(h).books.value,loading:G(h).loading.value,onBack:it,onNewBook:gt,onOpenBook:le,onDeleteBook:T},null,8,["books","loading"])):K("",!0),G(x).isReader.value&&G(x).readerStage.value==="create"?(b(),Pe(Wy,{key:8,onCancel:X,onCreate:w})):K("",!0),G(x).isReader.value&&G(x).readerStage.value==="reading"&&G(h).currentBook.value?(b(),Pe(Bb,{key:9,book:G(h).currentBook.value,page:G(h).currentPage.value,"current-page-index":G(h).currentPageIndex.value,"total-pages":G(h).totalPages.value,"original-text":G(h).currentPageOriginal.value,translating:G(h).translating.value,"back-translating":G(h).backTranslating.value,error:G(h).error.value,"back-translation-error":G(h).backTranslationError.value,"on-add-word":U,onBack:v,onPrevPage:E[1]||(E[1]=N=>G(h).prevPage()),onNextPage:E[2]||(E[2]=N=>G(h).nextPage()),onTranslate:E[3]||(E[3]=N=>G(h).ensurePageTranslated()),onBackTranslate:E[4]||(E[4]=N=>G(h).ensureBackTranslation()),onRetry:E[5]||(E[5]=N=>G(h).retryTranslation()),onRetryBackTranslation:E[6]||(E[6]=N=>G(h).retryBackTranslation()),onOpenWord:j,onMiniCardChange:E[7]||(E[7]=N=>p.value=N),onSettingsChange:E[8]||(E[8]=N=>G(h).updateDisplaySettings(N))},null,8,["book","page","current-page-index","total-pages","original-text","translating","back-translating","error","back-translation-error"])):K("",!0),m.value?(b(),_("div",rk,[c("p",ak,L(m.value),1),A.value?(b(),_("p",lk,"LLM generated invalid JSON. This happens occasionally - try again.")):K("",!0),c("div",ok,[F.value?(b(),_("button",{key:0,class:"btn btn-small",onClick:fe},"Retry")):K("",!0),c("button",{class:"btn btn-small btn-secondary",onClick:ce},"Dismiss")])])):K("",!0),C.value?(b(),_("div",{key:11,ref_key:"studyHeaderRef",ref:o,class:"study-header"},[c("button",{class:"btn btn-small",onClick:Y}," Back"),c("h2",ck,L(G(S).activeDeckTitle.value),1),c("div",uk,[c("button",{class:"nav-btn",onClick:W,disabled:G(S).currentIndex.value===0,title:"Previous ()"},"  ",8,dk),c("div",fk,L(G(S).currentIndex.value+1)+" / "+L(G(S).displayOrder.value.length),1),c("button",{class:"nav-btn",onClick:q,disabled:G(S).currentIndex.value===G(S).displayOrder.value.length-1,title:"Next ()"},"  ",8,hk)]),c("button",{class:"btn btn-small",onClick:re,title:"Shuffle"},"Shuffle")],512)):K("",!0),G(g).currentCard.value&&G(g).currentCard.value.type==="trivia"&&!G(x).isGames.value&&!G(x).isReader.value?(b(),Pe(fg,{card:G(g).currentCard.value,key:"trivia-"+G(g).currentCard.value.id,"initial-flipped":G(g).isNewCard.value,"show-close":!C.value,"scroll-target-ref":o.value,onDelete:te,onClose:Y,onNavigate:D},null,8,["card","initial-flipped","show-close","scroll-target-ref"])):G(g).currentCard.value&&G(g).currentCard.value.type==="markdown"&&!G(x).isGames.value&&!G(x).isReader.value?(b(),Pe(Bg,{card:G(g).currentCard.value,key:"md-"+G(g).currentCard.value.id,loading:G(y).loading.value,"streaming-content":G(y).streamingContent.value,"show-close":!C.value,onGenerate:M,onSave:Z,onDelete:te,onClose:Y},null,8,["card","loading","streaming-content","show-close"])):G(g).currentCard.value&&!G(x).isGames.value&&!G(x).isReader.value?(b(),Pe(Zp,{card:G(g).currentCard.value,key:"vocab-"+G(g).currentCard.value.id,"is-new":G(g).isNewCard.value,loading:G(R).loading.value,"initial-flipped":G(g).isNewCard.value,"show-close":!C.value,"hsk-badge":G(g).currentHskBadge.value,"is-in-collection":G(g).isCurrentCardInCollection.value,"regenerated-data":l.value,"scroll-target-ref":o.value,onGenerate:B,onRegenerate:ae,onClearRegenerated:E[9]||(E[9]=N=>l.value=null),onSave:Z,onDelete:te,onClose:Y,onAddToCollection:ne,onNavigate:D},null,8,["card","is-new","loading","initial-flipped","show-close","hsk-badge","is-in-collection","regenerated-data","scroll-target-ref"])):K("",!0),i.value?(b(),Pe(Zg,{key:15,onClose:E[10]||(E[10]=N=>i.value=!1),onSaved:f})):K("",!0),(b(),Pe(Ji,{to:"body"},[Ae(G(ql),{"is-visible":r.value,onClose:E[11]||(E[11]=N=>r.value=!1),onConfigChanged:be},null,8,["is-visible"])]))]))}};qu(pk).use(rd).mount("#app");
